<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  Graphics.Rendering.Chart.Plot.Pie</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (c) Tim Docker 2008, 2014</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  BSD-style (see chart/COPYRIGHT)</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- A  basic pie chart.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Pie charts are handled different to other plots, in that they</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- have their own layout, and can't be composed with other plots. A</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- pie chart is rendered with code in the following form:</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- values :: [PieItem]</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- values = [...]</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- layout :: PieLayout</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- layout = pie_plot ^: pie_data ^= values</span><span>
</span><span id="line-18"></span><span class="hs-comment">--        $ def</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- renderable = toRenderable layout</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics.Rendering.Chart.Plot.Pie</span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier">PieLayout</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier">PieChart</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier">PieItem</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieToRenderable"><span class="hs-identifier">pieToRenderable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieChartToRenderable"><span class="hs-identifier">pieChartToRenderable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_title"><span class="hs-identifier">pie_title</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_title_style"><span class="hs-identifier">pie_title_style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_plot"><span class="hs-identifier">pie_plot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_background"><span class="hs-identifier">pie_background</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_margin"><span class="hs-identifier">pie_margin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_data"><span class="hs-identifier">pie_data</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_colors"><span class="hs-identifier">pie_colors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_label_style"><span class="hs-identifier">pie_label_style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_label_line_style"><span class="hs-identifier">pie_label_line_style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pie_start_angle"><span class="hs-identifier">pie_start_angle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pitem_label"><span class="hs-identifier">pitem_label</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pitem_offset"><span class="hs-identifier">pitem_offset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pitem_value"><span class="hs-identifier">pitem_value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- original code thanks to Neal Alexander</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- see ../Drawing.hs for why we do not use hiding (moveTo) for</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- lens &lt; 4</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Colour</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Colour.Names</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">white</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default.Class</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html"><span class="hs-identifier">Graphics.Rendering.Chart.Geometry</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html#moveTo"><span class="hs-identifier">moveTo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html"><span class="hs-identifier">Graphics.Rendering.Chart.Geometry</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Drawing.html"><span class="hs-identifier">Graphics.Rendering.Chart.Drawing</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html"><span class="hs-identifier">Graphics.Rendering.Chart.Renderable</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Grid.html"><span class="hs-identifier">Graphics.Rendering.Chart.Grid</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="PieLayout"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-var">PieLayout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PieLayout"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-var">PieLayout</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-64"></span><span>   </span><span id="_pie_title"><span class="annot"><span class="annottext">PieLayout -&gt; String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title"><span class="hs-identifier hs-var hs-var">_pie_title</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>   </span><span id="_pie_title_style"><span class="annot"><span class="annottext">PieLayout -&gt; FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title_style"><span class="hs-identifier hs-var hs-var">_pie_title_style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Types.html#FontStyle"><span class="hs-identifier hs-type">FontStyle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>   </span><span id="_pie_plot"><span class="annot"><span class="annottext">PieLayout -&gt; PieChart
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_plot"><span class="hs-identifier hs-var hs-var">_pie_plot</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>   </span><span id="_pie_background"><span class="annot"><span class="annottext">PieLayout -&gt; FillStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_background"><span class="hs-identifier hs-var hs-var">_pie_background</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Types.html#FillStyle"><span class="hs-identifier hs-type">FillStyle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>   </span><span id="_pie_margin"><span class="annot"><span class="annottext">PieLayout -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_margin"><span class="hs-identifier hs-var hs-var">_pie_margin</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-69"></span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="PieChart"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-var">PieChart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PieChart"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-var">PieChart</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-72"></span><span>   </span><span id="_pie_data"><span class="annot"><span class="annottext">PieChart -&gt; [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var hs-var">_pie_data</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-type">PieItem</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>   </span><span id="_pie_colors"><span class="annot"><span class="annottext">PieChart -&gt; [AlphaColour Double]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_colors"><span class="hs-identifier hs-var hs-var">_pie_colors</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">AlphaColour</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>   </span><span id="_pie_label_style"><span class="annot"><span class="annottext">PieChart -&gt; FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_style"><span class="hs-identifier hs-var hs-var">_pie_label_style</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Types.html#FontStyle"><span class="hs-identifier hs-type">FontStyle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>   </span><span id="_pie_label_line_style"><span class="annot"><span class="annottext">PieChart -&gt; LineStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_line_style"><span class="hs-identifier hs-var hs-var">_pie_label_line_style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Types.html#LineStyle"><span class="hs-identifier hs-type">LineStyle</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-76"></span><span>   </span><span id="_pie_start_angle"><span class="annot"><span class="annottext">PieChart -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_start_angle"><span class="hs-identifier hs-var hs-var">_pie_start_angle</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="PieItem"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-var">PieItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PieItem"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-var">PieItem</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-81"></span><span>   </span><span id="_pitem_label"><span class="annot"><span class="annottext">PieItem -&gt; String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_label"><span class="hs-identifier hs-var hs-var">_pitem_label</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>   </span><span id="_pitem_offset"><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_offset"><span class="hs-identifier hs-var hs-var">_pitem_offset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>   </span><span id="_pitem_value"><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_value"><span class="hs-identifier hs-var hs-var">_pitem_value</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-84"></span><span class="hs-special">}</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679373292"><span class="annot"><span class="annottext">def :: PieChart
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieChart :: [PieItem]
-&gt; [AlphaColour Double]
-&gt; FontStyle
-&gt; LineStyle
-&gt; Double
-&gt; PieChart
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_pie_data :: [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var">_pie_data</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_colors :: [AlphaColour Double]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_colors"><span class="hs-identifier hs-var">_pie_colors</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AlphaColour Double]
</span><a href="Graphics.Rendering.Chart.Drawing.html#defaultColorSeq"><span class="hs-identifier hs-var">defaultColorSeq</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_label_style :: FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_style"><span class="hs-identifier hs-var">_pie_label_style</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FontStyle
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_label_line_style :: LineStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_line_style"><span class="hs-identifier hs-var">_pie_label_line_style</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; AlphaColour Double -&gt; LineStyle
</span><a href="Graphics.Rendering.Chart.Drawing.html#solidLine"><span class="hs-identifier hs-var">solidLine</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(AlphaColour Double -&gt; LineStyle)
-&gt; AlphaColour Double -&gt; LineStyle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Colour Double -&gt; AlphaColour Double
forall a. Num a =&gt; Colour a -&gt; AlphaColour a
</span><span class="hs-identifier hs-var">opaque</span></span><span> </span><span class="annot"><span class="annottext">Colour Double
forall a. Num a =&gt; Colour a
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_start_angle :: Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_start_angle"><span class="hs-identifier hs-var">_pie_start_angle</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-type">PieItem</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679373285"><span class="annot"><span class="annottext">def :: PieItem
</span><a href="#local-6989586621679373285"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double -&gt; Double -&gt; PieItem
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-var">PieItem</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-type">PieLayout</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679373283"><span class="annot"><span class="annottext">def :: PieLayout
</span><a href="#local-6989586621679373283"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieLayout :: String -&gt; FontStyle -&gt; PieChart -&gt; FillStyle -&gt; Double -&gt; PieLayout
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-type">PieLayout</span></a></span><span> </span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_pie_background :: FillStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_background"><span class="hs-identifier hs-var">_pie_background</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AlphaColour Double -&gt; FillStyle
</span><a href="Graphics.Rendering.Chart.Drawing.html#solidFillStyle"><span class="hs-identifier hs-var">solidFillStyle</span></a></span><span> </span><span class="annot"><span class="annottext">(AlphaColour Double -&gt; FillStyle)
-&gt; AlphaColour Double -&gt; FillStyle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Colour Double -&gt; AlphaColour Double
forall a. Num a =&gt; Colour a -&gt; AlphaColour a
</span><span class="hs-identifier hs-var">opaque</span></span><span> </span><span class="annot"><span class="annottext">Colour Double
forall a. (Ord a, Floating a) =&gt; Colour a
</span><span class="hs-identifier hs-var">white</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_title :: String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title"><span class="hs-identifier hs-var">_pie_title</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_title_style :: FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title_style"><span class="hs-identifier hs-var">_pie_title_style</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FontStyle
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_font_size :: Double
</span><a href="#local-6989586621679373281"><span class="hs-identifier hs-var">_font_size</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">15</span></span><span>
</span><span id="line-103"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_font_weight :: FontWeight
</span><a href="#local-6989586621679373280"><span class="hs-identifier hs-var">_font_weight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FontWeight
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#FontWeightBold"><span class="hs-identifier hs-var">FontWeightBold</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_plot :: PieChart
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_plot"><span class="hs-identifier hs-var">_pie_plot</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieChart
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_pie_margin :: Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_margin"><span class="hs-identifier hs-var">_pie_margin</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#ToRenderable"><span class="hs-identifier hs-type">ToRenderable</span></a></span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-type">PieLayout</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679373276"><span class="annot"><span class="annottext">toRenderable :: PieLayout -&gt; Renderable ()
</span><a href="Graphics.Rendering.Chart.Renderable.html#toRenderable"><span class="hs-identifier hs-var hs-var hs-var hs-var">toRenderable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PickFn () -&gt; Renderable (PickFn Any) -&gt; Renderable ()
forall b a. PickFn b -&gt; Renderable a -&gt; Renderable b
</span><a href="Graphics.Rendering.Chart.Renderable.html#setPickFn"><span class="hs-identifier hs-var">setPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">PickFn ()
forall a. PickFn a
</span><a href="Graphics.Rendering.Chart.Renderable.html#nullPickFn"><span class="hs-identifier hs-var">nullPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">(Renderable (PickFn Any) -&gt; Renderable ())
-&gt; (PieLayout -&gt; Renderable (PickFn Any))
-&gt; PieLayout
-&gt; Renderable ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PieLayout -&gt; Renderable (PickFn Any)
forall a. PieLayout -&gt; Renderable (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieToRenderable"><span class="hs-identifier hs-var">pieToRenderable</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679373389"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieChartToRenderable"><span class="hs-identifier hs-type">pieChartToRenderable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#Renderable"><span class="hs-identifier hs-type">Renderable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#PickFn"><span class="hs-identifier hs-type">PickFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679373389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span id="pieChartToRenderable"><span class="annot"><span class="annottext">pieChartToRenderable :: PieChart -&gt; Renderable (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieChartToRenderable"><span class="hs-identifier hs-var hs-var">pieChartToRenderable</span></a></span></span><span> </span><span id="local-6989586621679373271"><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373271"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderable :: forall a.
BackendProgram RectSize
-&gt; (RectSize -&gt; BackendProgram (PickFn a)) -&gt; Renderable a
</span><a href="Graphics.Rendering.Chart.Renderable.html#Renderable"><span class="hs-identifier hs-type">Renderable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">minsize :: BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Renderable.html#minsize"><span class="hs-identifier hs-var">minsize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#minsizePie"><span class="hs-identifier hs-var">minsizePie</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373271"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-113"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">render :: RectSize -&gt; BackendProgram (PickFn (PickFn a))
</span><a href="Graphics.Rendering.Chart.Renderable.html#render"><span class="hs-identifier hs-var">render</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; RectSize -&gt; BackendProgram (PickFn (PickFn a))
forall a. PieChart -&gt; RectSize -&gt; BackendProgram (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#renderPie"><span class="hs-identifier hs-var">renderPie</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373271"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-114"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#ToRenderable"><span class="hs-identifier hs-type">ToRenderable</span></a></span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679373264"><span class="annot"><span class="annottext">toRenderable :: PieChart -&gt; Renderable ()
</span><a href="#local-6989586621679373264"><span class="hs-identifier hs-var hs-var hs-var hs-var">toRenderable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PickFn () -&gt; Renderable (PickFn Any) -&gt; Renderable ()
forall b a. PickFn b -&gt; Renderable a -&gt; Renderable b
</span><a href="Graphics.Rendering.Chart.Renderable.html#setPickFn"><span class="hs-identifier hs-var">setPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">PickFn ()
forall a. PickFn a
</span><a href="Graphics.Rendering.Chart.Renderable.html#nullPickFn"><span class="hs-identifier hs-var">nullPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">(Renderable (PickFn Any) -&gt; Renderable ())
-&gt; (PieChart -&gt; Renderable (PickFn Any))
-&gt; PieChart
-&gt; Renderable ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; Renderable (PickFn Any)
forall a. PieChart -&gt; Renderable (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieChartToRenderable"><span class="hs-identifier hs-var">pieChartToRenderable</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679373395"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieToRenderable"><span class="hs-identifier hs-type">pieToRenderable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieLayout"><span class="hs-identifier hs-type">PieLayout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#Renderable"><span class="hs-identifier hs-type">Renderable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#PickFn"><span class="hs-identifier hs-type">PickFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679373395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span id="pieToRenderable"><span class="annot"><span class="annottext">pieToRenderable :: PieLayout -&gt; Renderable (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieToRenderable"><span class="hs-identifier hs-var hs-var">pieToRenderable</span></a></span></span><span> </span><span id="local-6989586621679373263"><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FillStyle -&gt; Renderable (PickFn a) -&gt; Renderable (PickFn a)
forall a. FillStyle -&gt; Renderable a -&gt; Renderable a
</span><a href="Graphics.Rendering.Chart.Renderable.html#fillBackground"><span class="hs-identifier hs-var">fillBackground</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieLayout -&gt; FillStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_background"><span class="hs-identifier hs-var hs-var">_pie_background</span></a></span><span> </span><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-121"></span><span>       </span><span class="annot"><span class="annottext">Grid (Renderable (PickFn a)) -&gt; Renderable (PickFn a)
forall a. Grid (Renderable a) -&gt; Renderable a
</span><a href="Graphics.Rendering.Chart.Grid.html#gridToRenderable"><span class="hs-identifier hs-var">gridToRenderable</span></a></span><span> </span><span class="annot"><span class="annottext">(Grid (Renderable (PickFn a)) -&gt; Renderable (PickFn a))
-&gt; Grid (Renderable (PickFn a)) -&gt; Renderable (PickFn a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Grid (Renderable (PickFn a))] -&gt; Grid (Renderable (PickFn a))
forall a. [Grid a] -&gt; Grid a
</span><a href="Graphics.Rendering.Chart.Grid.html#aboveN"><span class="hs-identifier hs-var">aboveN</span></a></span><span>
</span><span id="line-122"></span><span>         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a))
forall a. a -&gt; Grid a
</span><a href="Graphics.Rendering.Chart.Grid.html#tval"><span class="hs-identifier hs-var">tval</span></a></span><span> </span><span class="annot"><span class="annottext">(Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a)))
-&gt; Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, Double)
-&gt; Renderable (PickFn a) -&gt; Renderable (PickFn a)
forall a.
(Double, Double, Double, Double) -&gt; Renderable a -&gt; Renderable a
</span><a href="Graphics.Rendering.Chart.Renderable.html#addMargins"><span class="hs-identifier hs-var">addMargins</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var">lm</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PickFn (PickFn a) -&gt; Renderable String -&gt; Renderable (PickFn a)
forall b a. PickFn b -&gt; Renderable a -&gt; Renderable b
</span><a href="Graphics.Rendering.Chart.Renderable.html#setPickFn"><span class="hs-identifier hs-var">setPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">PickFn (PickFn a)
forall a. PickFn a
</span><a href="Graphics.Rendering.Chart.Renderable.html#nullPickFn"><span class="hs-identifier hs-var">nullPickFn</span></a></span><span> </span><span class="annot"><span class="annottext">Renderable String
</span><a href="#local-6989586621679373255"><span class="hs-identifier hs-var">title</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RectSize
-&gt; Grid (Renderable (PickFn a)) -&gt; Grid (Renderable (PickFn a))
forall a. RectSize -&gt; Grid a -&gt; Grid a
</span><a href="Graphics.Rendering.Chart.Grid.html#weights"><span class="hs-identifier hs-var">weights</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Grid (Renderable (PickFn a)) -&gt; Grid (Renderable (PickFn a)))
-&gt; Grid (Renderable (PickFn a)) -&gt; Grid (Renderable (PickFn a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a))
forall a. a -&gt; Grid a
</span><a href="Graphics.Rendering.Chart.Grid.html#tval"><span class="hs-identifier hs-var">tval</span></a></span><span> </span><span class="annot"><span class="annottext">(Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a)))
-&gt; Renderable (PickFn a) -&gt; Grid (Renderable (PickFn a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, Double)
-&gt; Renderable (PickFn a) -&gt; Renderable (PickFn a)
forall a.
(Double, Double, Double, Double) -&gt; Renderable a -&gt; Renderable a
</span><a href="Graphics.Rendering.Chart.Renderable.html#addMargins"><span class="hs-identifier hs-var">addMargins</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var">lm</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var">lm</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var">lm</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var">lm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; Renderable (PickFn a)
forall a. PieChart -&gt; Renderable (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#pieChartToRenderable"><span class="hs-identifier hs-var">pieChartToRenderable</span></a></span><span> </span><span class="annot"><span class="annottext">(PieChart -&gt; Renderable (PickFn a))
-&gt; PieChart -&gt; Renderable (PickFn a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PieLayout -&gt; PieChart
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_plot"><span class="hs-identifier hs-var hs-var">_pie_plot</span></a></span><span> </span><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>         </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679373255"><span class="annot"><span class="annottext">title :: Renderable String
</span><a href="#local-6989586621679373255"><span class="hs-identifier hs-var hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FontStyle
-&gt; HTextAnchor -&gt; VTextAnchor -&gt; String -&gt; Renderable String
</span><a href="Graphics.Rendering.Chart.Renderable.html#label"><span class="hs-identifier hs-var">label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieLayout -&gt; FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title_style"><span class="hs-identifier hs-var hs-var">_pie_title_style</span></a></span><span> </span><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HTextAnchor
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#HTA_Centre"><span class="hs-identifier hs-var">HTA_Centre</span></a></span><span> </span><span class="annot"><span class="annottext">VTextAnchor
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#VTA_Top"><span class="hs-identifier hs-var">VTA_Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieLayout -&gt; String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_title"><span class="hs-identifier hs-var hs-var">_pie_title</span></a></span><span> </span><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679373257"><span class="annot"><span class="annottext">lm :: Double
</span><a href="#local-6989586621679373257"><span class="hs-identifier hs-var hs-var">lm</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieLayout -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_margin"><span class="hs-identifier hs-var hs-var">_pie_margin</span></a></span><span> </span><span class="annot"><span class="annottext">PieLayout
</span><a href="#local-6989586621679373263"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#extraSpace"><span class="hs-identifier hs-type">extraSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="extraSpace"><span class="annot"><span class="annottext">extraSpace :: PieChart -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#extraSpace"><span class="hs-identifier hs-var hs-var">extraSpace</span></a></span></span><span> </span><span id="local-6989586621679373249"><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373249"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679373248"><span class="annot"><span class="annottext">[RectSize]
</span><a href="#local-6989586621679373248"><span class="hs-identifier hs-var">textSizes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PieItem -&gt; BackendProgram RectSize)
-&gt; [PieItem] -&gt; ProgramT ChartBackendInstr Identity [RectSize]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Drawing.html#textDimension"><span class="hs-identifier hs-var">textDimension</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BackendProgram RectSize)
-&gt; (PieItem -&gt; String) -&gt; PieItem -&gt; BackendProgram RectSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PieItem -&gt; String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_label"><span class="hs-identifier hs-var hs-var">_pitem_label</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var hs-var">_pie_data</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373249"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373245"><span class="annot"><span class="annottext">maxw :: Double
</span><a href="#local-6989586621679373245"><span class="hs-identifier hs-var hs-var">maxw</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RectSize -&gt; Double -&gt; Double) -&gt; Double -&gt; [RectSize] -&gt; Double
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; (RectSize -&gt; Double) -&gt; RectSize -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">RectSize -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[RectSize]
</span><a href="#local-6989586621679373248"><span class="hs-identifier hs-var">textSizes</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373242"><span class="annot"><span class="annottext">maxh :: Double
</span><a href="#local-6989586621679373242"><span class="hs-identifier hs-var hs-var">maxh</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RectSize -&gt; Double -&gt; Double) -&gt; Double -&gt; [RectSize] -&gt; Double
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; (RectSize -&gt; Double) -&gt; RectSize -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">RectSize -&gt; Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[RectSize]
</span><a href="#local-6989586621679373248"><span class="hs-identifier hs-var">textSizes</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373241"><span class="annot"><span class="annottext">maxo :: Double
</span><a href="#local-6989586621679373241"><span class="hs-identifier hs-var hs-var">maxo</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PieItem -&gt; Double -&gt; Double) -&gt; Double -&gt; [PieItem] -&gt; Double
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; (PieItem -&gt; Double) -&gt; PieItem -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_offset"><span class="hs-identifier hs-var hs-var">_pitem_offset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var hs-var">_pie_data</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373249"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373240"><span class="annot"><span class="annottext">extra :: Double
</span><a href="#local-6989586621679373240"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var">label_rgap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rlength"><span class="hs-identifier hs-var">label_rlength</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373241"><span class="hs-identifier hs-var">maxo</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">RectSize -&gt; BackendProgram RectSize
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373240"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373245"><span class="hs-identifier hs-var">maxw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373240"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373242"><span class="hs-identifier hs-var">maxh</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#minsizePie"><span class="hs-identifier hs-type">minsizePie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span id="minsizePie"><span class="annot"><span class="annottext">minsizePie :: PieChart -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#minsizePie"><span class="hs-identifier hs-var hs-var">minsizePie</span></a></span></span><span> </span><span id="local-6989586621679373236"><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373236"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679373235"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373235"><span class="hs-identifier hs-var">extraw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679373234"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373234"><span class="hs-identifier hs-var">extrah</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#extraSpace"><span class="hs-identifier hs-var">extraSpace</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373236"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">RectSize -&gt; BackendProgram RectSize
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373235"><span class="hs-identifier hs-var">extraw</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373234"><span class="hs-identifier hs-var">extrah</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679373390"><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#renderPie"><span class="hs-identifier hs-type">renderPie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieChart"><span class="hs-identifier hs-type">PieChart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Rendering.Chart.Renderable.html#PickFn"><span class="hs-identifier hs-type">PickFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679373390"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-145"></span><span id="renderPie"><span class="annot"><span class="annottext">renderPie :: PieChart -&gt; RectSize -&gt; BackendProgram (PickFn a)
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#renderPie"><span class="hs-identifier hs-var hs-var">renderPie</span></a></span></span><span> </span><span id="local-6989586621679373232"><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679373231"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373231"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679373230"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373230"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679373229"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373229"><span class="hs-identifier hs-var">extraw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679373228"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373228"><span class="hs-identifier hs-var">extrah</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#extraSpace"><span class="hs-identifier hs-var">extraSpace</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-comment">-- let (w,h)  = (p_x p2 - p_x p1, p_y p2 - p_y p1)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-comment">-- let center = Point (p_x p1 + w/2)  (p_y p1 + h/2)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373227"><span class="annot"><span class="annottext">center :: Point
</span><a href="#local-6989586621679373227"><span class="hs-identifier hs-var hs-var">center</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373231"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373230"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373225"><span class="annot"><span class="annottext">radius :: Double
</span><a href="#local-6989586621679373225"><span class="hs-identifier hs-var hs-var">radius</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373231"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373229"><span class="hs-identifier hs-var">extraw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373230"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373228"><span class="hs-identifier hs-var">extrah</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">(Double
 -&gt; (AlphaColour Double, PieItem)
 -&gt; ProgramT ChartBackendInstr Identity Double)
-&gt; Double
-&gt; [(AlphaColour Double, PieItem)]
-&gt; ProgramT ChartBackendInstr Identity ()
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">foldM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point
-&gt; Double
-&gt; Double
-&gt; (AlphaColour Double, PieItem)
-&gt; ProgramT ChartBackendInstr Identity Double
</span><a href="#local-6989586621679373222"><span class="hs-identifier hs-var">paint</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373227"><span class="hs-identifier hs-var">center</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373225"><span class="hs-identifier hs-var">radius</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_start_angle"><span class="hs-identifier hs-var hs-var">_pie_start_angle</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AlphaColour Double]
-&gt; [PieItem] -&gt; [(AlphaColour Double, PieItem)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; [AlphaColour Double]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_colors"><span class="hs-identifier hs-var hs-var">_pie_colors</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PieItem]
</span><a href="#local-6989586621679373221"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">PickFn a -&gt; BackendProgram (PickFn a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PickFn a
forall a. PickFn a
</span><a href="Graphics.Rendering.Chart.Renderable.html#nullPickFn"><span class="hs-identifier hs-var">nullPickFn</span></a></span><span>
</span><span id="line-156"></span><span> </span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-comment">-- p1 = Point 0 0 </span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-comment">-- p2 = Point w h </span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679373221"><span class="annot"><span class="annottext">content :: [PieItem]
</span><a href="#local-6989586621679373221"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373220"><span class="annot"><span class="annottext">total :: Double
</span><a href="#local-6989586621679373220"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PieItem -&gt; Double) -&gt; [PieItem] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_value"><span class="hs-identifier hs-var hs-var">_pitem_value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var hs-var">_pie_data</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373218"><span class="hs-identifier hs-var">pitem</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_pitem_value :: Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_value"><span class="hs-identifier hs-var">_pitem_value</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_value"><span class="hs-identifier hs-var hs-var">_pitem_value</span></a></span><span> </span><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373218"><span class="hs-identifier hs-var">pitem</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373220"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-162"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679373218"><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373218"><span class="hs-identifier hs-var">pitem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PieChart -&gt; [PieItem]
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_data"><span class="hs-identifier hs-var hs-var">_pie_data</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><a href="#local-6989586621679373222"><span class="hs-identifier hs-type">paint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlphaColour</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#PieItem"><span class="hs-identifier hs-type">PieItem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-166"></span><span>        </span><span id="local-6989586621679373222"><span class="annot"><span class="annottext">paint :: Point
-&gt; Double
-&gt; Double
-&gt; (AlphaColour Double, PieItem)
-&gt; ProgramT ChartBackendInstr Identity Double
</span><a href="#local-6989586621679373222"><span class="hs-identifier hs-var hs-var">paint</span></a></span></span><span> </span><span id="local-6989586621679373217"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373217"><span class="hs-identifier hs-var">center</span></a></span></span><span> </span><span id="local-6989586621679373216"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373216"><span class="hs-identifier hs-var">radius</span></a></span></span><span> </span><span id="local-6989586621679373215"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373215"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679373214"><span class="annot"><span class="annottext">AlphaColour Double
</span><a href="#local-6989586621679373214"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679373213"><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373213"><span class="hs-identifier hs-var">pitem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373212"><span class="annot"><span class="annottext">ax :: Double
</span><a href="#local-6989586621679373212"><span class="hs-identifier hs-var hs-var">ax</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">360.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_value"><span class="hs-identifier hs-var hs-var">_pitem_value</span></a></span><span> </span><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373213"><span class="hs-identifier hs-var">pitem</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373211"><span class="annot"><span class="annottext">a2 :: Double
</span><a href="#local-6989586621679373211"><span class="hs-identifier hs-var hs-var">a2</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373215"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373212"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373210"><span class="annot"><span class="annottext">a3 :: Double
</span><a href="#local-6989586621679373210"><span class="hs-identifier hs-var hs-var">a3</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373215"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373212"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373209"><span class="annot"><span class="annottext">offset :: Double
</span><a href="#local-6989586621679373209"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PieItem -&gt; Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_offset"><span class="hs-identifier hs-var hs-var">_pitem_offset</span></a></span><span> </span><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373213"><span class="hs-identifier hs-var">pitem</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">Point
-&gt; Double
-&gt; Double
-&gt; AlphaColour Double
-&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="#local-6989586621679373208"><span class="hs-identifier hs-var">pieSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><a href="#local-6989586621679373207"><span class="hs-identifier hs-var">ray</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373211"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373209"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373215"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373210"><span class="hs-identifier hs-var">a3</span></a></span><span> </span><span class="annot"><span class="annottext">AlphaColour Double
</span><a href="#local-6989586621679373214"><span class="hs-identifier hs-var">color</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span class="annot"><span class="annottext">String
-&gt; Double -&gt; Double -&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="#local-6989586621679373206"><span class="hs-identifier hs-var">pieLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieItem -&gt; String
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pitem_label"><span class="hs-identifier hs-var hs-var">_pitem_label</span></a></span><span> </span><span class="annot"><span class="annottext">PieItem
</span><a href="#local-6989586621679373213"><span class="hs-identifier hs-var">pitem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373211"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373209"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">Double -&gt; ProgramT ChartBackendInstr Identity Double
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373210"><span class="hs-identifier hs-var">a3</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>                </span><span class="annot"><a href="#local-6989586621679373206"><span class="hs-identifier hs-type">pieLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                </span><span id="local-6989586621679373206"><span class="annot"><span class="annottext">pieLabel :: String
-&gt; Double -&gt; Double -&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="#local-6989586621679373206"><span class="hs-identifier hs-var hs-var">pieLabel</span></a></span></span><span> </span><span id="local-6989586621679373205"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679373205"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679373204"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373204"><span class="hs-identifier hs-var">angle</span></a></span></span><span> </span><span id="local-6989586621679373203"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373203"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-180"></span><span>                    </span><span class="annot"><span class="annottext">FontStyle
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a. FontStyle -&gt; BackendProgram a -&gt; BackendProgram a
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#withFontStyle"><span class="hs-identifier hs-var">withFontStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; FontStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_style"><span class="hs-identifier hs-var hs-var">_pie_label_style</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProgramT ChartBackendInstr Identity ()
 -&gt; ProgramT ChartBackendInstr Identity ())
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-181"></span><span>                      </span><span class="annot"><span class="annottext">LineStyle
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a. LineStyle -&gt; BackendProgram a -&gt; BackendProgram a
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#withLineStyle"><span class="hs-identifier hs-var">withLineStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PieChart -&gt; LineStyle
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#_pie_label_line_style"><span class="hs-identifier hs-var hs-var">_pie_label_line_style</span></a></span><span> </span><span class="annot"><span class="annottext">PieChart
</span><a href="#local-6989586621679373232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProgramT ChartBackendInstr Identity ()
 -&gt; ProgramT ChartBackendInstr Identity ())
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373200"><span class="annot"><span class="annottext">p1 :: Point
</span><a href="#local-6989586621679373200"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><a href="#local-6989586621679373207"><span class="hs-identifier hs-var">ray</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373204"><span class="hs-identifier hs-var">angle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373216"><span class="hs-identifier hs-var">radius</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var">label_rgap</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rlength"><span class="hs-identifier hs-var">label_rlength</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373203"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                        </span><span id="local-6989586621679373199"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373199"><span class="hs-identifier hs-var">p1a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Point -&gt; BackendProgram Point
</span><a href="Graphics.Rendering.Chart.Drawing.html#alignStrokePoint"><span class="hs-identifier hs-var">alignStrokePoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373200"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-184"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679373197"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373197"><span class="hs-identifier hs-var">tw</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; BackendProgram RectSize
</span><a href="Graphics.Rendering.Chart.Drawing.html#textDimension"><span class="hs-identifier hs-var">textDimension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679373205"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-185"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679373196"><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373196"><span class="hs-identifier hs-var">offset'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679373195"><span class="annot"><span class="annottext">HTextAnchor
</span><a href="#local-6989586621679373195"><span class="hs-identifier hs-var">anchor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373204"><span class="hs-identifier hs-var">angle</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">90</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373204"><span class="hs-identifier hs-var">angle</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">270</span></span><span> </span><span>
</span><span id="line-186"></span><span>                                              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">HTextAnchor
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#HTA_Left"><span class="hs-identifier hs-var">HTA_Left</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                                              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">HTextAnchor
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#HTA_Right"><span class="hs-identifier hs-var">HTA_Right</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                        </span><span id="local-6989586621679373189"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373189"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Point -&gt; BackendProgram Point
</span><a href="Graphics.Rendering.Chart.Drawing.html#alignStrokePoint"><span class="hs-identifier hs-var">alignStrokePoint</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; BackendProgram Point) -&gt; Point -&gt; BackendProgram Point
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><a href="#local-6989586621679373207"><span class="hs-identifier hs-var">ray</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373204"><span class="hs-identifier hs-var">angle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373216"><span class="hs-identifier hs-var">radius</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var">label_rgap</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373203"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                        </span><span class="annot"><span class="annottext">Path -&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#strokePath"><span class="hs-identifier hs-var">strokePath</span></a></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; ProgramT ChartBackendInstr Identity ())
-&gt; Path -&gt; ProgramT ChartBackendInstr Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#moveTo"><span class="hs-identifier hs-var">G.moveTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373189"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-190"></span><span>                                  </span><span class="annot"><span class="annottext">Path -&gt; Path -&gt; Path
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#lineTo"><span class="hs-identifier hs-var">lineTo</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373199"><span class="hs-identifier hs-var">p1a</span></a></span><span>
</span><span id="line-191"></span><span>                                  </span><span class="annot"><span class="annottext">Path -&gt; Path -&gt; Path
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#lineTo%27"><span class="hs-identifier hs-var">lineTo'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point -&gt; Double
</span><a href="Graphics.Rendering.Chart.Geometry.html#p_x"><span class="hs-identifier hs-var hs-var">p_x</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373199"><span class="hs-identifier hs-var">p1a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373196"><span class="hs-identifier hs-var">offset'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373197"><span class="hs-identifier hs-var">tw</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var">label_rgap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point -&gt; Double
</span><a href="Graphics.Rendering.Chart.Geometry.html#p_y"><span class="hs-identifier hs-var hs-var">p_y</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373199"><span class="hs-identifier hs-var">p1a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373183"><span class="annot"><span class="annottext">p2 :: Point
</span><a href="#local-6989586621679373183"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373200"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Vector -&gt; Point
</span><a href="Graphics.Rendering.Chart.Geometry.html#pvadd"><span class="hs-operator hs-var">`pvadd`</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Vector
</span><a href="Graphics.Rendering.Chart.Geometry.html#Vector"><span class="hs-identifier hs-var">Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373196"><span class="hs-identifier hs-var">offset'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var">label_rgap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-194"></span><span>                        </span><span class="annot"><span class="annottext">HTextAnchor
-&gt; VTextAnchor
-&gt; Point
-&gt; String
-&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="Graphics.Rendering.Chart.Drawing.html#drawTextA"><span class="hs-identifier hs-var">drawTextA</span></a></span><span> </span><span class="annot"><span class="annottext">HTextAnchor
</span><a href="#local-6989586621679373195"><span class="hs-identifier hs-var">anchor</span></a></span><span> </span><span class="annot"><span class="annottext">VTextAnchor
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#VTA_Bottom"><span class="hs-identifier hs-var">VTA_Bottom</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373183"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679373205"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>                </span><span class="annot"><a href="#local-6989586621679373208"><span class="hs-identifier hs-type">pieSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AlphaColour</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Backend.Impl.html#BackendProgram"><span class="hs-identifier hs-type">BackendProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                </span><span id="local-6989586621679373208"><span class="annot"><span class="annottext">pieSlice :: Point
-&gt; Double
-&gt; Double
-&gt; AlphaColour Double
-&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="#local-6989586621679373208"><span class="hs-identifier hs-var hs-var">pieSlice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679373178"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373178"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679373177"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373177"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679373176"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373176"><span class="hs-identifier hs-var">arc1</span></a></span></span><span> </span><span id="local-6989586621679373175"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373175"><span class="hs-identifier hs-var">arc2</span></a></span></span><span> </span><span id="local-6989586621679373174"><span class="annot"><span class="annottext">AlphaColour Double
</span><a href="#local-6989586621679373174"><span class="hs-identifier hs-var">pColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679373173"><span class="annot"><span class="annottext">path :: Path
</span><a href="#local-6989586621679373173"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#arc%27"><span class="hs-identifier hs-var">arc'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373178"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373177"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373216"><span class="hs-identifier hs-var">radius</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373171"><span class="hs-identifier hs-var">radian</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373176"><span class="hs-identifier hs-var">arc1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373171"><span class="hs-identifier hs-var">radian</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373175"><span class="hs-identifier hs-var">arc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                            </span><span class="annot"><span class="annottext">Path -&gt; Path -&gt; Path
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#lineTo%27"><span class="hs-identifier hs-var">lineTo'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373178"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373177"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-200"></span><span>                            </span><span class="annot"><span class="annottext">Path -&gt; Path -&gt; Path
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#lineTo%27"><span class="hs-identifier hs-var">lineTo'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373178"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373177"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-201"></span><span>                            </span><span class="annot"><span class="annottext">Path -&gt; Path -&gt; Path
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="Graphics.Rendering.Chart.Geometry.html#close"><span class="hs-identifier hs-var">close</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>                    </span><span class="annot"><span class="annottext">FillStyle
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a. FillStyle -&gt; BackendProgram a -&gt; BackendProgram a
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#withFillStyle"><span class="hs-identifier hs-var">withFillStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlphaColour Double -&gt; FillStyle
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#FillStyleSolid"><span class="hs-identifier hs-var">FillStyleSolid</span></a></span><span> </span><span class="annot"><span class="annottext">AlphaColour Double
</span><a href="#local-6989586621679373174"><span class="hs-identifier hs-var">pColor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProgramT ChartBackendInstr Identity ()
 -&gt; ProgramT ChartBackendInstr Identity ())
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-204"></span><span>                      </span><span class="annot"><span class="annottext">Path -&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#fillPath"><span class="hs-identifier hs-var">fillPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679373173"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-205"></span><span>                    </span><span class="annot"><span class="annottext">LineStyle
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a. LineStyle -&gt; BackendProgram a -&gt; BackendProgram a
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#withLineStyle"><span class="hs-identifier hs-var">withLineStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineStyle
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_line_color :: AlphaColour Double
</span><a href="Graphics.Rendering.Chart.Backend.Types.html#_line_color"><span class="hs-identifier hs-var">_line_color</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Colour Double -&gt; Double -&gt; AlphaColour Double
forall a. Num a =&gt; Colour a -&gt; a -&gt; AlphaColour a
</span><span class="hs-identifier hs-var">withOpacity</span></span><span> </span><span class="annot"><span class="annottext">Colour Double
forall a. (Ord a, Floating a) =&gt; Colour a
</span><span class="hs-identifier hs-var">white</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProgramT ChartBackendInstr Identity ()
 -&gt; ProgramT ChartBackendInstr Identity ())
-&gt; ProgramT ChartBackendInstr Identity ()
-&gt; ProgramT ChartBackendInstr Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-206"></span><span>                      </span><span class="annot"><span class="annottext">Path -&gt; ProgramT ChartBackendInstr Identity ()
</span><a href="Graphics.Rendering.Chart.Backend.Impl.html#strokePath"><span class="hs-identifier hs-var">strokePath</span></a></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679373173"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>                </span><span class="annot"><a href="#local-6989586621679373207"><span class="hs-identifier hs-type">ray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span>
</span><span id="line-209"></span><span>                </span><span id="local-6989586621679373207"><span class="annot"><span class="annottext">ray :: Double -&gt; Double -&gt; Point
</span><a href="#local-6989586621679373207"><span class="hs-identifier hs-var hs-var">ray</span></a></span></span><span> </span><span id="local-6989586621679373164"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373164"><span class="hs-identifier hs-var">angle</span></a></span></span><span> </span><span id="local-6989586621679373163"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373163"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><a href="Graphics.Rendering.Chart.Geometry.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373162"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373161"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-210"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>                    </span><span id="local-6989586621679373162"><span class="annot"><span class="annottext">x' :: Double
</span><a href="#local-6989586621679373162"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373159"><span class="hs-identifier hs-var">cos'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373158"><span class="hs-identifier hs-var">x''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                    </span><span id="local-6989586621679373161"><span class="annot"><span class="annottext">y' :: Double
</span><a href="#local-6989586621679373161"><span class="hs-identifier hs-var hs-var">y'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373157"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373156"><span class="hs-identifier hs-var">sin'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373158"><span class="hs-identifier hs-var">x''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>                    </span><span id="local-6989586621679373159"><span class="annot"><span class="annottext">cos' :: Double
</span><a href="#local-6989586621679373159"><span class="hs-identifier hs-var hs-var">cos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373171"><span class="hs-identifier hs-var">radian</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373164"><span class="hs-identifier hs-var">angle</span></a></span><span>
</span><span id="line-214"></span><span>                    </span><span id="local-6989586621679373156"><span class="annot"><span class="annottext">sin' :: Double
</span><a href="#local-6989586621679373156"><span class="hs-identifier hs-var hs-var">sin'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679373171"><span class="hs-identifier hs-var">radian</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373164"><span class="hs-identifier hs-var">angle</span></a></span><span>
</span><span id="line-215"></span><span>                    </span><span class="hs-comment">-- TODO: is x'' defined in this way to try and avoid</span><span>
</span><span id="line-216"></span><span>                    </span><span class="hs-comment">--       numerical rounding?</span><span>
</span><span id="line-217"></span><span>                    </span><span id="local-6989586621679373158"><span class="annot"><span class="annottext">x'' :: Double
</span><a href="#local-6989586621679373158"><span class="hs-identifier hs-var hs-var">x''</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373163"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679373160"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-218"></span><span>                    </span><span id="local-6989586621679373160"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679373160"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double
</span><a href="Graphics.Rendering.Chart.Geometry.html#p_x"><span class="hs-identifier hs-var hs-var">p_x</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373217"><span class="hs-identifier hs-var">center</span></a></span><span>
</span><span id="line-219"></span><span>                    </span><span id="local-6989586621679373157"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679373157"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double
</span><a href="Graphics.Rendering.Chart.Geometry.html#p_y"><span class="hs-identifier hs-var hs-var">p_y</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679373217"><span class="hs-identifier hs-var">center</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>                </span><span id="local-6989586621679373171"><span class="annot"><span class="annottext">radian :: Double -&gt; Double
</span><a href="#local-6989586621679373171"><span class="hs-identifier hs-var hs-var">radian</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">180.0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-type">label_rgap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rlength"><span class="hs-identifier hs-type">label_rlength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-224"></span><span id="label_rgap"><span class="annot"><span class="annottext">label_rgap :: Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rgap"><span class="hs-identifier hs-var hs-var">label_rgap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span>
</span><span id="line-225"></span><span id="label_rlength"><span class="annot"><span class="annottext">label_rlength :: Double
</span><a href="Graphics.Rendering.Chart.Plot.Pie.html#label_rlength"><span class="hs-identifier hs-var hs-var">label_rlength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">15</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-special">$(</span><span> </span><span id="pie_margin"><span id="pie_background"><span id="pie_plot"><span id="pie_title_style"><span id="pie_title"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PieLayout</span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span class="hs-special">$(</span><span> </span><span id="pie_start_angle"><span id="pie_label_line_style"><span id="pie_label_style"><span id="pie_colors"><span id="pie_data"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PieChart</span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span class="hs-special">$(</span><span> </span><span id="pitem_value"><span id="pitem_offset"><span id="pitem_label"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PieItem</span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span></pre></body></html>