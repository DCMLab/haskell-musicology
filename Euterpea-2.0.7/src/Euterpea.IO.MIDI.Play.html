<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Euterpea.IO.MIDI.Play</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#play"><span class="hs-identifier">play</span></a></span><span> </span><span class="hs-comment">-- standard playback, allows infinite values</span><span>
</span><span id="line-3"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playDev"><span class="hs-identifier">playDev</span></a></span><span> </span><span class="hs-comment">-- play to a custom device, allows infinite values</span><span>
</span><span id="line-4"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playS"><span class="hs-identifier">playS</span></a></span><span> </span><span class="hs-comment">-- play with strict timing (finite values only)</span><span>
</span><span id="line-5"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playDevS"><span class="hs-identifier">playDevS</span></a></span><span> </span><span class="hs-comment">-- play to a custom device with strict timing (finite values only)</span><span>
</span><span id="line-6"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier">playC</span></a></span><span> </span><span class="hs-comment">-- custom playback implementation to replace playA, playS, playDev, etc.</span><span>
</span><span id="line-7"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#devices"><span class="hs-identifier">devices</span></a></span><span> </span><span class="hs-comment">-- function that prints available MIDI device information</span><span>
</span><span id="line-8"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#musicToMsgs%27"><span class="hs-identifier">musicToMsgs'</span></a></span><span> </span><span class="hs-comment">-- music to MIDI message conversion</span><span>
</span><span id="line-9"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#linearCP"><span class="hs-identifier">linearCP</span></a></span><span> </span><span class="hs-comment">-- linear channel assignment policy</span><span>
</span><span id="line-10"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#dynamicCP"><span class="hs-identifier">dynamicCP</span></a></span><span> </span><span class="hs-comment">-- dynamic channel assignment policy</span><span>
</span><span id="line-11"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#predefinedCP"><span class="hs-identifier">predefinedCP</span></a></span><span> </span><span class="hs-comment">-- user-specified channel map (for MUIs)</span><span>
</span><span id="line-12"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier">defParams</span></a></span><span>
</span><span id="line-13"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playM%27"><span class="hs-identifier">playM'</span></a></span><span>
</span><span id="line-14"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier">PlayParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier">ChannelMapFun</span></a></span><span>
</span><span id="line-16"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier">ChannelMap</span></a></span><span>
</span><span id="line-17"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Midi</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tempo</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-21"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-22"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>
</span><span id="line-23"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-24"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-25"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html"><span class="hs-identifier">Euterpea.IO.MIDI.MidiIO</span></a></span><span>
</span><span id="line-26"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.ToMidi.html"><span class="hs-identifier">Euterpea.IO.MIDI.ToMidi</span></a></span><span>
</span><span id="line-27"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MEvent.html"><span class="hs-identifier">Euterpea.IO.MIDI.MEvent</span></a></span><span>
</span><span id="line-28"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Euterpea.Music.html"><span class="hs-identifier">Euterpea.Music</span></a></span><span>
</span><span id="line-29"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Sound.PortMidi</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-32"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">User</span><span class="hs-glyph">-</span><span class="hs-identifier">Level</span><span> </span><span class="hs-identifier">Functions</span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-33"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-identifier">Playback</span><span> </span><span class="hs-identifier">parameter</span><span> </span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">type</span><span class="hs-operator">.</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><span id="PlayParams"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-var">PlayParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PlayParams"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-var">PlayParams</span></a></span></span><span class="hs-special">{</span><span>
</span><span id="line-38"></span><span class="hs-operator">&gt;</span><span>     </span><span id="strict"><span class="annot"><span class="annottext">PlayParams -&gt; Bool
</span><a href="Euterpea.IO.MIDI.Play.html#strict"><span class="hs-identifier hs-var hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- strict timing (False for infinite values)</span><span>
</span><span id="line-39"></span><span class="hs-operator">&gt;</span><span>     </span><span id="chanPolicy"><span class="annot"><span class="annottext">PlayParams -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#chanPolicy"><span class="hs-identifier hs-var hs-var">chanPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-type">ChannelMapFun</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- channel assignment policy</span><span>
</span><span id="line-40"></span><span class="hs-operator">&gt;</span><span>     </span><span id="devID"><span class="annot"><span class="annottext">PlayParams -&gt; Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var hs-var">devID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#OutputDeviceID"><span class="hs-identifier hs-type">OutputDeviceID</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- output device (Nothing means to use the OS default)</span><span>
</span><span id="line-41"></span><span class="hs-operator">&gt;</span><span>     </span><span id="closeDelay"><span class="annot"><span class="annottext">PlayParams -&gt; Time
</span><a href="Euterpea.IO.MIDI.Play.html#closeDelay"><span class="hs-identifier hs-var hs-var">closeDelay</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Time</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- offset in seconds to avoid truncated notes</span><span>
</span><span id="line-42"></span><span class="hs-operator">&gt;</span><span>     </span><span id="perfAlg"><span class="annot"><span class="annottext">PlayParams -&gt; Music1 -&gt; [MEvent]
</span><a href="Euterpea.IO.MIDI.Play.html#perfAlg"><span class="hs-identifier hs-var hs-var">perfAlg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music1"><span class="hs-identifier hs-type">Music1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Euterpea.IO.MIDI.MEvent.html#MEvent"><span class="hs-identifier hs-type">MEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-identifier">Default</span><span> </span><span class="hs-identifier">parameters</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">pmap</span><span class="hs-operator">+</span><span class="hs-identifier">context</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">allowing</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">infinite</span><span> </span><span class="hs-identifier">playback</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span class="hs-identifier">using</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">linear</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">assignment</span><span> </span><span class="hs-identifier">policy</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-identifier">channels</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">percussion</span><span> </span><span class="hs-identifier">on</span><span>
</span><span id="line-47"></span><span class="hs-identifier">channel</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">indexing</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">MIDI</span><span>
</span><span id="line-48"></span><span class="hs-identifier">device</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">set</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">operating</span><span> </span><span class="hs-identifier">system</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">closing</span><span> </span><span class="hs-identifier">offset</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-number">1.0</span><span class="hs-identifier">sec</span><span class="hs-operator">.</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-operator">&gt;</span><span> </span><span id="defParams"><span class="annot"><span class="annottext">defParams :: PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier hs-var hs-var">defParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ChannelMapFun
-&gt; Maybe OutputDeviceID
-&gt; Time
-&gt; (Music1 -&gt; [MEvent])
-&gt; PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-var">PlayParams</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#linearCP"><span class="hs-identifier hs-var">linearCP</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe OutputDeviceID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Music1 -&gt; [MEvent]
</span><a href="Euterpea.IO.MIDI.MEvent.html#perform1"><span class="hs-identifier hs-var">perform1</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-identifier">New</span><span> </span><span class="hs-identifier">implementation</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">play</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">parameters</span><span class="hs-glyph">:</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094900"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#play"><span class="hs-identifier hs-type">play</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-55"></span><span class="hs-operator">&gt;</span><span> </span><span id="play"><span class="annot"><span class="annottext">play :: Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#play"><span class="hs-identifier hs-var hs-var">play</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. (ToMusic1 a, NFData a) =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-var">playC</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier hs-var">defParams</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094899"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playS"><span class="hs-identifier hs-type">playS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-58"></span><span class="hs-operator">&gt;</span><span> </span><span id="playS"><span class="annot"><span class="annottext">playS :: Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playS"><span class="hs-identifier hs-var hs-var">playS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. (ToMusic1 a, NFData a) =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-var">playC</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier hs-var">defParams</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">strict :: Bool
</span><a href="Euterpea.IO.MIDI.Play.html#strict"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094898"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playDev"><span class="hs-identifier hs-type">playDev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094898"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094898"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094898"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-61"></span><span class="hs-operator">&gt;</span><span> </span><span id="playDev"><span class="annot"><span class="annottext">playDev :: NumChannels -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playDev"><span class="hs-identifier hs-var hs-var">playDev</span></a></span></span><span> </span><span id="local-6989586621679094897"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094897"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. (ToMusic1 a, NFData a) =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-var">playC</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier hs-var">defParams</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">devID :: Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var">devID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; Maybe OutputDeviceID
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(OutputDeviceID -&gt; Maybe OutputDeviceID)
-&gt; OutputDeviceID -&gt; Maybe OutputDeviceID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; OutputDeviceID
</span><a href="Euterpea.IO.MIDI.MidiIO.html#unsafeOutputID"><span class="hs-identifier hs-var">unsafeOutputID</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094897"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094895"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playDevS"><span class="hs-identifier hs-type">playDevS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-64"></span><span class="hs-operator">&gt;</span><span> </span><span id="playDevS"><span class="annot"><span class="annottext">playDevS :: NumChannels -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playDevS"><span class="hs-identifier hs-var hs-var">playDevS</span></a></span></span><span> </span><span id="local-6989586621679094894"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094894"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. (ToMusic1 a, NFData a) =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-var">playC</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="Euterpea.IO.MIDI.Play.html#defParams"><span class="hs-identifier hs-var">defParams</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">strict :: Bool
</span><a href="Euterpea.IO.MIDI.Play.html#strict"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">devID :: Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var">devID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; Maybe OutputDeviceID
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(OutputDeviceID -&gt; Maybe OutputDeviceID)
-&gt; OutputDeviceID -&gt; Maybe OutputDeviceID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; OutputDeviceID
</span><a href="Euterpea.IO.MIDI.MidiIO.html#unsafeOutputID"><span class="hs-identifier hs-var">unsafeOutputID</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094894"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-string">&quot;Custom play&quot;</span><span> </span><span class="hs-identifier">interface</span><span class="hs-glyph">:</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679095027"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-type">playC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095027"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679095027"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-type">PlayParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095027"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-69"></span><span class="hs-operator">&gt;</span><span> </span><span id="playC"><span class="annot"><span class="annottext">playC :: PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playC"><span class="hs-identifier hs-var hs-var">playC</span></a></span></span><span> </span><span id="local-6989586621679094893"><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094893"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Bool
</span><a href="Euterpea.IO.MIDI.Play.html#strict"><span class="hs-identifier hs-var hs-var">strict</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094893"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. (ToMusic1 a, NFData a) =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playStrict"><span class="hs-identifier hs-var">playStrict</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094893"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; IO ()
forall a. ToMusic1 a =&gt; PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playInf"><span class="hs-identifier hs-var">playInf</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094893"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-identifier">Getting</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">list</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">MIDI</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">output</span><span> </span><span class="hs-identifier">devices</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">showing</span><span> </span><span class="hs-identifier">both</span><span>
</span><span id="line-72"></span><span class="hs-identifier">their</span><span> </span><span class="hs-identifier">device</span><span> </span><span class="hs-identifier">IDs</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">names</span><span class="hs-operator">.</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-operator">&gt;</span><span> </span><span id="devices"><span class="annot"><span class="annottext">devices :: IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#devices"><span class="hs-identifier hs-var hs-var">devices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679094890"><span class="annot"><span class="annottext">[(InputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094890"><span class="hs-identifier hs-var">devsIn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094889"><span class="annot"><span class="annottext">[(OutputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094889"><span class="hs-identifier hs-var">devsOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ([(InputDeviceID, DeviceInfo)], [(OutputDeviceID, DeviceInfo)])
</span><a href="Euterpea.IO.MIDI.MidiIO.html#getAllDevices"><span class="hs-identifier hs-var">getAllDevices</span></a></span><span>
</span><span id="line-76"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094887"><span class="annot"><span class="annottext">f :: (a, DeviceInfo) -&gt; [Char]
</span><a href="#local-6989586621679094887"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094886"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094886"><span class="hs-identifier hs-var">devid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094885"><span class="annot"><span class="annottext">DeviceInfo
</span><a href="#local-6989586621679094885"><span class="hs-identifier hs-var">devname</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094886"><span class="hs-identifier hs-var">devid</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\t&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DeviceInfo -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var">name</span></span><span> </span><span class="annot"><span class="annottext">DeviceInfo
</span><a href="#local-6989586621679094885"><span class="hs-identifier hs-var">devname</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-77"></span><span class="hs-operator">&gt;</span><span>       </span><span id="local-6989586621679094882"><span class="annot"><span class="annottext">strIn :: [Char]
</span><a href="#local-6989586621679094882"><span class="hs-identifier hs-var hs-var">strIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((InputDeviceID, DeviceInfo) -&gt; [Char])
-&gt; [(InputDeviceID, DeviceInfo)] -&gt; [Char]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(InputDeviceID, DeviceInfo) -&gt; [Char]
forall a. Show a =&gt; (a, DeviceInfo) -&gt; [Char]
</span><a href="#local-6989586621679094887"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(InputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094890"><span class="hs-identifier hs-var">devsIn</span></a></span><span>
</span><span id="line-78"></span><span class="hs-operator">&gt;</span><span>       </span><span id="local-6989586621679094880"><span class="annot"><span class="annottext">strOut :: [Char]
</span><a href="#local-6989586621679094880"><span class="hs-identifier hs-var hs-var">strOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((OutputDeviceID, DeviceInfo) -&gt; [Char])
-&gt; [(OutputDeviceID, DeviceInfo)] -&gt; [Char]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(OutputDeviceID, DeviceInfo) -&gt; [Char]
forall a. Show a =&gt; (a, DeviceInfo) -&gt; [Char]
</span><a href="#local-6989586621679094887"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(OutputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094889"><span class="hs-identifier hs-var">devsOut</span></a></span><span>
</span><span id="line-79"></span><span class="hs-operator">&gt;</span><span>   </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\nInput devices: &quot;</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094882"><span class="hs-identifier hs-var">strIn</span></a></span><span>
</span><span id="line-80"></span><span class="hs-operator">&gt;</span><span>   </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Output devices: &quot;</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094880"><span class="hs-identifier hs-var">strOut</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-84"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Supporting</span><span> </span><span class="hs-identifier">functions</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">playC</span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-85"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-identifier">Strict</span><span> </span><span class="hs-identifier">playback</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">timing</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">close</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">perfect</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">possible</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">but</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-88"></span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-identifier">must</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">finite</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Timing</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">correct</span><span> </span><span class="hs-identifier">starting</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span>
</span><span id="line-89"></span><span class="hs-identifier">note</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">even</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">there</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">long</span><span> </span><span class="hs-identifier">computation</span><span> </span><span class="hs-identifier">offset</span><span> </span><span class="hs-identifier">prior</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">sound</span><span class="hs-operator">.</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094878"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playStrict"><span class="hs-identifier hs-type">playStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-type">PlayParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-92"></span><span class="hs-operator">&gt;</span><span> </span><span id="playStrict"><span class="annot"><span class="annottext">playStrict :: PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playStrict"><span class="hs-identifier hs-var hs-var">playStrict</span></a></span></span><span> </span><span id="local-6989586621679094877"><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094877"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679094876"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094876"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094876"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; IO () -&gt; IO ()
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span>
</span><span id="line-93"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094874"><span class="annot"><span class="annottext">x :: Midi
</span><a href="#local-6989586621679094874"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MEvent] -&gt; Midi
</span><a href="Euterpea.IO.MIDI.ToMidi.html#toMidi"><span class="hs-identifier hs-var">toMidi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; Music1 -&gt; [MEvent]
</span><a href="Euterpea.IO.MIDI.Play.html#perfAlg"><span class="hs-identifier hs-var hs-var">perfAlg</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094877"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Music1 -&gt; [MEvent]) -&gt; Music1 -&gt; [MEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; Music1
forall a. ToMusic1 a =&gt; Music a -&gt; Music1
</span><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier hs-var">toMusic1</span></a></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094876"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Midi
</span><a href="#local-6989586621679094874"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Midi -&gt; IO () -&gt; IO ()
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span> </span><span class="annot"><span class="annottext">Maybe OutputDeviceID -&gt; Midi -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playM%27"><span class="hs-identifier hs-var">playM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var hs-var">devID</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094877"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Midi
</span><a href="#local-6989586621679094874"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playM%27"><span class="hs-identifier hs-type">playM'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#OutputDeviceID"><span class="hs-identifier hs-type">OutputDeviceID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Midi</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-operator">&gt;</span><span> </span><span id="playM%27"><span class="annot"><span class="annottext">playM' :: Maybe OutputDeviceID -&gt; Midi -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playM%27"><span class="hs-identifier hs-var hs-var">playM'</span></a></span></span><span> </span><span id="local-6989586621679094871"><span class="annot"><span class="annottext">Maybe OutputDeviceID
</span><a href="#local-6989586621679094871"><span class="hs-identifier hs-var">devID</span></a></span></span><span> </span><span id="local-6989586621679094870"><span class="annot"><span class="annottext">Midi
</span><a href="#local-6989586621679094870"><span class="hs-identifier hs-var">midi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679094869"><span class="hs-identifier hs-var">handleCtrlC</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">IO (Either PMError PMSuccess)
</span><span class="hs-identifier hs-var">initialize</span></span><span>
</span><span id="line-99"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Midi -&gt; IO ())
-&gt; (OutputDeviceID -&gt; Midi -&gt; IO ())
-&gt; Maybe OutputDeviceID
-&gt; Midi
-&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(OutputDeviceID -&gt; Midi -&gt; IO ()) -&gt; Midi -&gt; IO ()
forall a b. (OutputDeviceID -&gt; a -&gt; IO b) -&gt; a -&gt; IO b
</span><a href="Euterpea.IO.MIDI.MidiIO.html#defaultOutput"><span class="hs-identifier hs-var">defaultOutput</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; Midi -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#playMidi"><span class="hs-identifier hs-var">playMidi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; Midi -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#playMidi"><span class="hs-identifier hs-var">playMidi</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputDeviceID
</span><a href="#local-6989586621679094871"><span class="hs-identifier hs-var">devID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Midi
</span><a href="#local-6989586621679094870"><span class="hs-identifier hs-var">midi</span></a></span><span>
</span><span id="line-100"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">IO (Either PMError PMSuccess)
</span><span class="hs-identifier hs-var">terminate</span></span><span>
</span><span id="line-101"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679095000"><span class="annot"><a href="#local-6989586621679094869"><span class="hs-identifier hs-type">handleCtrlC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679095000"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679095000"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-103"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094869"><span class="annot"><span class="annottext">handleCtrlC :: IO a -&gt; IO a
</span><a href="#local-6989586621679094869"><span class="hs-identifier hs-var hs-var">handleCtrlC</span></a></span></span><span> </span><span id="local-6989586621679094863"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679094863"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either PMError PMSuccess) -&gt; IO a
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-identifier hs-var">onException</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679094863"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either PMError PMSuccess)
</span><span class="hs-identifier hs-var">terminate</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-identifier">Infinite</span><span> </span><span class="hs-identifier">playback</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">arbitrarily</span><span> </span><span class="hs-identifier">long</span><span> </span><span class="hs-identifier">music</span><span> </span><span class="hs-identifier">values</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">played</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">although</span><span>
</span><span id="line-107"></span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">compromise</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">timing</span><span> </span><span class="hs-identifier">may</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">imperfect</span><span> </span><span class="hs-identifier">due</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">lazy</span><span> </span><span class="hs-identifier">evaluation</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">value</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Delays</span><span> </span><span class="hs-identifier">may</span><span> </span><span class="hs-identifier">happen</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">section</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">time</span><span class="hs-glyph">-</span><span>
</span><span id="line-109"></span><span class="hs-identifier">consuming</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">compute</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Infinite</span><span> </span><span class="hs-identifier">parallelism</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">supported</span><span class="hs-operator">.</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679095017"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playInf"><span class="hs-identifier hs-type">playInf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-type">PlayParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span class="hs-operator">&gt;</span><span> </span><span id="playInf"><span class="annot"><span class="annottext">playInf :: PlayParams -&gt; Music a -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playInf"><span class="hs-identifier hs-var hs-var">playInf</span></a></span></span><span> </span><span id="local-6989586621679094861"><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094861"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679094860"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094860"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679094859"><span class="hs-identifier hs-var">handleCtrlC</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#initializeMidi"><span class="hs-identifier hs-var">initializeMidi</span></a></span><span>
</span><span id="line-114"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Time, MidiMessage)] -&gt; IO ())
-&gt; (OutputDeviceID -&gt; [(Time, MidiMessage)] -&gt; IO ())
-&gt; Maybe OutputDeviceID
-&gt; [(Time, MidiMessage)]
-&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(OutputDeviceID -&gt; [(Time, MidiMessage)] -&gt; IO ())
-&gt; [(Time, MidiMessage)] -&gt; IO ()
forall a b. (OutputDeviceID -&gt; a -&gt; IO b) -&gt; a -&gt; IO b
</span><a href="Euterpea.IO.MIDI.MidiIO.html#defaultOutput"><span class="hs-identifier hs-var">defaultOutput</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; [(Time, MidiMessage)] -&gt; IO ()
forall a.
RealFrac a =&gt;
OutputDeviceID -&gt; [(a, MidiMessage)] -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var">playRec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; [(Time, MidiMessage)] -&gt; IO ()
forall a.
RealFrac a =&gt;
OutputDeviceID -&gt; [(a, MidiMessage)] -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var">playRec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var hs-var">devID</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094861"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Time, MidiMessage)] -&gt; IO ()) -&gt; [(Time, MidiMessage)] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music a -&gt; [(Time, MidiMessage)]
forall a.
ToMusic1 a =&gt;
PlayParams -&gt; Music a -&gt; [(Time, MidiMessage)]
</span><a href="Euterpea.IO.MIDI.Play.html#musicToMsgs%27"><span class="hs-identifier hs-var">musicToMsgs'</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094861"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094860"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-115"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">NumChannels -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">(NumChannels -&gt; IO ()) -&gt; NumChannels -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; NumChannels
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; Time
</span><a href="Euterpea.IO.MIDI.Play.html#closeDelay"><span class="hs-identifier hs-var hs-var">closeDelay</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094861"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#terminateMidi"><span class="hs-identifier hs-var">terminateMidi</span></a></span><span>
</span><span id="line-117"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094852"><span class="annot"><a href="#local-6989586621679094859"><span class="hs-identifier hs-type">handleCtrlC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094852"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-119"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094859"><span class="annot"><span class="annottext">handleCtrlC :: IO a -&gt; IO a
</span><a href="#local-6989586621679094859"><span class="hs-identifier hs-var hs-var">handleCtrlC</span></a></span></span><span> </span><span id="local-6989586621679094851"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679094851"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094850"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094850"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe OutputDeviceID -&gt; IO OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#resolveOutDev"><span class="hs-identifier hs-var">resolveOutDev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; Maybe OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#devID"><span class="hs-identifier hs-var hs-var">devID</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094861"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">IO a -&gt; IO () -&gt; IO a
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-identifier hs-var">onException</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679094851"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputDeviceID -&gt; NumChannels -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#stopMidiOut"><span class="hs-identifier hs-var">stopMidiOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094850"><span class="hs-identifier hs-var">dev</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-identifier">Bug</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">Sept</span><span> </span><span class="hs-number">24</span><span class="hs-special">,</span><span> </span><span class="hs-number">2018</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">Mac</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">output</span><span> </span><span class="hs-identifier">device</span><span> </span><span class="hs-identifier">may</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">zero</span><span class="hs-operator">.</span><span>
</span><span id="line-124"></span><span class="hs-identifier">In</span><span> </span><span class="hs-identifier">rare</span><span> </span><span class="hs-identifier">cases</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">Mac</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">there</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">outputs</span><span> </span><span class="hs-identifier">but</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">ID</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">but</span><span>
</span><span id="line-125"></span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">these</span><span> </span><span class="hs-identifier">cases</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">always</span><span> </span><span class="hs-identifier">seems</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">output</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">list</span><span class="hs-operator">.</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-operator">&gt;</span><span> </span><span id="resolveOutDev"><span class="annot"><span class="annottext">resolveOutDev :: Maybe OutputDeviceID -&gt; IO OutputDeviceID
</span><a href="Euterpea.IO.MIDI.Play.html#resolveOutDev"><span class="hs-identifier hs-var hs-var">resolveOutDev</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe OutputDeviceID
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679094847"><span class="annot"><span class="annottext">Maybe NumChannels
</span><a href="#local-6989586621679094847"><span class="hs-identifier hs-var">outDevM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe NumChannels)
</span><span class="hs-identifier hs-var">getDefaultOutputDeviceID</span></span><span>
</span><span id="line-129"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679094845"><span class="annot"><span class="annottext">[(InputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094845"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679094844"><span class="annot"><span class="annottext">[(OutputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094844"><span class="hs-identifier hs-var">outs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ([(InputDeviceID, DeviceInfo)], [(OutputDeviceID, DeviceInfo)])
</span><a href="Euterpea.IO.MIDI.MidiIO.html#getAllDevices"><span class="hs-identifier hs-var">getAllDevices</span></a></span><span>
</span><span id="line-130"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094843"><span class="annot"><span class="annottext">allOutDevs :: [OutputDeviceID]
</span><a href="#local-6989586621679094843"><span class="hs-identifier hs-var hs-var">allOutDevs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((OutputDeviceID, DeviceInfo) -&gt; OutputDeviceID)
-&gt; [(OutputDeviceID, DeviceInfo)] -&gt; [OutputDeviceID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(OutputDeviceID, DeviceInfo) -&gt; OutputDeviceID
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(OutputDeviceID, DeviceInfo)]
</span><a href="#local-6989586621679094844"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-131"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094842"><span class="annot"><span class="annottext">outDev :: OutputDeviceID
</span><a href="#local-6989586621679094842"><span class="hs-identifier hs-var hs-var">outDev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe NumChannels
</span><a href="#local-6989586621679094847"><span class="hs-identifier hs-var">outDevM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="annot"><span class="annottext">Maybe NumChannels
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span class="hs-operator">&gt;</span><span>                            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[OutputDeviceID] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[OutputDeviceID]
</span><a href="#local-6989586621679094843"><span class="hs-identifier hs-var">allOutDevs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; OutputDeviceID
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No MIDI outputs!&quot;</span></span><span>
</span><span id="line-134"></span><span class="hs-operator">&gt;</span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[OutputDeviceID] -&gt; OutputDeviceID
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[OutputDeviceID]
</span><a href="#local-6989586621679094843"><span class="hs-identifier hs-var">allOutDevs</span></a></span><span>
</span><span id="line-135"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094838"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; OutputDeviceID
</span><a href="Euterpea.IO.MIDI.MidiIO.html#unsafeOutputID"><span class="hs-identifier hs-var">unsafeOutputID</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094838"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-136"></span><span class="hs-operator">&gt;</span><span>    </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; IO OutputDeviceID
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094842"><span class="hs-identifier hs-var">outDev</span></a></span><span>
</span><span id="line-137"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#resolveOutDev"><span class="hs-identifier hs-var">resolveOutDev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094837"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094837"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; IO OutputDeviceID
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094837"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#stopMidiOut"><span class="hs-identifier hs-type">stopMidiOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#OutputDeviceID"><span class="hs-identifier hs-type">OutputDeviceID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Channel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-operator">&gt;</span><span> </span><span id="stopMidiOut"><span class="annot"><span class="annottext">stopMidiOut :: OutputDeviceID -&gt; NumChannels -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#stopMidiOut"><span class="hs-identifier hs-var hs-var">stopMidiOut</span></a></span></span><span> </span><span id="local-6989586621679094835"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094835"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span id="local-6989586621679094834"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094834"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094834"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1000000</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#terminateMidi"><span class="hs-identifier hs-var">terminateMidi</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; (Time, MidiMessage) -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#deliverMidiEvent"><span class="hs-identifier hs-var">deliverMidiEvent</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094835"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Message -&gt; MidiMessage
</span><a href="Euterpea.IO.MIDI.MidiIO.html#Std"><span class="hs-identifier hs-var">Std</span></a></span><span> </span><span class="annot"><span class="annottext">(Message -&gt; MidiMessage) -&gt; Message -&gt; MidiMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels -&gt; Message
</span><span class="hs-identifier hs-var">ControlChange</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094834"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">123</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; NumChannels -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#stopMidiOut"><span class="hs-identifier hs-var">stopMidiOut</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094835"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094834"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-operator">&gt;</span><span> </span><span id="playRec"><span class="annot"><span class="annottext">playRec :: OutputDeviceID -&gt; [(a, MidiMessage)] -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var hs-var">playRec</span></a></span></span><span> </span><span id="local-6989586621679094829"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094829"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var">playRec</span></a></span><span> </span><span id="local-6989586621679094828"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094828"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094827"><span class="annot"><span class="annottext">x :: (a, MidiMessage)
</span><a href="#local-6989586621679094827"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679094826"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094826"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679094825"><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094825"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679094824"><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094826"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; NumChannels
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="#local-6989586621679094822"><span class="hs-identifier hs-var">toMicroSec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094826"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; [(a, MidiMessage)] -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var">playRec</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094828"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094825"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, MidiMessage) -&gt; [(a, MidiMessage)] -&gt; [(a, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-147"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094821"><span class="annot"><span class="annottext">mNow :: [(a, MidiMessage)]
</span><a href="#local-6989586621679094821"><span class="hs-identifier hs-var hs-var">mNow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, MidiMessage)
</span><a href="#local-6989586621679094827"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(a, MidiMessage) -&gt; [(a, MidiMessage)] -&gt; [(a, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((a, MidiMessage) -&gt; Bool)
-&gt; [(a, MidiMessage)] -&gt; [(a, MidiMessage)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; ((a, MidiMessage) -&gt; a) -&gt; (a, MidiMessage) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(a, MidiMessage) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-148"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094817"><span class="annot"><span class="annottext">mLater :: [(a, MidiMessage)]
</span><a href="#local-6989586621679094817"><span class="hs-identifier hs-var hs-var">mLater</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; [(a, MidiMessage)] -&gt; [(a, MidiMessage)]
forall a. NumChannels -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, MidiMessage)] -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094821"><span class="hs-identifier hs-var">mNow</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-149"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; Maybe [(a, MidiMessage)] -&gt; IO ()
forall (t :: * -&gt; *) a.
Foldable t =&gt;
OutputDeviceID -&gt; Maybe (t (a, MidiMessage)) -&gt; IO ()
</span><a href="#local-6989586621679094814"><span class="hs-identifier hs-var">doMidiOut</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094828"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, MidiMessage)] -&gt; Maybe [(a, MidiMessage)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([(a, MidiMessage)] -&gt; Maybe [(a, MidiMessage)])
-&gt; [(a, MidiMessage)] -&gt; Maybe [(a, MidiMessage)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094821"><span class="hs-identifier hs-var">mNow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; [(a, MidiMessage)] -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.Play.html#playRec"><span class="hs-identifier hs-var">playRec</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094828"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, MidiMessage)]
</span><a href="#local-6989586621679094817"><span class="hs-identifier hs-var">mLater</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094814"><span class="annot"><span class="annottext">doMidiOut :: OutputDeviceID -&gt; Maybe (t (a, MidiMessage)) -&gt; IO ()
</span><a href="#local-6989586621679094814"><span class="hs-identifier hs-var hs-var">doMidiOut</span></a></span></span><span> </span><span id="local-6989586621679094813"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094813"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (t (a, MidiMessage))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#outputMidi"><span class="hs-identifier hs-var">outputMidi</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094813"><span class="hs-identifier hs-var">dev</span></a></span><span>
</span><span id="line-151"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094814"><span class="hs-identifier hs-var">doMidiOut</span></a></span><span> </span><span id="local-6989586621679094811"><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094811"><span class="hs-identifier hs-var">dev</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094810"><span class="annot"><span class="annottext">t (a, MidiMessage)
</span><a href="#local-6989586621679094810"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#outputMidi"><span class="hs-identifier hs-var">outputMidi</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094811"><span class="hs-identifier hs-var">dev</span></a></span><span>
</span><span id="line-153"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">((a, MidiMessage) -&gt; IO ()) -&gt; t (a, MidiMessage) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679094808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094808"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679094807"><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094807"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OutputDeviceID -&gt; (Time, MidiMessage) -&gt; IO ()
</span><a href="Euterpea.IO.MIDI.MidiIO.html#deliverMidiEvent"><span class="hs-identifier hs-var">deliverMidiEvent</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDeviceID
</span><a href="#local-6989586621679094811"><span class="hs-identifier hs-var">dev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094807"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (a, MidiMessage)
</span><a href="#local-6989586621679094810"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-154"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094822"><span class="annot"><span class="annottext">toMicroSec :: a -&gt; b
</span><a href="#local-6989586621679094822"><span class="hs-identifier hs-var hs-var">toMicroSec</span></a></span></span><span> </span><span id="local-6989586621679094806"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094806"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094806"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-158"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">Message</span><span> </span><span class="hs-identifier">conversion</span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-159"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">message</span><span> </span><span class="hs-identifier">conversion</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">place</span><span> </span><span class="hs-identifier">differently</span><span> </span><span class="hs-identifier">depending</span><span>
</span><span id="line-162"></span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">assignment</span><span> </span><span class="hs-identifier">method</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Using</span><span> </span><span class="hs-identifier">linearCP</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">assign</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span>
</span><span id="line-163"></span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">instruments</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">channels</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">through</span><span> </span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">or</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">through</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Using</span><span>
</span><span id="line-164"></span><span class="hs-identifier">dynamicCP</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fill</span><span> </span><span class="hs-identifier">up</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">channels</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">replace</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">last</span><span class="hs-glyph">-</span><span class="hs-identifier">used</span><span>
</span><span id="line-165"></span><span class="hs-identifier">instrument's</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">new</span><span> </span><span class="hs-identifier">instrument</span><span class="hs-operator">.</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-identifier">Some</span><span> </span><span class="hs-identifier">synthesizers</span><span> </span><span class="hs-identifier">only</span><span> </span><span class="hs-identifier">recognize</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-identifier">unique</span><span> </span><span class="hs-identifier">channels</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">others</span><span> </span><span class="hs-identifier">use</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-168"></span><span class="hs-identifier">full</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-identifier">allowed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">general</span><span> </span><span class="hs-identifier">MIDI</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Drums</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">usually</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-number">9</span><span>
</span><span id="line-169"></span><span class="hs-special">(</span><span class="hs-identifier">channel</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">indexing</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">but</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">always</span><span class="hs-operator">.</span><span>  </span><span class="hs-identifier">Sometimes</span><span> </span><span class="hs-identifier">drums</span><span>
</span><span id="line-170"></span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">assigned</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">custom</span><span> </span><span class="hs-identifier">channel</span><span class="hs-operator">.</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-identifier">A</span><span> </span><span class="hs-identifier">ChannelMap</span><span> </span><span class="hs-identifier">stores</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">instrument</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">assigned</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">channel</span><span class="hs-operator">.</span><span>
</span><span id="line-173"></span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">table</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">built</span><span> </span><span class="hs-identifier">automatically</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">playing</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-174"></span><span class="hs-identifier">user</span><span> </span><span class="hs-identifier">does</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">need</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">worry</span><span> </span><span class="hs-identifier">about</span><span> </span><span class="hs-identifier">constructing</span><span> </span><span class="hs-identifier">it</span><span class="hs-operator">.</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="ChannelMap"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier hs-var">ChannelMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Channel</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-identifier">Given</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">InstrumentName</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">ChannelMap</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">ChannelMapFun</span><span> </span><span class="hs-identifier">picks</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">new</span><span>
</span><span id="line-179"></span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">assign</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">instrument</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">retruns</span><span> </span><span class="hs-identifier">both</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-180"></span><span class="hs-identifier">updated</span><span> </span><span class="hs-identifier">ChannelMap</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">done</span><span> </span><span class="hs-identifier">each</span><span> </span><span class="hs-identifier">time</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">new</span><span> </span><span class="hs-identifier">InstrumentName</span><span> </span><span class="hs-identifier">is</span><span>
</span><span id="line-181"></span><span class="hs-identifier">encountered</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">words</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">current</span><span> </span><span class="hs-identifier">ChannelMap</span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="ChannelMapFun"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-var">ChannelMapFun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier hs-type">ChannelMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Channel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier hs-type">ChannelMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">function</span><span> </span><span class="hs-identifier">below</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">converts</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">ANote</span><span> </span><span class="hs-identifier">values</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">Std</span><span> </span><span class="hs-identifier">On</span><span class="hs-operator">/</span><span class="hs-identifier">Off</span><span>
</span><span id="line-186"></span><span class="hs-identifier">pairs</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">needed</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">avoid</span><span> </span><span class="hs-identifier">timing</span><span> </span><span class="hs-identifier">issues</span><span> </span><span class="hs-identifier">associated</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-identifier">ANote</span><span>
</span><span id="line-187"></span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">trying</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">call</span><span> </span><span class="hs-identifier">terminateMIDI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">since</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">there</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">ANote</span><span> </span><span class="hs-identifier">at</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">end</span><span>
</span><span id="line-188"></span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">sometimes</span><span> </span><span class="hs-identifier">have</span><span> </span><span class="hs-identifier">its</span><span> </span><span class="hs-identifier">NoteOff</span><span> </span><span class="hs-identifier">lost</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">cause</span><span> </span><span class="hs-identifier">errors</span><span class="hs-operator">.</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094986"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#musicToMsgs%27"><span class="hs-identifier hs-type">musicToMsgs'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PlayParams"><span class="hs-identifier hs-type">PlayParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Time</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#MidiMessage"><span class="hs-identifier hs-type">MidiMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-191"></span><span class="hs-operator">&gt;</span><span> </span><span id="musicToMsgs%27"><span class="annot"><span class="annottext">musicToMsgs' :: PlayParams -&gt; Music a -&gt; [(Time, MidiMessage)]
</span><a href="Euterpea.IO.MIDI.Play.html#musicToMsgs%27"><span class="hs-identifier hs-var hs-var">musicToMsgs'</span></a></span></span><span> </span><span id="local-6989586621679094805"><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094805"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679094804"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094804"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094803"><span class="annot"><span class="annottext">perf :: [MEvent]
</span><a href="#local-6989586621679094803"><span class="hs-identifier hs-var hs-var">perf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayParams -&gt; Music1 -&gt; [MEvent]
</span><a href="Euterpea.IO.MIDI.Play.html#perfAlg"><span class="hs-identifier hs-var hs-var">perfAlg</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094805"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Music1 -&gt; [MEvent]) -&gt; Music1 -&gt; [MEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; Music1
forall a. ToMusic1 a =&gt; Music a -&gt; Music1
</span><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier hs-var">toMusic1</span></a></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094804"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-comment">-- obtain the performance</span><span>
</span><span id="line-193"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094802"><span class="annot"><span class="annottext">evsA :: [(Time, MidiMessage)]
</span><a href="#local-6989586621679094802"><span class="hs-identifier hs-var hs-var">evsA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelMapFun -&gt; ChannelMap -&gt; [MEvent] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094801"><span class="hs-identifier hs-var">channelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayParams -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#chanPolicy"><span class="hs-identifier hs-var hs-var">chanPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">PlayParams
</span><a href="#local-6989586621679094805"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MEvent]
</span><a href="#local-6989586621679094803"><span class="hs-identifier hs-var">perf</span></a></span><span> </span><span class="hs-comment">-- time-stamped ANote values</span><span>
</span><span id="line-194"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094800"><span class="annot"><span class="annottext">evs :: [(Time, MidiMessage)]
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var hs-var">evs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094799"><span class="hs-identifier hs-var">stdMerge</span></a></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094802"><span class="hs-identifier hs-var">evsA</span></a></span><span> </span><span class="hs-comment">-- merged On/Off events sorted by absolute time</span><span>
</span><span id="line-195"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094798"><span class="annot"><span class="annottext">times :: [Time]
</span><a href="#local-6989586621679094798"><span class="hs-identifier hs-var hs-var">times</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Time, MidiMessage) -&gt; Time) -&gt; [(Time, MidiMessage)] -&gt; [Time]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage) -&gt; Time
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var">evs</span></a></span><span> </span><span class="hs-comment">-- absolute times in seconds</span><span>
</span><span id="line-196"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094797"><span class="annot"><span class="annottext">newTimes :: [Time]
</span><a href="#local-6989586621679094797"><span class="hs-identifier hs-var hs-var">newTimes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Time -&gt; Time -&gt; Time) -&gt; [Time] -&gt; [Time] -&gt; [Time]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Time] -&gt; Time
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094798"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; [Time] -&gt; [Time]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094798"><span class="hs-identifier hs-var">times</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094798"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-comment">-- relative times</span><span>
</span><span id="line-197"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Time] -&gt; [MidiMessage] -&gt; [(Time, MidiMessage)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094797"><span class="hs-identifier hs-var">newTimes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Time, MidiMessage) -&gt; MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [MidiMessage]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage) -&gt; MidiMessage
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var">evs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- stdMerge: converts ANotes into a sorted list of On/Off events</span><span>
</span><span id="line-199"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094799"><span class="hs-identifier hs-type">stdMerge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Time</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#MidiMessage"><span class="hs-identifier hs-type">MidiMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Time</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#MidiMessage"><span class="hs-identifier hs-type">MidiMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094799"><span class="annot"><span class="annottext">stdMerge :: [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094799"><span class="hs-identifier hs-var hs-var">stdMerge</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094799"><span class="hs-identifier hs-var">stdMerge</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679094794"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094794"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#ANote"><span class="hs-identifier hs-type">ANote</span></a></span><span> </span><span id="local-6989586621679094792"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094792"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094791"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094791"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679094790"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094790"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679094789"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094789"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679094788"><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094788"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094794"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Message -&gt; MidiMessage
</span><a href="Euterpea.IO.MIDI.MidiIO.html#Std"><span class="hs-identifier hs-var">Std</span></a></span><span> </span><span class="annot"><span class="annottext">(Message -&gt; MidiMessage) -&gt; Message -&gt; MidiMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels -&gt; Message
</span><span class="hs-identifier hs-var">NoteOn</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094792"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094791"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094790"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-203"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">[(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094799"><span class="hs-identifier hs-var">stdMerge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Time, MidiMessage) -&gt; (Time, MidiMessage) -&gt; Ordering)
-&gt; (Time, MidiMessage)
-&gt; [(Time, MidiMessage)]
-&gt; [(Time, MidiMessage)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">insertBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679094785"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094785"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679094784"><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094784"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094783"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094783"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679094782"><span class="annot"><span class="annottext">MidiMessage
</span><a href="#local-6989586621679094782"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094785"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094783"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094794"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094789"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Message -&gt; MidiMessage
</span><a href="Euterpea.IO.MIDI.MidiIO.html#Std"><span class="hs-identifier hs-var">Std</span></a></span><span> </span><span class="annot"><span class="annottext">(Message -&gt; MidiMessage) -&gt; Message -&gt; MidiMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels -&gt; Message
</span><span class="hs-identifier hs-var">NoteOff</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094792"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094791"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094790"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094788"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094799"><span class="hs-identifier hs-var">stdMerge</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094778"><span class="annot"><span class="annottext">(Time, MidiMessage)
</span><a href="#local-6989586621679094778"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679094777"><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094777"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
</span><a href="#local-6989586621679094778"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094799"><span class="hs-identifier hs-var">stdMerge</span></a></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094777"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-205"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- channelMap: performs instrument assignment for a list of Events</span><span>
</span><span id="line-206"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094801"><span class="hs-identifier hs-type">channelMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-type">ChannelMapFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier hs-type">ChannelMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Euterpea.IO.MIDI.MEvent.html#MEvent"><span class="hs-identifier hs-type">MEvent</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Time</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#MidiMessage"><span class="hs-identifier hs-type">MidiMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094801"><span class="annot"><span class="annottext">channelMap :: ChannelMapFun -&gt; ChannelMap -&gt; [MEvent] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094801"><span class="hs-identifier hs-var hs-var">channelMap</span></a></span></span><span> </span><span id="local-6989586621679094776"><span class="annot"><span class="annottext">ChannelMapFun
</span><a href="#local-6989586621679094776"><span class="hs-identifier hs-var">cf</span></a></span></span><span> </span><span id="local-6989586621679094775"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094775"><span class="hs-identifier hs-var">cMap</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679094801"><span class="hs-identifier hs-var">channelMap</span></a></span><span> </span><span id="local-6989586621679094774"><span class="annot"><span class="annottext">ChannelMapFun
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">cf</span></a></span></span><span> </span><span id="local-6989586621679094773"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var">cMap</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094772"><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679094771"><span class="annot"><span class="annottext">[MEvent]
</span><a href="#local-6989586621679094771"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094770"><span class="annot"><span class="annottext">i :: InstrumentName
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MEvent -&gt; InstrumentName
</span><a href="Euterpea.IO.MIDI.MEvent.html#eInst"><span class="hs-identifier hs-var hs-var">eInst</span></a></span><span> </span><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-210"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679094768"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094768"><span class="hs-identifier hs-var">chan</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094767"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094767"><span class="hs-identifier hs-var">cMap'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094766"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679094766"><span class="hs-identifier hs-var">newI</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InstrumentName -&gt; ChannelMap -&gt; Maybe NumChannels
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var">cMap</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe NumChannels
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChannelMapFun
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var">cMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span class="hs-operator">&gt;</span><span>                                                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094764"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094764"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094764"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var">cMap</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span class="hs-operator">&gt;</span><span>             </span><span id="local-6989586621679094763"><span class="annot"><span class="annottext">e' :: (Time, MidiMessage)
</span><a href="#local-6989586621679094763"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Time
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MEvent -&gt; Rational
</span><a href="Euterpea.IO.MIDI.MEvent.html#eTime"><span class="hs-identifier hs-var hs-var">eTime</span></a></span><span> </span><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels -&gt; Time -&gt; MidiMessage
</span><a href="Euterpea.IO.MIDI.MidiIO.html#ANote"><span class="hs-identifier hs-var">ANote</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094768"><span class="hs-identifier hs-var">chan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MEvent -&gt; NumChannels
</span><a href="Euterpea.IO.MIDI.MEvent.html#ePitch"><span class="hs-identifier hs-var hs-var">ePitch</span></a></span><span> </span><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MEvent -&gt; NumChannels
</span><a href="Euterpea.IO.MIDI.MEvent.html#eVol"><span class="hs-identifier hs-var hs-var">eVol</span></a></span><span> </span><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Time
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Time) -&gt; Rational -&gt; Time
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MEvent -&gt; Rational
</span><a href="Euterpea.IO.MIDI.MEvent.html#eDur"><span class="hs-identifier hs-var hs-var">eDur</span></a></span><span> </span><span class="annot"><span class="annottext">MEvent
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span class="hs-operator">&gt;</span><span>             </span><span id="local-6989586621679094758"><span class="annot"><span class="annottext">es' :: [(Time, MidiMessage)]
</span><a href="#local-6989586621679094758"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelMapFun -&gt; ChannelMap -&gt; [MEvent] -&gt; [(Time, MidiMessage)]
</span><a href="#local-6989586621679094801"><span class="hs-identifier hs-var">channelMap</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMapFun
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094767"><span class="hs-identifier hs-var">cMap'</span></a></span><span> </span><span class="annot"><span class="annottext">[MEvent]
</span><a href="#local-6989586621679094771"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-215"></span><span class="hs-operator">&gt;</span><span>             </span><span id="local-6989586621679094757"><span class="annot"><span class="annottext">iNum :: NumChannels
</span><a href="#local-6989586621679094757"><span class="hs-identifier hs-var hs-var">iNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">InstrumentName -&gt; InstrumentName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">InstrumentName -&gt; NumChannels
forall a. Enum a =&gt; a -&gt; NumChannels
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-216"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679094766"><span class="hs-identifier hs-var">newI</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Time, MidiMessage) -&gt; Time
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
</span><a href="#local-6989586621679094763"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Message -&gt; MidiMessage
</span><a href="Euterpea.IO.MIDI.MidiIO.html#Std"><span class="hs-identifier hs-var">Std</span></a></span><span> </span><span class="annot"><span class="annottext">(Message -&gt; MidiMessage) -&gt; Message -&gt; MidiMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Message
</span><span class="hs-identifier hs-var">ProgramChange</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094768"><span class="hs-identifier hs-var">chan</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094757"><span class="hs-identifier hs-var">iNum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
</span><a href="#local-6989586621679094763"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094758"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-217"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
</span><a href="#local-6989586621679094763"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">(Time, MidiMessage)
-&gt; [(Time, MidiMessage)] -&gt; [(Time, MidiMessage)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Time, MidiMessage)]
</span><a href="#local-6989586621679094758"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">linearCP</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">just</span><span> </span><span class="hs-identifier">fills</span><span> </span><span class="hs-identifier">up</span><span> </span><span class="hs-identifier">channels</span><span> </span><span class="hs-identifier">left</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">right</span><span> </span><span class="hs-identifier">until</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">hits</span><span>
</span><span id="line-220"></span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">maximum</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">throws</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">error</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Percussion</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">handled</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-221"></span><span class="hs-identifier">special</span><span> </span><span class="hs-keyword">case</span><span class="hs-operator">.</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="NumChannels"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#NumChannels"><span class="hs-identifier hs-var">NumChannels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- maximum number of channels (i.e. 0-15 is 16 channels)</span><span>
</span><span id="line-224"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="PercChan"><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PercChan"><span class="hs-identifier hs-var">PercChan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- percussion channel, using indexing from zero</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#linearCP"><span class="hs-identifier hs-type">linearCP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#NumChannels"><span class="hs-identifier hs-type">NumChannels</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PercChan"><span class="hs-identifier hs-type">PercChan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-type">ChannelMapFun</span></a></span><span>
</span><span id="line-227"></span><span class="hs-operator">&gt;</span><span> </span><span id="linearCP"><span class="annot"><span class="annottext">linearCP :: NumChannels -&gt; NumChannels -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#linearCP"><span class="hs-identifier hs-var hs-var">linearCP</span></a></span></span><span> </span><span id="local-6989586621679094752"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094752"><span class="hs-identifier hs-var">cLim</span></a></span></span><span> </span><span id="local-6989586621679094751"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pChan</span></a></span></span><span> </span><span id="local-6989586621679094750"><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679094749"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">cMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">InstrumentName -&gt; InstrumentName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pChan</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pChan</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; ChannelMap -&gt; ChannelMap
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">cMap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-228"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094748"><span class="annot"><span class="annottext">n :: NumChannels
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelMap -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(ChannelMap -&gt; NumChannels) -&gt; ChannelMap -&gt; NumChannels
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((InstrumentName, NumChannels) -&gt; Bool) -&gt; ChannelMap -&gt; ChannelMap
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName -&gt; InstrumentName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(InstrumentName -&gt; Bool)
-&gt; ((InstrumentName, NumChannels) -&gt; InstrumentName)
-&gt; (InstrumentName, NumChannels)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; InstrumentName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">cMap</span></a></span><span>
</span><span id="line-229"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679094746"><span class="annot"><span class="annottext">newChan :: NumChannels
</span><a href="#local-6989586621679094746"><span class="hs-identifier hs-var hs-var">newChan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pChan</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- step over the percussion channel</span><span>
</span><span id="line-230"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094746"><span class="hs-identifier hs-var">newChan</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094752"><span class="hs-identifier hs-var">cLim</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094746"><span class="hs-identifier hs-var">newChan</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094746"><span class="hs-identifier hs-var">newChan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; ChannelMap -&gt; ChannelMap
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">cMap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-231"></span><span class="hs-operator">&gt;</span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (NumChannels, ChannelMap)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot use more than &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">NumChannels -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094752"><span class="hs-identifier hs-var">cLim</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; instruments.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-identifier">For</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">dynamicCP</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">new</span><span> </span><span class="hs-identifier">assignements</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">added</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">left</span><span> </span><span class="hs-identifier">side</span><span>
</span><span id="line-234"></span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">channel</span><span> </span><span class="hs-identifier">map</span><span class="hs-operator">/</span><span class="hs-identifier">list</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">means</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">item</span><span> </span><span class="hs-identifier">farthest</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">right</span><span>
</span><span id="line-235"></span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">oldest</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">should</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">replaced</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">table</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">full</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Percussion</span><span>
</span><span id="line-236"></span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">handled</span><span> </span><span class="hs-identifier">separately</span><span class="hs-operator">.</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#dynamicCP"><span class="hs-identifier hs-type">dynamicCP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#NumChannels"><span class="hs-identifier hs-type">NumChannels</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#PercChan"><span class="hs-identifier hs-type">PercChan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-type">ChannelMapFun</span></a></span><span>
</span><span id="line-239"></span><span class="hs-operator">&gt;</span><span> </span><span id="dynamicCP"><span class="annot"><span class="annottext">dynamicCP :: NumChannels -&gt; NumChannels -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#dynamicCP"><span class="hs-identifier hs-var hs-var">dynamicCP</span></a></span></span><span> </span><span id="local-6989586621679094745"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094745"><span class="hs-identifier hs-var">cLim</span></a></span></span><span> </span><span id="local-6989586621679094744"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094744"><span class="hs-identifier hs-var">pChan</span></a></span></span><span> </span><span id="local-6989586621679094743"><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094743"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679094742"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">cMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094743"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">InstrumentName -&gt; InstrumentName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094744"><span class="hs-identifier hs-var">pChan</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094743"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094744"><span class="hs-identifier hs-var">pChan</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; ChannelMap -&gt; ChannelMap
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">cMap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-241"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094741"><span class="annot"><span class="annottext">cMapNoP :: ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var hs-var">cMapNoP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((InstrumentName, NumChannels) -&gt; Bool) -&gt; ChannelMap -&gt; ChannelMap
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName -&gt; InstrumentName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(InstrumentName -&gt; Bool)
-&gt; ((InstrumentName, NumChannels) -&gt; InstrumentName)
-&gt; (InstrumentName, NumChannels)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; InstrumentName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">cMap</span></a></span><span>
</span><span id="line-242"></span><span class="hs-operator">&gt;</span><span>             </span><span id="local-6989586621679094740"><span class="annot"><span class="annottext">extra :: ChannelMap
</span><a href="#local-6989586621679094740"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ChannelMap -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">cMapNoP</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">cMap</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName
</span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094744"><span class="hs-identifier hs-var">pChan</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span class="hs-operator">&gt;</span><span>             </span><span id="local-6989586621679094739"><span class="annot"><span class="annottext">newChan :: NumChannels
</span><a href="#local-6989586621679094739"><span class="hs-identifier hs-var hs-var">newChan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; NumChannels
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((InstrumentName, NumChannels) -&gt; NumChannels)
-&gt; (InstrumentName, NumChannels) -&gt; NumChannels
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap -&gt; (InstrumentName, NumChannels)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">cMapNoP</span></a></span><span>
</span><span id="line-244"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ChannelMap -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">cMapNoP</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094745"><span class="hs-identifier hs-var">cLim</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#linearCP"><span class="hs-identifier hs-var">linearCP</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094745"><span class="hs-identifier hs-var">cLim</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094744"><span class="hs-identifier hs-var">pChan</span></a></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094743"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">cMap</span></a></span><span>
</span><span id="line-245"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094739"><span class="hs-identifier hs-var">newChan</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094743"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094739"><span class="hs-identifier hs-var">newChan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrumentName, NumChannels) -&gt; ChannelMap -&gt; ChannelMap
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels -&gt; ChannelMap -&gt; ChannelMap
forall a. NumChannels -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChannelMap -&gt; NumChannels
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; NumChannels
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">cMapNoP</span></a></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; NumChannels -&gt; NumChannels
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">cMapNoP</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">ChannelMap -&gt; ChannelMap -&gt; ChannelMap
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094740"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-identifier">A</span><span> </span><span class="hs-identifier">predefined</span><span> </span><span class="hs-identifier">policy</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">send</span><span> </span><span class="hs-identifier">instruments</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">user</span><span class="hs-glyph">-</span><span class="hs-identifier">defined</span><span> </span><span class="hs-identifier">channels</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">If</span><span> </span><span class="hs-identifier">new</span><span>
</span><span id="line-249"></span><span class="hs-identifier">instruments</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">found</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">accounted</span><span> </span><span class="hs-identifier">for</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">thrown</span><span class="hs-operator">.</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#predefinedCP"><span class="hs-identifier hs-type">predefinedCP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMap"><span class="hs-identifier hs-type">ChannelMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.Play.html#ChannelMapFun"><span class="hs-identifier hs-type">ChannelMapFun</span></a></span><span>
</span><span id="line-252"></span><span class="hs-operator">&gt;</span><span> </span><span id="predefinedCP"><span class="annot"><span class="annottext">predefinedCP :: ChannelMap -&gt; ChannelMapFun
</span><a href="Euterpea.IO.MIDI.Play.html#predefinedCP"><span class="hs-identifier hs-var hs-var">predefinedCP</span></a></span></span><span> </span><span id="local-6989586621679094736"><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094736"><span class="hs-identifier hs-var">cMapFixed</span></a></span></span><span> </span><span id="local-6989586621679094735"><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094735"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InstrumentName -&gt; ChannelMap -&gt; Maybe NumChannels
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094735"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094736"><span class="hs-identifier hs-var">cMapFixed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">Maybe NumChannels
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (NumChannels, ChannelMap)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrumentName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094735"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is not included in the channel map.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094734"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094734"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094734"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChannelMap
</span><a href="#local-6989586621679094736"><span class="hs-identifier hs-var">cMapFixed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-------------------------------</span><span>
</span><span id="line-257"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-identifier">instances</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">Midi</span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-258"></span><span class="hs-comment">-------------------------------</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FileType</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094731"><span class="annot"><span class="annottext">rnf :: FileType -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span id="local-6989586621679094729"><span class="annot"><span class="annottext">FileType
</span><a href="#local-6989586621679094729"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimeDiv</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094727"><span class="annot"><span class="annottext">rnf :: TimeDiv -&gt; ()
</span><a href="#local-6989586621679094727"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TicksPerBeat</span></span><span> </span><span id="local-6989586621679094725"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094725"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094725"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-265"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TicksPerSecond</span></span><span> </span><span id="local-6989586621679094723"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094723"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679094722"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094722"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094722"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094723"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Midi</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094720"><span class="annot"><span class="annottext">rnf :: Midi -&gt; ()
</span><a href="#local-6989586621679094720"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Midi</span></span><span> </span><span id="local-6989586621679094718"><span class="annot"><span class="annottext">FileType
</span><a href="#local-6989586621679094718"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span id="local-6989586621679094717"><span class="annot"><span class="annottext">TimeDiv
</span><a href="#local-6989586621679094717"><span class="hs-identifier hs-var">td</span></a></span></span><span> </span><span id="local-6989586621679094716"><span class="annot"><span class="annottext">[Track NumChannels]
</span><a href="#local-6989586621679094716"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="#local-6989586621679094718"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">TimeDiv -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">TimeDiv
</span><a href="#local-6989586621679094717"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Track NumChannels] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[Track NumChannels]
</span><a href="#local-6989586621679094716"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094714"><span class="annot"><span class="annottext">rnf :: Message -&gt; ()
</span><a href="#local-6989586621679094714"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoteOff</span></span><span> </span><span id="local-6989586621679094713"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094713"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094712"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094712"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679094711"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094711"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094713"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094712"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094711"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-272"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoteOn</span></span><span> </span><span id="local-6989586621679094710"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094710"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094709"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094709"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679094708"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094708"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094710"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094709"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094708"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-273"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyPressure</span></span><span> </span><span id="local-6989586621679094706"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094706"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094705"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094705"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679094704"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094704"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094706"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094705"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094704"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-274"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProgramChange</span></span><span> </span><span id="local-6989586621679094703"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094703"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094702"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094702"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094703"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094702"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-275"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ChannelPressure</span></span><span> </span><span id="local-6989586621679094700"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094700"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094699"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094699"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094700"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094699"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-276"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PitchWheel</span></span><span> </span><span id="local-6989586621679094697"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094697"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094696"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094696"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094697"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094696"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-277"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TempoChange</span></span><span> </span><span id="local-6989586621679094694"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094694"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094694"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-278"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span id="local-6989586621679094693"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679094693"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- no other message types are currently used by Euterpea</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#MidiMessage"><span class="hs-identifier hs-type">MidiMessage</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094691"><span class="annot"><span class="annottext">rnf :: MidiMessage -&gt; ()
</span><a href="#local-6989586621679094691"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#Std"><span class="hs-identifier hs-type">Std</span></a></span><span> </span><span id="local-6989586621679094690"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679094690"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679094690"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-282"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.IO.MIDI.MidiIO.html#ANote"><span class="hs-identifier hs-type">ANote</span></a></span><span> </span><span id="local-6989586621679094689"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094689"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094688"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094688"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679094687"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094687"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679094686"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094686"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094689"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094688"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094687"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679094686"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-286"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-identifier">instances</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-287"></span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094685"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094683"><span class="annot"><span class="annottext">rnf :: Music a -&gt; ()
</span><a href="#local-6989586621679094683"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094682"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094682"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621679094680"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094680"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Music a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094682"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094680"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-291"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094679"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-type">:=:</span></a></span><span> </span><span id="local-6989586621679094677"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094677"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Music a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094677"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-292"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679094675"><span class="annot"><span class="annottext">Primitive a
</span><a href="#local-6989586621679094675"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Primitive a
</span><a href="#local-6989586621679094675"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-293"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-type">Modify</span></a></span><span> </span><span id="local-6989586621679094673"><span class="annot"><span class="annottext">Control
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679094672"><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094672"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Control -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Control
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Music a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Music a
</span><a href="#local-6989586621679094672"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-operator">&gt;</span><span> </span><span id="local-6989586621679094671"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679094671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094669"><span class="annot"><span class="annottext">rnf :: Primitive a -&gt; ()
</span><a href="#local-6989586621679094669"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-type">Note</span></a></span><span> </span><span id="local-6989586621679094667"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094667"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679094666"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094666"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094667"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679094666"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-297"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-type">Rest</span></a></span><span> </span><span id="local-6989586621679094664"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Control"><span class="hs-identifier hs-type">Control</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094662"><span class="annot"><span class="annottext">rnf :: Control -&gt; ()
</span><a href="#local-6989586621679094662"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-type">Tempo</span></a></span><span> </span><span id="local-6989586621679094660"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094660"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094660"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-301"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span id="local-6989586621679094658"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094658"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094658"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-302"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Instrument"><span class="hs-identifier hs-type">Instrument</span></a></span><span> </span><span id="local-6989586621679094656"><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094656"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrumentName -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094656"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-303"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span id="local-6989586621679094654"><span class="annot"><span class="annottext">[PhraseAttribute]
</span><a href="#local-6989586621679094654"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PhraseAttribute] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[PhraseAttribute]
</span><a href="#local-6989586621679094654"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-304"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Custom"><span class="hs-identifier hs-type">Custom</span></a></span><span> </span><span id="local-6989586621679094652"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-305"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#KeySig"><span class="hs-identifier hs-type">KeySig</span></a></span><span> </span><span id="local-6989586621679094650"><span class="annot"><span class="annottext">PitchClass
</span><a href="#local-6989586621679094650"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679094649"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PitchClass -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">PitchClass
</span><a href="#local-6989586621679094650"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier hs-type">PitchClass</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094647"><span class="annot"><span class="annottext">rnf :: PitchClass -&gt; ()
</span><a href="#local-6989586621679094647"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679094646"><span class="annot"><span class="annottext">PitchClass
</span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094644"><span class="annot"><span class="annottext">rnf :: Mode -&gt; ()
</span><a href="#local-6989586621679094644"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679094643"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679094643"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#PhraseAttribute"><span class="hs-identifier hs-type">PhraseAttribute</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094641"><span class="annot"><span class="annottext">rnf :: PhraseAttribute -&gt; ()
</span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Dyn"><span class="hs-identifier hs-type">Dyn</span></a></span><span> </span><span id="local-6989586621679094639"><span class="annot"><span class="annottext">Dynamic
</span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dynamic -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Dynamic
</span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-315"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Tmp"><span class="hs-identifier hs-type">Tmp</span></a></span><span> </span><span id="local-6989586621679094637"><span class="annot"><span class="annottext">Tempo
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tempo -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Tempo
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-316"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Art"><span class="hs-identifier hs-type">Art</span></a></span><span> </span><span id="local-6989586621679094635"><span class="annot"><span class="annottext">Articulation
</span><a href="#local-6989586621679094635"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Articulation -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Articulation
</span><a href="#local-6989586621679094635"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-317"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Orn"><span class="hs-identifier hs-type">Orn</span></a></span><span> </span><span id="local-6989586621679094633"><span class="annot"><span class="annottext">Ornament
</span><a href="#local-6989586621679094633"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ornament -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Ornament
</span><a href="#local-6989586621679094633"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094631"><span class="annot"><span class="annottext">rnf :: Dynamic -&gt; ()
</span><a href="#local-6989586621679094631"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Accent"><span class="hs-identifier hs-type">Accent</span></a></span><span> </span><span id="local-6989586621679094629"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094629"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094629"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-321"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Crescendo"><span class="hs-identifier hs-type">Crescendo</span></a></span><span> </span><span id="local-6989586621679094627"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094627"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094627"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-322"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Diminuendo"><span class="hs-identifier hs-type">Diminuendo</span></a></span><span> </span><span id="local-6989586621679094625"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094625"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094625"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-323"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#StdLoudness"><span class="hs-identifier hs-type">StdLoudness</span></a></span><span> </span><span id="local-6989586621679094623"><span class="annot"><span class="annottext">StdLoudness
</span><a href="#local-6989586621679094623"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdLoudness -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">StdLoudness
</span><a href="#local-6989586621679094623"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-324"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Loudness"><span class="hs-identifier hs-type">Loudness</span></a></span><span> </span><span id="local-6989586621679094621"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#StdLoudness"><span class="hs-identifier hs-type">StdLoudness</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094619"><span class="annot"><span class="annottext">rnf :: StdLoudness -&gt; ()
</span><a href="#local-6989586621679094619"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679094618"><span class="annot"><span class="annottext">StdLoudness
</span><a href="#local-6989586621679094618"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Articulation"><span class="hs-identifier hs-type">Articulation</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094616"><span class="annot"><span class="annottext">rnf :: Articulation -&gt; ()
</span><a href="#local-6989586621679094616"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Staccato"><span class="hs-identifier hs-type">Staccato</span></a></span><span> </span><span id="local-6989586621679094614"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094614"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094614"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-331"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Legato"><span class="hs-identifier hs-type">Legato</span></a></span><span> </span><span id="local-6989586621679094612"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094612"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094612"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-332"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span id="local-6989586621679094611"><span class="annot"><span class="annottext">Articulation
</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Ornament"><span class="hs-identifier hs-type">Ornament</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094609"><span class="annot"><span class="annottext">rnf :: Ornament -&gt; ()
</span><a href="#local-6989586621679094609"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679094608"><span class="annot"><span class="annottext">Ornament
</span><a href="#local-6989586621679094608"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-type">Tempo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094606"><span class="annot"><span class="annottext">rnf :: Tempo -&gt; ()
</span><a href="#local-6989586621679094606"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Ritardando"><span class="hs-identifier hs-type">Ritardando</span></a></span><span> </span><span id="local-6989586621679094604"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094604"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094604"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-339"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Accelerando"><span class="hs-identifier hs-type">Accelerando</span></a></span><span> </span><span id="local-6989586621679094602"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094602"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679094602"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094600"><span class="annot"><span class="annottext">rnf :: InstrumentName -&gt; ()
</span><a href="#local-6989586621679094600"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679094599"><span class="annot"><span class="annottext">InstrumentName
</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Euterpea.Music.html#NoteAttribute"><span class="hs-identifier hs-type">NoteAttribute</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679094597"><span class="annot"><span class="annottext">rnf :: NoteAttribute -&gt; ()
</span><a href="#local-6989586621679094597"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Volume"><span class="hs-identifier hs-type">Volume</span></a></span><span> </span><span id="local-6989586621679094595"><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094595"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumChannels -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NumChannels
</span><a href="#local-6989586621679094595"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-346"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Fingering"><span class="hs-identifier hs-type">Fingering</span></a></span><span> </span><span id="local-6989586621679094593"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094593"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094593"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-347"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Dynamics"><span class="hs-identifier hs-type">Dynamics</span></a></span><span> </span><span id="local-6989586621679094591"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094591"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679094591"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-348"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Euterpea.Music.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span id="local-6989586621679094589"><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094589"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Time] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[Time]
</span><a href="#local-6989586621679094589"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-349"></span></pre></body></html>