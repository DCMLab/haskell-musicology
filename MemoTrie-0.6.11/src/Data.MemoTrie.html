<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs, TypeFamilies, TypeOperators, ScopedTypeVariables, CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span> </span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -fenable-rewrite-rules #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- ScopedTypeVariables works around a 6.10 bug.  The forall keyword is</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- supposed to be recognized in a RULES pragma.</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Module      :  Data.MemoTrie</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Copyright   :  (c) Conal Elliott 2008-2016</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- </span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Maintainer  :  conal@conal.net</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- </span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Trie-based memoizer</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- </span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Adapted from sjanssen's paste: &lt;http://hpaste.org/3839 \&quot;a lazy trie\&quot;&gt;,</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- which I think is based on Ralf Hinze's paper &quot;Memo Functions,</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Polytypically!&quot;.</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- </span><span>
</span><span id="line-24"></span><span class="hs-comment">-- You can automatically derive generic instances. for example: </span><span>
</span><span id="line-25"></span><span class="hs-comment">-- </span><span>
</span><span id="line-26"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- {-# LANGUAGE &lt;https://ocharles.org.uk/blog/posts/2014-12-16-derive-generic.html DeriveGeneric&gt;, TypeOperators, TypeFamilies #-}</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- import Data.MemoTrie</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- import GHC.Generics (Generic) </span><span>
</span><span id="line-30"></span><span class="hs-comment">-- </span><span>
</span><span id="line-31"></span><span class="hs-comment">-- data Color = RGB Int Int Int</span><span>
</span><span id="line-32"></span><span class="hs-comment">--            | NamedColor String </span><span>
</span><span id="line-33"></span><span class="hs-comment">--  deriving ('Generic') </span><span>
</span><span id="line-34"></span><span class="hs-comment">-- </span><span>
</span><span id="line-35"></span><span class="hs-comment">-- instance HasTrie Color where</span><span>
</span><span id="line-36"></span><span class="hs-comment">--   newtype (Color :-&gt;: b) = ColorTrie { unColorTrie :: 'Reg' Color :-&gt;: b } </span><span>
</span><span id="line-37"></span><span class="hs-comment">--   trie = 'trieGeneric' ColorTrie </span><span>
</span><span id="line-38"></span><span class="hs-comment">--   untrie = 'untrieGeneric' unColorTrie</span><span>
</span><span id="line-39"></span><span class="hs-comment">--   enumerate = 'enumerateGeneric' unColorTrie</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- </span><span>
</span><span id="line-42"></span><span class="hs-comment">-- see @examples/Generic.hs@, which can be run with: </span><span>
</span><span id="line-43"></span><span class="hs-comment">-- </span><span>
</span><span id="line-44"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- cabal configure -fexamples &amp;&amp; cabal run generic</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- @ </span><span>
</span><span id="line-47"></span><span class="hs-comment">-- </span><span>
</span><span id="line-48"></span><span class="hs-comment">-- </span><span>
</span><span id="line-49"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.MemoTrie</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier">HasTrie</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator">(:-&gt;:)</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#domain"><span class="hs-identifier">domain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#idTrie"><span class="hs-identifier">idTrie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%40.%40"><span class="hs-operator">(@.@)</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- , trie2, trie3, untrie2, untrie3</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#memo"><span class="hs-identifier">memo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#memo2"><span class="hs-identifier">memo2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#memo3"><span class="hs-identifier">memo3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#mup"><span class="hs-identifier">mup</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#inTrie"><span class="hs-identifier">inTrie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier">inTrie2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#inTrie3"><span class="hs-identifier">inTrie3</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">-- , untrieBits</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#trieGeneric"><span class="hs-identifier">trieGeneric</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#untrieGeneric"><span class="hs-identifier">untrieGeneric</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#enumerateGeneric"><span class="hs-identifier">enumerateGeneric</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier">Reg</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#memoFix"><span class="hs-identifier">memoFix</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Export the parts of HasTrie separately in order to get the associated data</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- type constructors, so I can define instances of other classes on them.</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fix</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Newtype.Generics</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Void</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-81"></span><span> </span><span>
</span><span id="line-82"></span><span class="hs-comment">-- import Prelude hiding (id,(.))</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- import Control.Category</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- import Control.Arrow</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><span class="hs-comment">-- | Mapping from all elements of @a@ to the results of some function</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">class</span><span> </span><span id="HasTrie"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-var">HasTrie</span></a></span></span><span> </span><span id="local-6989586621679039435"><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- | Representation of trie with domain type @a@</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">(:-&gt;:)</span></a></span></span><span> </span><span id="local-6989586621679039435"><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- | Create the trie for the entire domain of a function</span><span>
</span><span id="line-93"></span><span>    </span><span id="trie"><span class="annot"><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-type">trie</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039437"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039437"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039437"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">-- | Convert a trie to a function, i.e., access a field of the trie</span><span>
</span><span id="line-95"></span><span>    </span><span id="untrie"><span class="annot"><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-type">untrie</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039472"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039472"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039472"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- | List the trie elements.  Order of keys (@:: a@) is always the same.</span><span>
</span><span id="line-97"></span><span>    </span><span id="enumerate"><span class="annot"><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-type">enumerate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039436"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039436"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039436"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><span class="hs-comment">-- | Domain elements of a trie</span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679039427"><span class="annot"><a href="Data.MemoTrie.html#domain"><span class="hs-identifier hs-type">domain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-101"></span><span id="domain"><span class="annot"><span class="annottext">domain :: forall a. HasTrie a =&gt; [a]
</span><a href="Data.MemoTrie.html#domain"><span class="hs-identifier hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Any) -&gt; a) -&gt; [(a, Any)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, Any) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: Any) -&gt; [(a, Any)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Any) -&gt; a :-&gt;: Any
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; a -&gt; Any
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Any
forall {a}. a
</span><a href="#local-6989586621679039982"><span class="hs-identifier hs-var">oops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>   </span><span id="local-6989586621679039982"><span class="annot"><span class="annottext">oops :: a
</span><a href="#local-6989586621679039982"><span class="hs-identifier hs-var hs-var">oops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Data.MemoTrie.domain: range element evaluated.&quot;</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Hm: domain :: [Bool] doesn't produce any output.</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039447"><span id="local-6989586621679039448"><span id="local-6989586621679039990"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679039448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679039997"><span class="annot"><span class="annottext">== :: (a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; Bool)
-&gt; ((a :-&gt;: b) -&gt; [b]) -&gt; (a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; [(a, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; [b]) -&gt; ((a :-&gt;: b) -&gt; [(a, b)]) -&gt; (a :-&gt;: b) -&gt; [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; [(a, b)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039462"><span id="local-6989586621679039463"><span id="local-6989586621679040004"><span id="local-6989586621679040009"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039462"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679039462"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679039463"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039463"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679040017"><span class="annot"><span class="annottext">show :: (a :-&gt;: b) -&gt; [Char]
</span><a href="#local-6989586621679040017"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679040019"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040019"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Trie: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; [(a, b)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040019"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">{-
trie2 :: (HasTrie a, HasTrie b) =&gt;
         (a -&gt; b -&gt; c) -&gt; (a :-&gt;: b :-&gt;: c)
-- trie2 h = trie $ \ a -&gt; trie $ \ b -&gt; h a b
-- trie2 h = trie $ \ a -&gt; trie (h a)
trie2 h = trie (trie . h)
-- trie2 h = trie (fmap trie h)
-- trie2 = (fmap.fmap) trie trie


trie3 :: (HasTrie a, HasTrie b, HasTrie c) =&gt;
         (a -&gt; b -&gt; c -&gt; d) -&gt; (a :-&gt;: b :-&gt;: c :-&gt;: d)
trie3 h = trie (trie2 . h)

untrie2 :: (HasTrie a, HasTrie b) =&gt;
          (a :-&gt;: b :-&gt;: c)-&gt; (a -&gt; b -&gt; c)
untrie2 tt = untrie . untrie tt


untrie3 :: (HasTrie a, HasTrie b, HasTrie c) =&gt;
          (a :-&gt;: b :-&gt;: c :-&gt;: d)-&gt; (a -&gt; b -&gt; c -&gt; d)
untrie3 tt = untrie2 . untrie tt
-}</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- {-# RULES &quot;trie/untrie&quot;   forall t. trie (untrie t) = t #-}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">--     warning: [-Winline-rule-shadowing] &#8230;</span><span>
</span><span id="line-141"></span><span class="hs-comment">--     Rule &quot;trie/untrie&quot; may never fire</span><span>
</span><span id="line-142"></span><span class="hs-comment">--       because rule &quot;Class op untrie&quot; for &#8216;untrie&#8217; might fire first</span><span>
</span><span id="line-143"></span><span class="hs-comment">--     Probable fix: add phase [n] or [~n] to the competing rule</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Don't include the dual rule:</span><span>
</span><span id="line-147"></span><span class="hs-comment">--   &quot;untrie/trie&quot;   forall f. untrie (trie f) = f</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- which would defeat memoization.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- TODO: experiment with rule application.  Maybe re-enable &quot;untrie/trie&quot;</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- but fiddle with phases, so it won't defeat 'memo'.</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">-- | Trie-based function memoizer</span></span><span>
</span><span id="line-154"></span><span id="local-6989586621679039468"><span id="local-6989586621679039469"><span class="annot"><a href="Data.MemoTrie.html#memo"><span class="hs-identifier hs-type">memo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-155"></span><span id="memo"><span class="annot"><span class="annottext">memo :: forall t a. HasTrie t =&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo"><span class="hs-identifier hs-var hs-var">memo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(t :-&gt;: a) -&gt; t -&gt; a
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (t :-&gt;: b) -&gt; t -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((t :-&gt;: a) -&gt; t -&gt; a)
-&gt; ((t -&gt; a) -&gt; t :-&gt;: a) -&gt; (t -&gt; a) -&gt; t -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; a) -&gt; t :-&gt;: a
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (t -&gt; b) -&gt; t :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Memoize a binary function, on its first argument and then on its</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- second.  Take care to exploit any partial evaluation.</span><span>
</span><span id="line-159"></span><span id="local-6989586621679039479"><span id="local-6989586621679039480"><span id="local-6989586621679039481"><span class="annot"><a href="Data.MemoTrie.html#memo2"><span class="hs-identifier hs-type">memo2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039479"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039480"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039479"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039480"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039479"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039480"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Memoize a ternary function on successive arguments.  Take care to</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- exploit any partial evaluation.</span><span>
</span><span id="line-163"></span><span id="local-6989586621679039485"><span id="local-6989586621679039486"><span id="local-6989586621679039487"><span id="local-6989586621679039488"><span class="annot"><a href="Data.MemoTrie.html#memo3"><span class="hs-identifier hs-type">memo3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039487"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039487"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039487"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">-- | Lift a memoizer to work with one more argument.</span></span><span>
</span><span id="line-166"></span><span id="local-6989586621679039473"><span id="local-6989586621679039474"><span id="local-6989586621679039475"><span class="annot"><a href="Data.MemoTrie.html#mup"><span class="hs-identifier hs-type">mup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039474"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039475"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039475"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-167"></span><span id="mup"><span class="annot"><span class="annottext">mup :: forall t b c. HasTrie t =&gt; (b -&gt; c) -&gt; (t -&gt; b) -&gt; t -&gt; c
</span><a href="Data.MemoTrie.html#mup"><span class="hs-identifier hs-var hs-var">mup</span></a></span></span><span> </span><span id="local-6989586621679040025"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679040025"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679040026"><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679040026"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(t -&gt; c) -&gt; t -&gt; c
forall t a. HasTrie t =&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679040025"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; (t -&gt; b) -&gt; t -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679040026"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span id="memo2"><span class="annot"><span class="annottext">memo2 :: forall s t a.
(HasTrie s, HasTrie t) =&gt;
(s -&gt; t -&gt; a) -&gt; s -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo2"><span class="hs-identifier hs-var hs-var">memo2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((t -&gt; a) -&gt; t -&gt; a) -&gt; (s -&gt; t -&gt; a) -&gt; s -&gt; t -&gt; a
forall t b c. HasTrie t =&gt; (b -&gt; c) -&gt; (t -&gt; b) -&gt; t -&gt; c
</span><a href="Data.MemoTrie.html#mup"><span class="hs-identifier hs-var">mup</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; a) -&gt; t -&gt; a
forall t a. HasTrie t =&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span>
</span><span id="line-170"></span><span id="memo3"><span class="annot"><span class="annottext">memo3 :: forall r s t a.
(HasTrie r, HasTrie s, HasTrie t) =&gt;
(r -&gt; s -&gt; t -&gt; a) -&gt; r -&gt; s -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo3"><span class="hs-identifier hs-var hs-var">memo3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((s -&gt; t -&gt; a) -&gt; s -&gt; t -&gt; a)
-&gt; (r -&gt; s -&gt; t -&gt; a) -&gt; r -&gt; s -&gt; t -&gt; a
forall t b c. HasTrie t =&gt; (b -&gt; c) -&gt; (t -&gt; b) -&gt; t -&gt; c
</span><a href="Data.MemoTrie.html#mup"><span class="hs-identifier hs-var">mup</span></a></span><span> </span><span class="annot"><span class="annottext">(s -&gt; t -&gt; a) -&gt; s -&gt; t -&gt; a
forall s t a.
(HasTrie s, HasTrie t) =&gt;
(s -&gt; t -&gt; a) -&gt; s -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo2"><span class="hs-identifier hs-var">memo2</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Memoizing recursion. Use like `fix`.</span></span><span>
</span><span id="line-173"></span><span id="local-6989586621679039493"><span id="local-6989586621679039494"><span class="annot"><a href="Data.MemoTrie.html#memoFix"><span class="hs-identifier hs-type">memoFix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039494"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039494"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039494"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-174"></span><span id="memoFix"><span class="annot"><span class="annottext">memoFix :: forall a b. HasTrie a =&gt; ((a -&gt; b) -&gt; a -&gt; b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#memoFix"><span class="hs-identifier hs-var hs-var">memoFix</span></a></span></span><span> </span><span id="local-6989586621679040039"><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
</span><a href="#local-6989586621679040039"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; a -&gt; b) -&gt; a -&gt; b
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall t a. HasTrie t =&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="Data.MemoTrie.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; a -&gt; b) -&gt; ((a -&gt; b) -&gt; a -&gt; b) -&gt; (a -&gt; b) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
</span><a href="#local-6989586621679040039"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if 0
</span><span class="hs-comment">-- Equivalently,</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-identifier">memoFix</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">memo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-identifier">memoFix</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f'</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">memo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-identifier">memoFix</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f'</span><span>
</span><span id="line-185"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>   </span><span class="hs-identifier">f'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">memo</span><span> </span><span class="hs-identifier">f</span><span>
</span><span id="line-187"></span><span>   </span><span class="hs-identifier">f</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">f'</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if 0
</span><span class="hs-comment">-- Example</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-identifier">fibF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span class="hs-identifier">fibF</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-195"></span><span class="hs-identifier">fibF</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-196"></span><span class="hs-identifier">fibF</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-identifier">fib</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span>
</span><span id="line-199"></span><span class="hs-identifier">fib</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-identifier">fibF</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-identifier">fib'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span>
</span><span id="line-202"></span><span class="hs-identifier">fib'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">memoFix</span><span> </span><span class="hs-identifier">fibF</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- Try fib 30 vs fib' 30</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><span class="hs-comment">-- | Apply a unary function inside of a trie</span></span><span>
</span><span id="line-209"></span><span id="local-6989586621679039498"><span id="local-6989586621679039499"><span id="local-6989586621679039500"><span id="local-6989586621679039501"><span class="annot"><a href="Data.MemoTrie.html#inTrie"><span class="hs-identifier hs-type">inTrie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039499"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039498"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039500"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039499"><span class="hs-identifier hs-type">c</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039501"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039500"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039499"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039501"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-212"></span><span id="inTrie"><span class="annot"><span class="annottext">inTrie :: forall a c b d.
(HasTrie a, HasTrie c) =&gt;
((a -&gt; b) -&gt; c -&gt; d) -&gt; (a :-&gt;: b) -&gt; c :-&gt;: d
</span><a href="Data.MemoTrie.html#inTrie"><span class="hs-identifier hs-var hs-var">inTrie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((a :-&gt;: b) -&gt; a -&gt; b)
-&gt; ((c -&gt; d) -&gt; c :-&gt;: d)
-&gt; ((a -&gt; b) -&gt; c -&gt; d)
-&gt; (a :-&gt;: b)
-&gt; c :-&gt;: d
forall a' a b b'. (a' -&gt; a) -&gt; (b -&gt; b') -&gt; (a -&gt; b) -&gt; a' -&gt; b'
</span><a href="Data.MemoTrie.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; d) -&gt; c :-&gt;: d
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (c -&gt; b) -&gt; c :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">-- | Apply a binary function inside of a trie</span></span><span>
</span><span id="line-215"></span><span id="local-6989586621679039510"><span id="local-6989586621679039511"><span id="local-6989586621679039512"><span id="local-6989586621679039513"><span id="local-6989586621679039514"><span id="local-6989586621679039515"><span class="annot"><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-type">inTrie2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039510"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039511"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039512"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-216"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039510"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039513"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039511"><span class="hs-identifier hs-type">c</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039514"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039512"><span class="hs-identifier hs-type">e</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039515"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039513"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039511"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039514"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039512"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039515"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-218"></span><span id="inTrie2"><span class="annot"><span class="annottext">inTrie2 :: forall a c e b d f.
(HasTrie a, HasTrie c, HasTrie e) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
</span><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-var hs-var">inTrie2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((a :-&gt;: b) -&gt; a -&gt; b)
-&gt; (((c -&gt; d) -&gt; e -&gt; f) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f)
-&gt; ((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b)
-&gt; (c :-&gt;: d)
-&gt; e :-&gt;: f
forall a' a b b'. (a' -&gt; a) -&gt; (b -&gt; b') -&gt; (a -&gt; b) -&gt; a' -&gt; b'
</span><a href="Data.MemoTrie.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((c -&gt; d) -&gt; e -&gt; f) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
forall a c b d.
(HasTrie a, HasTrie c) =&gt;
((a -&gt; b) -&gt; c -&gt; d) -&gt; (a :-&gt;: b) -&gt; c :-&gt;: d
</span><a href="Data.MemoTrie.html#inTrie"><span class="hs-identifier hs-var">inTrie</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">-- | Apply a ternary function inside of a trie</span></span><span>
</span><span id="line-221"></span><span id="local-6989586621679039522"><span id="local-6989586621679039523"><span id="local-6989586621679039524"><span id="local-6989586621679039525"><span id="local-6989586621679039526"><span id="local-6989586621679039527"><span id="local-6989586621679039528"><span id="local-6989586621679039529"><span class="annot"><a href="Data.MemoTrie.html#inTrie3"><span class="hs-identifier hs-type">inTrie3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039523"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039524"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039525"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-222"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039526"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039523"><span class="hs-identifier hs-type">c</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039527"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039524"><span class="hs-identifier hs-type">e</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039528"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039525"><span class="hs-identifier hs-type">g</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679039529"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039526"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039523"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039527"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039524"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039528"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039525"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039529"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-224"></span><span id="inTrie3"><span class="annot"><span class="annottext">inTrie3 :: forall a c e g b d f h.
(HasTrie a, HasTrie c, HasTrie e, HasTrie g) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; (e -&gt; f) -&gt; g -&gt; h)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; (e :-&gt;: f) -&gt; g :-&gt;: h
</span><a href="Data.MemoTrie.html#inTrie3"><span class="hs-identifier hs-var hs-var">inTrie3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((a :-&gt;: b) -&gt; a -&gt; b)
-&gt; (((c -&gt; d) -&gt; (e -&gt; f) -&gt; g -&gt; h)
    -&gt; (c :-&gt;: d) -&gt; (e :-&gt;: f) -&gt; g :-&gt;: h)
-&gt; ((a -&gt; b) -&gt; (c -&gt; d) -&gt; (e -&gt; f) -&gt; g -&gt; h)
-&gt; (a :-&gt;: b)
-&gt; (c :-&gt;: d)
-&gt; (e :-&gt;: f)
-&gt; g :-&gt;: h
forall a' a b b'. (a' -&gt; a) -&gt; (b -&gt; b') -&gt; (a -&gt; b) -&gt; a' -&gt; b'
</span><a href="Data.MemoTrie.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((c -&gt; d) -&gt; (e -&gt; f) -&gt; g -&gt; h)
-&gt; (c :-&gt;: d) -&gt; (e :-&gt;: f) -&gt; g :-&gt;: h
forall a c e b d f.
(HasTrie a, HasTrie c, HasTrie e) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
</span><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-var">inTrie2</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">---- Instances</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- As suggested by Audun Skaugen</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="local-6989586621679039539"><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039539"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VoidTrie"><span class="annot"><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679040065"><span class="annot"><span class="annottext">trie :: forall b. (Void -&gt; b) -&gt; Void :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span class="annot"><span class="annottext">Void -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Void :-&gt;: b
forall a. Void :-&gt;: a
</span><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679040068"><span class="annot"><span class="annottext">untrie :: forall b. (Void :-&gt;: b) -&gt; Void -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="annot"><span class="annottext">Void :-&gt;: b
R::-&gt;:Voida b
</span><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">Void
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; b
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;untrie VoidTrie&quot;</span></span><span>
</span><span id="line-234"></span><span>                    </span><span class="hs-comment">-- \case  -- needs EmptyCase</span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679040069"><span class="annot"><span class="annottext">enumerate :: forall b. (Void :-&gt;: b) -&gt; [(Void, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="annot"><span class="annottext">Void :-&gt;: b
R::-&gt;:Voida b
</span><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039548"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679040074"><span class="annot"><span class="annottext">pack :: O (Void :-&gt;: a) -&gt; Void :-&gt;: a
</span><a href="#local-6989586621679040074"><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Void :-&gt;: a
forall a. Void :-&gt;: a
</span><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679040076"><span class="annot"><span class="annottext">unpack :: (Void :-&gt;: a) -&gt; O (Void :-&gt;: a)
</span><a href="#local-6989586621679040076"><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></a></span></span><span> </span><span class="annot"><span class="annottext">Void :-&gt;: a
R::-&gt;:Voida a
</span><a href="Data.MemoTrie.html#VoidTrie"><span class="hs-identifier hs-var">VoidTrie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039550"><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039550"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnitTrie"><span class="annot"><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-var">UnitTrie</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039550"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679040083"><span class="annot"><span class="annottext">trie :: forall b. (() -&gt; b) -&gt; () :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040084"><span class="annot"><span class="annottext">() -&gt; b
</span><a href="#local-6989586621679040084"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; () :-&gt;: b
forall a. a -&gt; () :-&gt;: a
</span><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-var">UnitTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; b
</span><a href="#local-6989586621679040084"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679040085"><span class="annot"><span class="annottext">untrie :: forall b. (() :-&gt;: b) -&gt; () -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-type">UnitTrie</span></a></span><span> </span><span id="local-6989586621679040086"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040086"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040086"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679040087"><span class="annot"><span class="annottext">enumerate :: forall b. (() :-&gt;: b) -&gt; [((), b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-type">UnitTrie</span></a></span><span> </span><span id="local-6989586621679040088"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040088"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040088"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039555"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039555"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039555"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679039555"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621679040092"><span class="annot"><span class="annottext">pack :: O (() :-&gt;: a) -&gt; () :-&gt;: a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></span></span><span> </span><span id="local-6989586621679040093"><span class="annot"><span class="annottext">O (() :-&gt;: a)
</span><a href="#local-6989586621679040093"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; () :-&gt;: a
forall a. a -&gt; () :-&gt;: a
</span><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-var">UnitTrie</span></a></span><span> </span><span class="annot"><span class="annottext">a
O (() :-&gt;: a)
</span><a href="#local-6989586621679040093"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621679040094"><span class="annot"><span class="annottext">unpack :: (() :-&gt;: a) -&gt; O (() :-&gt;: a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#UnitTrie"><span class="hs-identifier hs-type">UnitTrie</span></a></span><span> </span><span id="local-6989586621679040095"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040095"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
O (() :-&gt;: a)
</span><a href="#local-6989586621679040095"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- Proofs of inverse properties:</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">{-
    untrie (trie f)
      == { trie def }
    untrie (UnitTrie (f ()))
      == { untrie def }
    \ () -&gt; (f ())
      == { const-unit }
    f   

    trie (untrie (UnitTrie a))
      == { untrie def }
    trie (\ () -&gt; a)
      == { trie def }
    UnitTrie ((\ () -&gt; a) ())
      == { beta-reduction }
    UnitTrie a

Oops -- the last step of the first direction is bogus when f is non-strict.
Can be fixed by using @const a@ in place of @\ () -&gt; a@, but I can't do
the same for other types, like integers or sums.

All of these proofs have this same bug, unless we restrict ourselves to
memoizing hyper-strict functions.

-}</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="local-6989586621679039557"><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BoolTrie"><span class="annot"><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-var">BoolTrie</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679040101"><span class="annot"><span class="annottext">trie :: forall b. (Bool -&gt; b) -&gt; Bool :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040102"><span class="annot"><span class="annottext">Bool -&gt; b
</span><a href="#local-6989586621679040102"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool :-&gt;: b
forall x. x -&gt; x -&gt; Bool :-&gt;: x
</span><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-var">BoolTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; b
</span><a href="#local-6989586621679040102"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; b
</span><a href="#local-6989586621679040102"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679040103"><span class="annot"><span class="annottext">untrie :: forall b. (Bool :-&gt;: b) -&gt; Bool -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-type">BoolTrie</span></a></span><span> </span><span id="local-6989586621679040104"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040104"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679040105"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040105"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool -&gt; b
forall x. x -&gt; x -&gt; Bool -&gt; x
</span><a href="Data.MemoTrie.html#if%27"><span class="hs-identifier hs-var">if'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040104"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040105"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679040107"><span class="annot"><span class="annottext">enumerate :: forall b. (Bool :-&gt;: b) -&gt; [(Bool, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-type">BoolTrie</span></a></span><span> </span><span id="local-6989586621679040108"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040108"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679040109"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040109"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040108"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040109"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039563"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679040113"><span class="annot"><span class="annottext">pack :: O (Bool :-&gt;: a) -&gt; Bool :-&gt;: a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040114"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040114"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040115"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040115"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool :-&gt;: a
forall x. x -&gt; x -&gt; Bool :-&gt;: x
</span><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-var">BoolTrie</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040115"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679040116"><span class="annot"><span class="annottext">unpack :: (Bool :-&gt;: a) -&gt; O (Bool :-&gt;: a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#BoolTrie"><span class="hs-identifier hs-type">BoolTrie</span></a></span><span> </span><span id="local-6989586621679040117"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040117"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679040118"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040118"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040117"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040118"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Conditional with boolean last.</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- Spec: @if' (f False) (f True) == f@</span><span>
</span><span id="line-295"></span><span id="local-6989586621679039560"><span class="annot"><a href="Data.MemoTrie.html#if%27"><span class="hs-identifier hs-type">if'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-296"></span><span id="if%27"><span class="annot"><span class="annottext">if' :: forall x. x -&gt; x -&gt; Bool -&gt; x
</span><a href="Data.MemoTrie.html#if%27"><span class="hs-identifier hs-var hs-var">if'</span></a></span></span><span> </span><span id="local-6989586621679040119"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040119"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040119"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Data.MemoTrie.html#if%27"><span class="hs-identifier hs-var">if'</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679040120"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040120"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040120"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">{-
    untrie (trie f)
      == { trie def }
    untrie (BoolTrie (f False) (f True))
      == { untrie def }
    if' (f False) (f True)
      == { if' spec }
    f

    trie (untrie (BoolTrie f t))
      == { untrie def }
    trie (if' f t)
      == { trie def }
    BoolTrie (if' f t False) (if' f t True)
      == { if' spec }
    BoolTrie f t
-}</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039566"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">(:-&gt;:)</span></a></span></span><span> </span><span id="local-6989586621679039568"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MaybeTrie"><span class="annot"><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-var">MaybeTrie</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679040128"><span class="annot"><span class="annottext">trie :: forall b. (Maybe a -&gt; b) -&gt; Maybe a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040129"><span class="annot"><span class="annottext">Maybe a -&gt; b
</span><a href="#local-6989586621679040129"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; (a :-&gt;: b) -&gt; Maybe a :-&gt;: b
forall a b. b -&gt; (a :-&gt;: b) -&gt; Maybe a :-&gt;: b
</span><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-var">MaybeTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; b
</span><a href="#local-6989586621679040129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; b
</span><a href="#local-6989586621679040129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; b) -&gt; (a -&gt; Maybe a) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679040131"><span class="annot"><span class="annottext">untrie :: forall b. (Maybe a :-&gt;: b) -&gt; Maybe a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-type">MaybeTrie</span></a></span><span> </span><span id="local-6989586621679040132"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040132"><span class="hs-identifier hs-var">nothing_val</span></a></span></span><span> </span><span id="local-6989586621679040133"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040133"><span class="hs-identifier hs-var">a_trie</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040132"><span class="hs-identifier hs-var">nothing_val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040133"><span class="hs-identifier hs-var">a_trie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679040136"><span class="annot"><span class="annottext">enumerate :: forall b. (Maybe a :-&gt;: b) -&gt; [(Maybe a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-type">MaybeTrie</span></a></span><span> </span><span id="local-6989586621679040137"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040137"><span class="hs-identifier hs-var">nothing_val</span></a></span></span><span> </span><span id="local-6989586621679040138"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040138"><span class="hs-identifier hs-var">a_trie</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040137"><span class="hs-identifier hs-var">nothing_val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe a, b) -&gt; [(Maybe a, b)] -&gt; [(Maybe a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; (a :-&gt;: b) -&gt; [(Maybe a, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040138"><span class="hs-identifier hs-var">a_trie</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039580"><span id="local-6989586621679039581"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679040143"><span class="annot"><span class="annottext">pack :: O (Maybe a :-&gt;: x) -&gt; Maybe a :-&gt;: x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040144"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040144"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040145"><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040145"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; (a :-&gt;: x) -&gt; Maybe a :-&gt;: x
forall a b. b -&gt; (a :-&gt;: b) -&gt; Maybe a :-&gt;: b
</span><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-var">MaybeTrie</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040144"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040145"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679040146"><span class="annot"><span class="annottext">unpack :: (Maybe a :-&gt;: x) -&gt; O (Maybe a :-&gt;: x)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#MaybeTrie"><span class="hs-identifier hs-type">MaybeTrie</span></a></span><span> </span><span id="local-6989586621679040147"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040147"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679040148"><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040148"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040147"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040148"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039584"><span id="local-6989586621679039585"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="local-6989586621679039588"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EitherTrie"><span class="annot"><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-var">EitherTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679040158"><span class="annot"><span class="annottext">trie :: forall b. (Either a b -&gt; b) -&gt; Either a b :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040159"><span class="annot"><span class="annottext">Either a b -&gt; b
</span><a href="#local-6989586621679040159"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; (b :-&gt;: b) -&gt; Either a b :-&gt;: b
forall a b x. (a :-&gt;: x) -&gt; (b :-&gt;: x) -&gt; Either a b :-&gt;: x
</span><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-var">EitherTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either a b -&gt; b
</span><a href="#local-6989586621679040159"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; b) -&gt; (a -&gt; Either a b) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; b :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (b -&gt; b) -&gt; b :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either a b -&gt; b
</span><a href="#local-6989586621679040159"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; b) -&gt; (b -&gt; Either a b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679040162"><span class="annot"><span class="annottext">untrie :: forall b. (Either a b :-&gt;: b) -&gt; Either a b -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-type">EitherTrie</span></a></span><span> </span><span id="local-6989586621679040163"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040163"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679040164"><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040164"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (b -&gt; b) -&gt; Either a b -&gt; b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040163"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b :-&gt;: b) -&gt; b -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (b :-&gt;: b) -&gt; b -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040164"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679040168"><span class="annot"><span class="annottext">enumerate :: forall b. (Either a b :-&gt;: b) -&gt; [(Either a b, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-type">EitherTrie</span></a></span><span> </span><span id="local-6989586621679040169"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040169"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679040170"><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040170"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; (a :-&gt;: b) -&gt; [(Either a b, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040169"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[(Either a b, b)] -&gt; [(Either a b, b)] -&gt; [(Either a b, b)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.MemoTrie.html#weave"><span class="hs-operator hs-var">`weave`</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Either a b) -&gt; (b :-&gt;: b) -&gt; [(Either a b, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040170"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039601"><span id="local-6989586621679039602"><span id="local-6989586621679039603"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039602"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039602"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039602"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679040175"><span class="annot"><span class="annottext">pack :: O (Either a b :-&gt;: x) -&gt; Either a b :-&gt;: x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040176"><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040176"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040177"><span class="annot"><span class="annottext">b :-&gt;: x
</span><a href="#local-6989586621679040177"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: x) -&gt; (b :-&gt;: x) -&gt; Either a b :-&gt;: x
forall a b x. (a :-&gt;: x) -&gt; (b :-&gt;: x) -&gt; Either a b :-&gt;: x
</span><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-var">EitherTrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b :-&gt;: x
</span><a href="#local-6989586621679040177"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679040178"><span class="annot"><span class="annottext">unpack :: (Either a b :-&gt;: x) -&gt; O (Either a b :-&gt;: x)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#EitherTrie"><span class="hs-identifier hs-type">EitherTrie</span></a></span><span> </span><span id="local-6989586621679040179"><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040179"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679040180"><span class="annot"><span class="annottext">b :-&gt;: x
</span><a href="#local-6989586621679040180"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a :-&gt;: x
</span><a href="#local-6989586621679040179"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b :-&gt;: x
</span><a href="#local-6989586621679040180"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621679039575"><span id="local-6989586621679039576"><span id="local-6989586621679039577"><span class="annot"><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-type">enum'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-340"></span><span id="enum%27"><span class="annot"><span class="annottext">enum' :: forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var hs-var">enum'</span></a></span></span><span> </span><span id="local-6989586621679040187"><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679040187"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, b) -&gt; (a', b)) -&gt; [(a, b)] -&gt; [(a', b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="annot"><span class="annottext">(((a, b) -&gt; (a', b)) -&gt; [(a, b)] -&gt; [(a', b)])
-&gt; ((a -&gt; a') -&gt; (a, b) -&gt; (a', b))
-&gt; (a -&gt; a')
-&gt; [(a, b)]
-&gt; [(a', b)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(a -&gt; a') -&gt; (a, b) -&gt; (a', b)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679040187"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; [(a', b)])
-&gt; ((a :-&gt;: b) -&gt; [(a, b)]) -&gt; (a :-&gt;: b) -&gt; [(a', b)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; [(a, b)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621679040188"><span class="annot"><a href="Data.MemoTrie.html#weave"><span class="hs-identifier hs-type">weave</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679040188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679040188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679040188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-343"></span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="weave"><span class="annot"><span class="annottext">weave :: forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.MemoTrie.html#weave"><span class="hs-operator hs-var hs-var">`weave`</span></a></span></span><span> </span><span id="local-6989586621679040189"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040189"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040189"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-344"></span><span id="local-6989586621679040190"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040190"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#weave"><span class="hs-operator hs-var">`weave`</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040190"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-345"></span><span class="hs-special">(</span><span id="local-6989586621679040191"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040191"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679040192"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040192"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#weave"><span class="hs-operator hs-var">`weave`</span></a></span><span> </span><span id="local-6989586621679040193"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040193"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040191"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040193"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.MemoTrie.html#weave"><span class="hs-operator hs-var">`weave`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679040192"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">{-
    untrie (trie f)
       == { trie def }
    untrie (EitherTrie (trie (f . Left)) (trie (f . Right)))
       == { untrie def }
    either (untrie (trie (f . Left))) (untrie (trie (f . Right)))
       == { untrie . trie }
    either (f . Left) (f . Right)
       == { either }
    f

    trie (untrie (EitherTrie s t))
       == { untrie def }
    trie (either (untrie s) (untrie t))
       == { trie def }
    EitherTrie (trie (either (untrie s) (untrie t) . Left))
               (trie (either (untrie s) (untrie t) . Right))
       == { either }
    EitherTrie (trie (untrie s)) (trie (untrie t))
       == { trie . untrie }
    EitherTrie s t
-}</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039618"><span id="local-6989586621679039619"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039623"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039623"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PairTrie"><span class="annot"><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-var">PairTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039623"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679040203"><span class="annot"><span class="annottext">trie :: forall b. ((a, b) -&gt; b) -&gt; (a, b) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040204"><span class="annot"><span class="annottext">(a, b) -&gt; b
</span><a href="#local-6989586621679040204"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: (b :-&gt;: b)) -&gt; (a, b) :-&gt;: b
forall a b x. (a :-&gt;: (b :-&gt;: x)) -&gt; (a, b) :-&gt;: x
</span><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-var">PairTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b :-&gt;: b) -&gt; a :-&gt;: (b :-&gt;: b)
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; b :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (b -&gt; b) -&gt; b :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="annot"><span class="annottext">((b -&gt; b) -&gt; b :-&gt;: b) -&gt; (a -&gt; b -&gt; b) -&gt; a -&gt; b :-&gt;: b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; a -&gt; b -&gt; b
forall a b c. ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c
</span><span class="hs-identifier hs-var">curry</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
</span><a href="#local-6989586621679040204"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679040208"><span class="annot"><span class="annottext">untrie :: forall b. ((a, b) :-&gt;: b) -&gt; (a, b) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-type">PairTrie</span></a></span><span> </span><span id="local-6989586621679040209"><span class="annot"><span class="annottext">a :-&gt;: (b :-&gt;: b)
</span><a href="#local-6989586621679040209"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; (a, b) -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b :-&gt;: b) -&gt; b -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (b :-&gt;: b) -&gt; b -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((b :-&gt;: b) -&gt; b -&gt; b) -&gt; (a -&gt; b :-&gt;: b) -&gt; a -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">(a :-&gt;: (b :-&gt;: b)) -&gt; a -&gt; b :-&gt;: b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: (b :-&gt;: b)
</span><a href="#local-6989586621679040209"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679040213"><span class="annot"><span class="annottext">enumerate :: forall b. ((a, b) :-&gt;: b) -&gt; [((a, b), b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-type">PairTrie</span></a></span><span> </span><span id="local-6989586621679040214"><span class="annot"><span class="annottext">a :-&gt;: (b :-&gt;: b)
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">tt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040215"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040216"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040217"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040215"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040215"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040218"><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040218"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: (b :-&gt;: b)) -&gt; [(a, b :-&gt;: b)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: (b :-&gt;: b)
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">tt</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040216"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040216"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040217"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040217"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(b :-&gt;: b) -&gt; [(b, b)]
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; [(a, b)]
forall b. (b :-&gt;: b) -&gt; [(b, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span> </span><span class="annot"><span class="annottext">b :-&gt;: b
</span><a href="#local-6989586621679040218"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039636"><span id="local-6989586621679039637"><span id="local-6989586621679039638"><span class="annot"><span class="hs-identifier hs-type">Newtype</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039637"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039638"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="O"><span class="annot"><span class="hs-identifier hs-var">O</span></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039637"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039638"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679039636"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039637"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039638"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679040222"><span class="annot"><span class="annottext">pack :: O ((a, b) :-&gt;: x) -&gt; (a, b) :-&gt;: x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pack</span></span></span><span> </span><span id="local-6989586621679040223"><span class="annot"><span class="annottext">O ((a, b) :-&gt;: x)
</span><a href="#local-6989586621679040223"><span class="hs-identifier hs-var">abx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: (b :-&gt;: x)) -&gt; (a, b) :-&gt;: x
forall a b x. (a :-&gt;: (b :-&gt;: x)) -&gt; (a, b) :-&gt;: x
</span><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-var">PairTrie</span></a></span><span> </span><span class="annot"><span class="annottext">O ((a, b) :-&gt;: x)
a :-&gt;: (b :-&gt;: x)
</span><a href="#local-6989586621679040223"><span class="hs-identifier hs-var">abx</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679040224"><span class="annot"><span class="annottext">unpack :: ((a, b) :-&gt;: x) -&gt; O ((a, b) :-&gt;: x)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unpack</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#PairTrie"><span class="hs-identifier hs-type">PairTrie</span></a></span><span> </span><span id="local-6989586621679040225"><span class="annot"><span class="annottext">a :-&gt;: (b :-&gt;: x)
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">abx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O ((a, b) :-&gt;: x)
a :-&gt;: (b :-&gt;: x)
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">abx</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">{-
    untrie (trie f)
      == { trie def }
    untrie (PairTrie (trie (trie . curry f)))
      == { untrie def }
    uncurry (untrie . untrie (trie (trie . curry f)))
      == { untrie . trie }
    uncurry (untrie . trie . curry f)
      == { untrie . untrie }
    uncurry (curry f)
      == { uncurry . curry }
    f

    trie (untrie (PairTrie t))
      == { untrie def }
    trie (uncurry (untrie .  untrie t))
      == { trie def }
    PairTrie (trie (trie . curry (uncurry (untrie .  untrie t))))
      == { curry . uncurry }
    PairTrie (trie (trie . untrie .  untrie t))
      == { trie . untrie }
    PairTrie (trie (untrie t))
      == { trie . untrie }
    PairTrie t
-}</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039642"><span id="local-6989586621679039643"><span id="local-6989586621679039644"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039642"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039644"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039642"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039644"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039649"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039642"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039644"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039649"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TripleTrie"><span class="annot"><a href="Data.MemoTrie.html#TripleTrie"><span class="hs-identifier hs-var">TripleTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039642"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039644"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039649"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679040236"><span class="annot"><span class="annottext">trie :: forall b. ((a, b, c) -&gt; b) -&gt; (a, b, c) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040237"><span class="annot"><span class="annottext">(a, b, c) -&gt; b
</span><a href="#local-6989586621679040237"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((a, b), c) :-&gt;: b) -&gt; (a, b, c) :-&gt;: b
forall a b c x. (((a, b), c) :-&gt;: x) -&gt; (a, b, c) :-&gt;: x
</span><a href="Data.MemoTrie.html#TripleTrie"><span class="hs-identifier hs-var">TripleTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(((a, b), c) -&gt; b) -&gt; ((a, b), c) :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (((a, b), c) -&gt; b) -&gt; ((a, b), c) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, b, c) -&gt; b
</span><a href="#local-6989586621679040237"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((a, b, c) -&gt; b) -&gt; (((a, b), c) -&gt; (a, b, c)) -&gt; ((a, b), c) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, b), c) -&gt; (a, b, c)
forall a b c. ((a, b), c) -&gt; (a, b, c)
</span><a href="Data.MemoTrie.html#trip"><span class="hs-identifier hs-var">trip</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679040241"><span class="annot"><span class="annottext">untrie :: forall b. ((a, b, c) :-&gt;: b) -&gt; (a, b, c) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#TripleTrie"><span class="hs-identifier hs-type">TripleTrie</span></a></span><span> </span><span id="local-6989586621679040242"><span class="annot"><span class="annottext">((a, b), c) :-&gt;: b
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((a, b), c) :-&gt;: b) -&gt; ((a, b), c) -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (((a, b), c) :-&gt;: b) -&gt; ((a, b), c) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((a, b), c) :-&gt;: b
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, b), c) -&gt; b) -&gt; ((a, b, c) -&gt; ((a, b), c)) -&gt; (a, b, c) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, b, c) -&gt; ((a, b), c)
forall a b c. (a, b, c) -&gt; ((a, b), c)
</span><a href="Data.MemoTrie.html#detrip"><span class="hs-identifier hs-var">detrip</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679040246"><span class="annot"><span class="annottext">enumerate :: forall b. ((a, b, c) :-&gt;: b) -&gt; [((a, b, c), b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#TripleTrie"><span class="hs-identifier hs-type">TripleTrie</span></a></span><span> </span><span id="local-6989586621679040247"><span class="annot"><span class="annottext">((a, b), c) :-&gt;: b
</span><a href="#local-6989586621679040247"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((a, b), c) -&gt; (a, b, c))
-&gt; (((a, b), c) :-&gt;: b) -&gt; [((a, b, c), b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">((a, b), c) -&gt; (a, b, c)
forall a b c. ((a, b), c) -&gt; (a, b, c)
</span><a href="Data.MemoTrie.html#trip"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">((a, b), c) :-&gt;: b
</span><a href="#local-6989586621679040247"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621679039650"><span id="local-6989586621679039651"><span id="local-6989586621679039652"><span class="annot"><a href="Data.MemoTrie.html#trip"><span class="hs-identifier hs-type">trip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039651"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039652"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039651"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039652"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-416"></span><span id="trip"><span class="annot"><span class="annottext">trip :: forall a b c. ((a, b), c) -&gt; (a, b, c)
</span><a href="Data.MemoTrie.html#trip"><span class="hs-identifier hs-var hs-var">trip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679040248"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040248"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040249"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040249"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679040250"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679040250"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040248"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040249"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679040250"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span id="local-6989586621679039655"><span id="local-6989586621679039656"><span id="local-6989586621679039657"><span class="annot"><a href="Data.MemoTrie.html#detrip"><span class="hs-identifier hs-type">detrip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039656"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039657"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039656"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039657"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-419"></span><span id="detrip"><span class="annot"><span class="annottext">detrip :: forall a b c. (a, b, c) -&gt; ((a, b), c)
</span><a href="Data.MemoTrie.html#detrip"><span class="hs-identifier hs-var hs-var">detrip</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040251"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040251"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040252"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040252"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040253"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679040253"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040251"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040252"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679040253"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039666"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039669"><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039669"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ListTrie"><span class="annot"><a href="Data.MemoTrie.html#ListTrie"><span class="hs-identifier hs-var">ListTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621679040264"><span class="annot"><span class="annottext">trie :: forall b. ([x] -&gt; b) -&gt; [x] :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040265"><span class="annot"><span class="annottext">[x] -&gt; b
</span><a href="#local-6989586621679040265"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either () (x, [x]) :-&gt;: b) -&gt; [x] :-&gt;: b
forall x a. (Either () (x, [x]) :-&gt;: a) -&gt; [x] :-&gt;: a
</span><a href="Data.MemoTrie.html#ListTrie"><span class="hs-identifier hs-var">ListTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either () (x, [x]) -&gt; b) -&gt; Either () (x, [x]) :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (Either () (x, [x]) -&gt; b) -&gt; Either () (x, [x]) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[x] -&gt; b
</span><a href="#local-6989586621679040265"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([x] -&gt; b)
-&gt; (Either () (x, [x]) -&gt; [x]) -&gt; Either () (x, [x]) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either () (x, [x]) -&gt; [x]
forall x. Either () (x, [x]) -&gt; [x]
</span><a href="Data.MemoTrie.html#list"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679040271"><span class="annot"><span class="annottext">untrie :: forall b. ([x] :-&gt;: b) -&gt; [x] -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#ListTrie"><span class="hs-identifier hs-type">ListTrie</span></a></span><span> </span><span id="local-6989586621679040272"><span class="annot"><span class="annottext">Either () (x, [x]) :-&gt;: b
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either () (x, [x]) :-&gt;: b) -&gt; Either () (x, [x]) -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (Either () (x, [x]) :-&gt;: b) -&gt; Either () (x, [x]) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">Either () (x, [x]) :-&gt;: b
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Either () (x, [x]) -&gt; b)
-&gt; ([x] -&gt; Either () (x, [x])) -&gt; [x] -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[x] -&gt; Either () (x, [x])
forall x. [x] -&gt; Either () (x, [x])
</span><a href="Data.MemoTrie.html#delist"><span class="hs-identifier hs-var">delist</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679040278"><span class="annot"><span class="annottext">enumerate :: forall b. ([x] :-&gt;: b) -&gt; [([x], b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#ListTrie"><span class="hs-identifier hs-type">ListTrie</span></a></span><span> </span><span id="local-6989586621679040279"><span class="annot"><span class="annottext">Either () (x, [x]) :-&gt;: b
</span><a href="#local-6989586621679040279"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either () (x, [x]) -&gt; [x])
-&gt; (Either () (x, [x]) :-&gt;: b) -&gt; [([x], b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">Either () (x, [x]) -&gt; [x]
forall x. Either () (x, [x]) -&gt; [x]
</span><a href="Data.MemoTrie.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">Either () (x, [x]) :-&gt;: b
</span><a href="#local-6989586621679040279"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span id="local-6989586621679039670"><span class="annot"><a href="Data.MemoTrie.html#list"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039670"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039670"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039670"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-429"></span><span id="list"><span class="annot"><span class="annottext">list :: forall x. Either () (x, [x]) -&gt; [x]
</span><a href="Data.MemoTrie.html#list"><span class="hs-identifier hs-var hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; [x]) -&gt; ((x, [x]) -&gt; [x]) -&gt; Either () (x, [x]) -&gt; [x]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[x] -&gt; () -&gt; [x]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; [x] -&gt; [x]) -&gt; (x, [x]) -&gt; [x]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="local-6989586621679039673"><span class="annot"><a href="Data.MemoTrie.html#delist"><span class="hs-identifier hs-type">delist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-432"></span><span id="delist"><span class="annot"><span class="annottext">delist :: forall x. [x] -&gt; Either () (x, [x])
</span><a href="Data.MemoTrie.html#delist"><span class="hs-identifier hs-var hs-var">delist</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either () (x, [x])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span class="annot"><a href="Data.MemoTrie.html#delist"><span class="hs-identifier hs-var">delist</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040280"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040280"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679040281"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679040281"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x, [x]) -&gt; Either () (x, [x])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679040280"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679040281"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#define WordInstance(Type,TrieType)\
instance HasTrie Type where \
  newtype Type :-&gt;: a = TrieType ([Bool] :-&gt;: a);\
  trie f = TrieType (trie (f . unbits));\
  untrie (TrieType t) = untrie t . bits;\
  enumerate (TrieType t) = enum' unbits t
</span><span>
</span><span id="line-442"></span><span class="hs-identifier">WordInstance</span><span class="hs-special">(</span><span class="hs-identifier">Word</span><span class="hs-special">,</span><span class="hs-identifier">WordTrie</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span class="hs-identifier">WordInstance</span><span class="hs-special">(</span><span class="hs-identifier">Word8</span><span class="hs-special">,</span><span class="hs-identifier">Word8Trie</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span class="hs-identifier">WordInstance</span><span class="hs-special">(</span><span class="hs-identifier">Word16</span><span class="hs-special">,</span><span class="hs-identifier">Word16Trie</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span class="hs-identifier">WordInstance</span><span class="hs-special">(</span><span class="hs-identifier">Word32</span><span class="hs-special">,</span><span class="hs-identifier">Word32Trie</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span class="hs-identifier">WordInstance</span><span class="hs-special">(</span><span class="hs-identifier">Word64</span><span class="hs-special">,</span><span class="hs-identifier">Word64Trie</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- instance HasTrie Word where</span><span>
</span><span id="line-449"></span><span class="hs-comment">--   newtype Word :-&gt;: a = WordTrie ([Bool] :-&gt;: a)</span><span>
</span><span id="line-450"></span><span class="hs-comment">--   trie f = WordTrie (trie (f . unbits))</span><span>
</span><span id="line-451"></span><span class="hs-comment">--   untrie (WordTrie t) = untrie t . bits</span><span>
</span><span id="line-452"></span><span class="hs-comment">--   enumerate (WordTrie t) = enum' unbits t</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><span class="hs-comment">-- | Extract bits in little-endian order</span></span><span>
</span><span id="line-456"></span><span id="local-6989586621679039683"><span class="annot"><a href="Data.MemoTrie.html#bits"><span class="hs-identifier hs-type">bits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679039683"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679039683"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039683"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-457"></span><span id="bits"><span class="annot"><span class="annottext">bits :: forall t. (Num t, Bits t) =&gt; t -&gt; [Bool]
</span><a href="Data.MemoTrie.html#bits"><span class="hs-identifier hs-var hs-var">bits</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span class="annot"><a href="Data.MemoTrie.html#bits"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span id="local-6989586621679040419"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679040419"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679040419"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool] -&gt; [Bool]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; [Bool]
forall t. (Num t, Bits t) =&gt; t -&gt; [Bool]
</span><a href="Data.MemoTrie.html#bits"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Int -&gt; t
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftR</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679040419"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><span class="hs-comment">-- | Convert boolean to 0 (False) or 1 (True)</span></span><span>
</span><span id="line-461"></span><span id="local-6989586621679039707"><span class="annot"><a href="Data.MemoTrie.html#unbit"><span class="hs-identifier hs-type">unbit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679039707"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039707"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-462"></span><span id="unbit"><span class="annot"><span class="annottext">unbit :: forall t. Num t =&gt; Bool -&gt; t
</span><a href="Data.MemoTrie.html#unbit"><span class="hs-identifier hs-var hs-var">unbit</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Data.MemoTrie.html#unbit"><span class="hs-identifier hs-var">unbit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="annot"><span class="hs-comment">-- | Bit list to value</span></span><span>
</span><span id="line-466"></span><span id="local-6989586621679039680"><span class="annot"><a href="Data.MemoTrie.html#unbits"><span class="hs-identifier hs-type">unbits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679039680"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679039680"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039680"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-467"></span><span id="unbits"><span class="annot"><span class="annottext">unbits :: forall t. (Num t, Bits t) =&gt; [Bool] -&gt; t
</span><a href="Data.MemoTrie.html#unbits"><span class="hs-identifier hs-var hs-var">unbits</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Data.MemoTrie.html#unbits"><span class="hs-identifier hs-var">unbits</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040434"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040434"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679040435"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679040435"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; t
forall t. Num t =&gt; Bool -&gt; t
</span><a href="Data.MemoTrie.html#unbit"><span class="hs-identifier hs-var">unbit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040434"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Int -&gt; t
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; t
forall t. (Num t, Bits t) =&gt; [Bool] -&gt; t
</span><a href="Data.MemoTrie.html#unbits"><span class="hs-identifier hs-var">unbits</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679040435"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039714"><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CharTrie"><span class="annot"><a href="Data.MemoTrie.html#CharTrie"><span class="hs-identifier hs-var">CharTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679040447"><span class="annot"><span class="annottext">untrie :: forall b. (Char :-&gt;: b) -&gt; Char -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#CharTrie"><span class="hs-identifier hs-type">CharTrie</span></a></span><span> </span><span id="local-6989586621679040448"><span class="annot"><span class="annottext">Int :-&gt;: b
</span><a href="#local-6989586621679040448"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679040449"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040449"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int :-&gt;: b) -&gt; Int -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (Int :-&gt;: b) -&gt; Int -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">Int :-&gt;: b
</span><a href="#local-6989586621679040448"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040449"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679040453"><span class="annot"><span class="annottext">trie :: forall b. (Char -&gt; b) -&gt; Char :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040454"><span class="annot"><span class="annottext">Char -&gt; b
</span><a href="#local-6989586621679040454"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int :-&gt;: b) -&gt; Char :-&gt;: b
forall a. (Int :-&gt;: a) -&gt; Char :-&gt;: a
</span><a href="Data.MemoTrie.html#CharTrie"><span class="hs-identifier hs-var">CharTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; b) -&gt; Int :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (Int -&gt; b) -&gt; Int :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; b
</span><a href="#local-6989586621679040454"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; b) -&gt; (Int -&gt; Char) -&gt; Int -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621679040458"><span class="annot"><span class="annottext">enumerate :: forall b. (Char :-&gt;: b) -&gt; [(Char, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#CharTrie"><span class="hs-identifier hs-type">CharTrie</span></a></span><span> </span><span id="local-6989586621679040459"><span class="annot"><span class="annottext">Int :-&gt;: b
</span><a href="#local-6989586621679040459"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; (Int :-&gt;: b) -&gt; [(Char, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int :-&gt;: b
</span><a href="#local-6989586621679040459"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- Although Int is a Bits instance, we can't use bits directly for</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- memoizing, because the &quot;bits&quot; function gives an infinite result, since</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- shiftR (-1) 1 == -1.  Instead, convert between Int and Word, and use</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- a Word trie.  Any Integral type can be handled similarly.</span><span class="hs-cpp">

#define IntInstance(IntType,WordType,TrieType) \
instance HasTrie IntType where \
  newtype IntType :-&gt;: a = TrieType (WordType :-&gt;: a); \
  untrie (TrieType t) n = untrie t (fromIntegral n); \
  trie f = TrieType (trie (f . fromIntegral)); \
  enumerate (TrieType t) = enum' fromIntegral t
</span><span>
</span><span id="line-488"></span><span class="hs-identifier">IntInstance</span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span class="hs-identifier">Word</span><span class="hs-special">,</span><span class="hs-identifier">IntTrie</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span class="hs-identifier">IntInstance</span><span class="hs-special">(</span><span class="hs-identifier">Int8</span><span class="hs-special">,</span><span class="hs-identifier">Word8</span><span class="hs-special">,</span><span class="hs-identifier">Int8Trie</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span class="hs-identifier">IntInstance</span><span class="hs-special">(</span><span class="hs-identifier">Int16</span><span class="hs-special">,</span><span class="hs-identifier">Word16</span><span class="hs-special">,</span><span class="hs-identifier">Int16Trie</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span class="hs-identifier">IntInstance</span><span class="hs-special">(</span><span class="hs-identifier">Int32</span><span class="hs-special">,</span><span class="hs-identifier">Word32</span><span class="hs-special">,</span><span class="hs-identifier">Int32Trie</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span class="hs-identifier">IntInstance</span><span class="hs-special">(</span><span class="hs-identifier">Int64</span><span class="hs-special">,</span><span class="hs-identifier">Word64</span><span class="hs-special">,</span><span class="hs-identifier">Int64Trie</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- For unbounded integers, we don't have a corresponding Word type, so</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- extract the sign bit.</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="local-6989586621679039744"><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039744"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IntegerTrie"><span class="annot"><a href="Data.MemoTrie.html#IntegerTrie"><span class="hs-identifier hs-var">IntegerTrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039744"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679040591"><span class="annot"><span class="annottext">trie :: forall b. (Integer -&gt; b) -&gt; Integer :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040592"><span class="annot"><span class="annottext">Integer -&gt; b
</span><a href="#local-6989586621679040592"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Bool, [Bool]) :-&gt;: b) -&gt; Integer :-&gt;: b
forall a. ((Bool, [Bool]) :-&gt;: a) -&gt; Integer :-&gt;: a
</span><a href="Data.MemoTrie.html#IntegerTrie"><span class="hs-identifier hs-var">IntegerTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Bool, [Bool]) -&gt; b) -&gt; (Bool, [Bool]) :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. ((Bool, [Bool]) -&gt; b) -&gt; (Bool, [Bool]) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; b
</span><a href="#local-6989586621679040592"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; b)
-&gt; ((Bool, [Bool]) -&gt; Integer) -&gt; (Bool, [Bool]) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool, [Bool]) -&gt; Integer
forall n. (Num n, Bits n) =&gt; (Bool, [Bool]) -&gt; n
</span><a href="Data.MemoTrie.html#unbitsZ"><span class="hs-identifier hs-var">unbitsZ</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679040601"><span class="annot"><span class="annottext">untrie :: forall b. (Integer :-&gt;: b) -&gt; Integer -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#IntegerTrie"><span class="hs-identifier hs-type">IntegerTrie</span></a></span><span> </span><span id="local-6989586621679040602"><span class="annot"><span class="annottext">(Bool, [Bool]) :-&gt;: b
</span><a href="#local-6989586621679040602"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Bool, [Bool]) :-&gt;: b) -&gt; (Bool, [Bool]) -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. ((Bool, [Bool]) :-&gt;: b) -&gt; (Bool, [Bool]) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, [Bool]) :-&gt;: b
</span><a href="#local-6989586621679040602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool, [Bool]) -&gt; b)
-&gt; (Integer -&gt; (Bool, [Bool])) -&gt; Integer -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; (Bool, [Bool])
forall n. (Num n, Ord n, Bits n) =&gt; n -&gt; (Bool, [Bool])
</span><a href="Data.MemoTrie.html#bitsZ"><span class="hs-identifier hs-var">bitsZ</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679040609"><span class="annot"><span class="annottext">enumerate :: forall b. (Integer :-&gt;: b) -&gt; [(Integer, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#IntegerTrie"><span class="hs-identifier hs-type">IntegerTrie</span></a></span><span> </span><span id="local-6989586621679040610"><span class="annot"><span class="annottext">(Bool, [Bool]) :-&gt;: b
</span><a href="#local-6989586621679040610"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Bool, [Bool]) -&gt; Integer)
-&gt; ((Bool, [Bool]) :-&gt;: b) -&gt; [(Integer, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, [Bool]) -&gt; Integer
forall n. (Num n, Bits n) =&gt; (Bool, [Bool]) -&gt; n
</span><a href="Data.MemoTrie.html#unbitsZ"><span class="hs-identifier hs-var">unbitsZ</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, [Bool]) :-&gt;: b
</span><a href="#local-6989586621679040610"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621679039745"><span class="annot"><a href="Data.MemoTrie.html#unbitsZ"><span class="hs-identifier hs-type">unbitsZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-505"></span><span id="unbitsZ"><span class="annot"><span class="annottext">unbitsZ :: forall n. (Num n, Bits n) =&gt; (Bool, [Bool]) -&gt; n
</span><a href="Data.MemoTrie.html#unbitsZ"><span class="hs-identifier hs-var hs-var">unbitsZ</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040616"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040616"><span class="hs-identifier hs-var">positive</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040617"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679040617"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n
</span><a href="#local-6989586621679040618"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; n
forall t. (Num t, Bits t) =&gt; [Bool] -&gt; t
</span><a href="Data.MemoTrie.html#unbits"><span class="hs-identifier hs-var">unbits</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679040617"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>   </span><span id="local-6989586621679040618"><span class="annot"><span class="annottext">sig :: n -&gt; n
</span><a href="#local-6989586621679040618"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040616"><span class="hs-identifier hs-var">positive</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-508"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621679039748"><span class="annot"><a href="Data.MemoTrie.html#bitsZ"><span class="hs-identifier hs-type">bitsZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-511"></span><span id="bitsZ"><span class="annot"><span class="annottext">bitsZ :: forall n. (Num n, Ord n, Bits n) =&gt; n -&gt; (Bool, [Bool])
</span><a href="Data.MemoTrie.html#bitsZ"><span class="hs-identifier hs-var hs-var">bitsZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Bool) -&gt; (n -&gt; [Bool]) -&gt; n -&gt; (Bool, [Bool])
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; [Bool]
forall t. (Num t, Bits t) =&gt; t -&gt; [Bool]
</span><a href="Data.MemoTrie.html#bits"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; [Bool]) -&gt; (n -&gt; n) -&gt; n -&gt; [Bool]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">-- TODO: make these definitions more systematic.</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">---- Instances</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">{-

The \&quot;semantic function\&quot; 'untrie' is a morphism over 'Monoid', 'Functor',
'Applicative', 'Monad', 'Category', and 'Arrow', i.e.,

  untrie mempty          == mempty
  untrie (s `mappend` t) == untrie s `mappend` untrie t

  untrie (fmap f t)      == fmap f (untrie t)

  untrie (pure a)        == pure a
  untrie (tf &lt;*&gt; tx)     == untrie tf &lt;*&gt; untrie tx

  untrie (return a)      == return a
  untrie (u &gt;&gt;= k)       == untrie u &gt;&gt;= untrie . k

  untrie id              == id
  untrie (s . t)         == untrie s . untrie t

  untrie (arr f)         == arr f
  untrie (first t)       == first (untrie t)

These morphism properties imply that all of the expected laws hold,
assuming that we interpret equality semantically (or observationally).
For instance,

  untrie (mempty `mappend` a)
    == untrie mempty `mappend` untrie a
    == mempty `mappend` untrie a
    == untrie a

  untrie (fmap f (fmap g a))
    == fmap f (untrie (fmap g a))
    == fmap f (fmap g (untrie a))
    == fmap (f.g) (untrie a)
    == untrie (fmap (f.g) a)

The implementation instances then follow from applying 'trie' to both
sides of each of these morphism laws.

-}</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-comment">{-
instance (HasTrie a, Monoid b) =&gt; Monoid (a :-&gt;: b) where
  mempty  = trie mempty
  s `mappend` t = trie (untrie s `mappend` untrie t)

instance HasTrie a =&gt; Functor ((:-&gt;:) a) where
  fmap f t      = trie (fmap f (untrie t))

instance HasTrie a =&gt; Applicative ((:-&gt;:) a) where
  pure b        = trie (pure b)
  tf &lt;*&gt; tx     = trie (untrie tf &lt;*&gt; untrie tx)

instance HasTrie a =&gt; Monad ((:-&gt;:) a) where
  return a      = trie (return a)
  u &gt;&gt;= k       = trie (untrie u &gt;&gt;= untrie . k)

-- instance Category (:-&gt;:) where
--   id            = trie id
--   s . t         = trie (untrie s . untrie t)

-- instance Arrow (:-&gt;:) where
--   arr f         = trie (arr f)
--   first t       = trie (first (untrie t))
-}</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- Simplify, using inTrie, inTrie2</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039763"><span id="local-6989586621679039764"><span id="local-6989586621679040638"><span id="local-6989586621679040642"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039764"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039763"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039764"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-588"></span><span>  </span><span id="local-6989586621679040649"><span class="annot"><span class="annottext">mempty :: a :-&gt;: b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span>  </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inTrie2</span><span> </span><span class="hs-identifier">mappend</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039761"><span id="local-6989586621679039762"><span id="local-6989586621679040654"><span id="local-6989586621679040657"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679039762"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039762"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>  </span><span id="local-6989586621679040667"><span class="annot"><span class="annottext">&lt;&gt; :: (a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; a :-&gt;: b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; (a -&gt; b) -&gt; a -&gt; b)
-&gt; (a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; a :-&gt;: b
forall a c e b d f.
(HasTrie a, HasTrie c, HasTrie e) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
</span><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-var">inTrie2</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a -&gt; b) -&gt; a -&gt; b
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-596"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039777"><span id="local-6989586621679040671"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">(:-&gt;:)</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039777"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679040679"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; (a :-&gt;: a) -&gt; a :-&gt;: b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679040680"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679040680"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; a -&gt; b) -&gt; (a :-&gt;: a) -&gt; a :-&gt;: b
forall a c b d.
(HasTrie a, HasTrie c) =&gt;
((a -&gt; b) -&gt; c -&gt; d) -&gt; (a :-&gt;: b) -&gt; c :-&gt;: d
</span><a href="Data.MemoTrie.html#inTrie"><span class="hs-identifier hs-var">inTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679040680"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039793"><span id="local-6989586621679040687"><span id="local-6989586621679040691"><span id="local-6989586621679040694"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">(:-&gt;:)</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039793"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679040700"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; a :-&gt;: a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679040701"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040701"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a :-&gt;: a
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. a -&gt; a -&gt; a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040701"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>  </span><span id="local-6989586621679040706"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. (a :-&gt;: (a -&gt; b)) -&gt; (a :-&gt;: a) -&gt; a :-&gt;: b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b)
-&gt; (a :-&gt;: (a -&gt; b)) -&gt; (a :-&gt;: a) -&gt; a :-&gt;: b
forall a c e b d f.
(HasTrie a, HasTrie c, HasTrie e) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
</span><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-var">inTrie2</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall a b. (a -&gt; a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">(&lt;*&gt;)</span></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039805"><span id="local-6989586621679040712"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039805"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">(:-&gt;:)</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039805"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>  </span><span id="local-6989586621679040720"><span class="annot"><span class="annottext">return :: forall a. a -&gt; a :-&gt;: a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679040721"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040721"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a :-&gt;: a
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. a -&gt; a -&gt; a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040721"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>  </span><span id="local-6989586621679040726"><span class="annot"><span class="annottext">a :-&gt;: a
</span><a href="#local-6989586621679040726"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679040727"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. (a :-&gt;: a) -&gt; (a -&gt; a :-&gt;: b) -&gt; a :-&gt;: b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679040728"><span class="annot"><span class="annottext">a -&gt; a :-&gt;: b
</span><a href="#local-6989586621679040728"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: a) -&gt; a -&gt; a
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: a
</span><a href="#local-6989586621679040726"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; a) -&gt; (a -&gt; a -&gt; b) -&gt; a -&gt; b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">((a :-&gt;: b) -&gt; a -&gt; b) -&gt; (a -&gt; a :-&gt;: b) -&gt; a -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a :-&gt;: b
</span><a href="#local-6989586621679040728"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="annot"><span class="hs-comment">-- | Identity trie</span></span><span>
</span><span id="line-608"></span><span id="local-6989586621679039810"><span class="annot"><a href="Data.MemoTrie.html#idTrie"><span class="hs-identifier hs-type">idTrie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039810"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-609"></span><span id="idTrie"><span class="annot"><span class="annottext">idTrie :: forall a. HasTrie a =&gt; a :-&gt;: a
</span><a href="Data.MemoTrie.html#idTrie"><span class="hs-identifier hs-var hs-var">idTrie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a :-&gt;: a
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%40.%40"><span class="hs-operator hs-type">@.@</span></a></span><span>
</span><span id="line-612"></span><span class="annot"><span class="hs-comment">-- | Trie composition</span></span><span>
</span><span id="line-613"></span><span id="local-6989586621679039812"><span id="local-6989586621679039813"><span id="local-6989586621679039814"><span class="annot"><a href="Data.MemoTrie.html#%40.%40"><span class="hs-operator hs-type">(@.@)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039813"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-614"></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039813"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039814"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039813"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039814"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-615"></span><span id="%40.%40"><span class="annot"><span class="annottext">@.@ :: forall a b c.
(HasTrie a, HasTrie b) =&gt;
(b :-&gt;: c) -&gt; (a :-&gt;: b) -&gt; a :-&gt;: c
</span><a href="Data.MemoTrie.html#%40.%40"><span class="hs-operator hs-var hs-var">(@.@)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c)
-&gt; (b :-&gt;: c) -&gt; (a :-&gt;: b) -&gt; a :-&gt;: c
forall a c e b d f.
(HasTrie a, HasTrie c, HasTrie e) =&gt;
((a -&gt; b) -&gt; (c -&gt; d) -&gt; e -&gt; f)
-&gt; (a :-&gt;: b) -&gt; (c :-&gt;: d) -&gt; e :-&gt;: f
</span><a href="Data.MemoTrie.html#inTrie2"><span class="hs-identifier hs-var">inTrie2</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-comment">-- instance Category (:-&gt;:) where</span><span>
</span><span id="line-619"></span><span class="hs-comment">--   id  = idTrie</span><span>
</span><span id="line-620"></span><span class="hs-comment">--   (.) = (.:)</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- instance Arrow (:-&gt;:) where</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   arr f = trie (arr f)</span><span>
</span><span id="line-624"></span><span class="hs-comment">--   first = inTrie first</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-comment">{-

Correctness of these instances follows by applying 'untrie' to each side
of each definition and using the property @'untrie' . 'trie' == 'id'@.

The `Category` and `Arrow` instances don't quite work, however, because of
necessary but disallowed `HasTrie` constraints on the domain type.

-}</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span class="hs-comment">---- To go elsewhere</span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="hs-comment">-- Matt Hellige's notation for @argument f . result g@.</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- &lt;http://matt.immute.net/content/pointless-fun&gt;</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span id="local-6989586621679039506"><span id="local-6989586621679039507"><span id="local-6989586621679039508"><span id="local-6989586621679039509"><span class="annot"><a href="Data.MemoTrie.html#~%3E"><span class="hs-operator hs-type">(~&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039506"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039508"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039509"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039508"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039506"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039509"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-642"></span><span id="local-6989586621679040736"><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621679040736"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="~%3E"><span class="annot"><span class="annottext">~&gt; :: forall a' a b b'. (a' -&gt; a) -&gt; (b -&gt; b') -&gt; (a -&gt; b) -&gt; a' -&gt; b'
</span><a href="Data.MemoTrie.html#~%3E"><span class="hs-operator hs-var hs-var">~&gt;</span></a></span></span><span> </span><span id="local-6989586621679040737"><span class="annot"><span class="annottext">b -&gt; b'
</span><a href="#local-6989586621679040737"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b'
</span><a href="#local-6989586621679040737"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b') -&gt; (a' -&gt; b) -&gt; a' -&gt; b'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a' -&gt; b) -&gt; a' -&gt; b')
-&gt; ((a -&gt; b) -&gt; a' -&gt; b) -&gt; (a -&gt; b) -&gt; a' -&gt; b'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a' -&gt; a) -&gt; a' -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621679040736"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">{-
-- Examples
f1,f1' :: Int -&gt; Int
f1 n = n + n

f1' = memo f1
-}</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="annot"><span class="hs-comment">-- | just like @void@ </span></span><span>
</span><span id="line-653"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039823"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039823"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039826"><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039823"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039826"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="V1Trie"><span class="annot"><a href="Data.MemoTrie.html#V1Trie"><span class="hs-identifier hs-var">V1Trie</span></a></span></span><span> </span><span>
</span><span id="line-655"></span><span>  </span><span id="local-6989586621679040743"><span class="annot"><span class="annottext">trie :: forall b. (V1 x -&gt; b) -&gt; V1 x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span class="annot"><span class="annottext">V1 x -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 x :-&gt;: b
forall x b. V1 x :-&gt;: b
</span><a href="Data.MemoTrie.html#V1Trie"><span class="hs-identifier hs-var">V1Trie</span></a></span><span> </span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621679040746"><span class="annot"><span class="annottext">untrie :: forall b. (V1 x :-&gt;: b) -&gt; V1 x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="annot"><span class="annottext">V1 x :-&gt;: b
R::-&gt;:V1b x b
</span><a href="Data.MemoTrie.html#V1Trie"><span class="hs-identifier hs-var">V1Trie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">V1 x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; b
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;untrie V1Trie&quot;</span></span><span>
</span><span id="line-657"></span><span>                  </span><span class="hs-comment">-- \case  -- needs EmptyCase</span><span>
</span><span id="line-658"></span><span>  </span><span id="local-6989586621679040747"><span class="annot"><span class="annottext">enumerate :: forall b. (V1 x :-&gt;: b) -&gt; [(V1 x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="annot"><span class="annottext">V1 x :-&gt;: b
R::-&gt;:V1b x b
</span><a href="Data.MemoTrie.html#V1Trie"><span class="hs-identifier hs-var">V1Trie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="annot"><span class="hs-comment">-- | just like @()@ </span></span><span>
</span><span id="line-661"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039831"><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039831"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-662"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039833"><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039831"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039833"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="U1Trie"><span class="annot"><a href="Data.MemoTrie.html#U1Trie"><span class="hs-identifier hs-var">U1Trie</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039833"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span>
</span><span id="line-663"></span><span>  </span><span id="local-6989586621679040753"><span class="annot"><span class="annottext">trie :: forall b. (U1 x -&gt; b) -&gt; U1 x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040754"><span class="annot"><span class="annottext">U1 x -&gt; b
</span><a href="#local-6989586621679040754"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; U1 x :-&gt;: b
forall x b. b -&gt; U1 x :-&gt;: b
</span><a href="Data.MemoTrie.html#U1Trie"><span class="hs-identifier hs-var">U1Trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U1 x -&gt; b
</span><a href="#local-6989586621679040754"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">U1 x
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>  </span><span id="local-6989586621679040756"><span class="annot"><span class="annottext">untrie :: forall b. (U1 x :-&gt;: b) -&gt; U1 x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#U1Trie"><span class="hs-identifier hs-type">U1Trie</span></a></span><span> </span><span id="local-6989586621679040757"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040757"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">U1 x
</span><span class="hs-identifier hs-var">U1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040757"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-665"></span><span>  </span><span id="local-6989586621679040758"><span class="annot"><span class="annottext">enumerate :: forall b. (U1 x :-&gt;: b) -&gt; [(U1 x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#U1Trie"><span class="hs-identifier hs-type">U1Trie</span></a></span><span> </span><span id="local-6989586621679040759"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040759"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">U1 x
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679040759"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="annot"><span class="hs-comment">-- | wraps @Either (f x) (g x)@ </span></span><span>
</span><span id="line-668"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039843"><span id="local-6989586621679039844"><span id="local-6989586621679039845"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039845"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039845"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039850"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039845"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039850"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EitherTrie1"><span class="annot"><a href="Data.MemoTrie.html#EitherTrie1"><span class="hs-identifier hs-var">EitherTrie1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039843"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039845"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039844"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039850"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>  </span><span id="local-6989586621679040768"><span class="annot"><span class="annottext">trie :: forall b. ((:+:) f g x -&gt; b) -&gt; (:+:) f g x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040769"><span class="annot"><span class="annottext">(:+:) f g x -&gt; b
</span><a href="#local-6989586621679040769"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either (f x) (g x) :-&gt;: b) -&gt; (:+:) f g x :-&gt;: b
forall (f :: * -&gt; *) (g :: * -&gt; *) x b.
(Either (f x) (g x) :-&gt;: b) -&gt; (:+:) f g x :-&gt;: b
</span><a href="Data.MemoTrie.html#EitherTrie1"><span class="hs-identifier hs-var">EitherTrie1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either (f x) (g x) -&gt; b) -&gt; Either (f x) (g x) :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (Either (f x) (g x) -&gt; b) -&gt; Either (f x) (g x) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(:+:) f g x -&gt; b
</span><a href="#local-6989586621679040769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((:+:) f g x -&gt; b)
-&gt; (Either (f x) (g x) -&gt; (:+:) f g x) -&gt; Either (f x) (g x) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (f x) (g x) -&gt; (:+:) f g x
forall (f :: * -&gt; *) a (g :: * -&gt; *).
Either (f a) (g a) -&gt; (:+:) f g a
</span><a href="Data.MemoTrie.html#liftSum"><span class="hs-identifier hs-var">liftSum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>  </span><span id="local-6989586621679040772"><span class="annot"><span class="annottext">untrie :: forall b. ((:+:) f g x :-&gt;: b) -&gt; (:+:) f g x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#EitherTrie1"><span class="hs-identifier hs-type">EitherTrie1</span></a></span><span> </span><span id="local-6989586621679040773"><span class="annot"><span class="annottext">Either (f x) (g x) :-&gt;: b
</span><a href="#local-6989586621679040773"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either (f x) (g x) :-&gt;: b) -&gt; Either (f x) (g x) -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (Either (f x) (g x) :-&gt;: b) -&gt; Either (f x) (g x) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">Either (f x) (g x) :-&gt;: b
</span><a href="#local-6989586621679040773"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (f x) (g x) -&gt; b)
-&gt; ((:+:) f g x -&gt; Either (f x) (g x)) -&gt; (:+:) f g x -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(:+:) f g x -&gt; Either (f x) (g x)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(:+:) f g a -&gt; Either (f a) (g a)
</span><a href="Data.MemoTrie.html#dropSum"><span class="hs-identifier hs-var">dropSum</span></a></span><span>
</span><span id="line-672"></span><span>  </span><span id="local-6989586621679040776"><span class="annot"><span class="annottext">enumerate :: forall b. ((:+:) f g x :-&gt;: b) -&gt; [((:+:) f g x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#EitherTrie1"><span class="hs-identifier hs-type">EitherTrie1</span></a></span><span> </span><span id="local-6989586621679040777"><span class="annot"><span class="annottext">Either (f x) (g x) :-&gt;: b
</span><a href="#local-6989586621679040777"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either (f x) (g x) -&gt; (:+:) f g x)
-&gt; (Either (f x) (g x) :-&gt;: b) -&gt; [((:+:) f g x, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">Either (f x) (g x) -&gt; (:+:) f g x
forall (f :: * -&gt; *) a (g :: * -&gt; *).
Either (f a) (g a) -&gt; (:+:) f g a
</span><a href="Data.MemoTrie.html#liftSum"><span class="hs-identifier hs-var">liftSum</span></a></span><span> </span><span class="annot"><span class="annottext">Either (f x) (g x) :-&gt;: b
</span><a href="#local-6989586621679040777"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><span class="hs-comment">-- | wraps @(f x, g x)@ </span></span><span>
</span><span id="line-675"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039863"><span id="local-6989586621679039864"><span id="local-6989586621679039865"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039865"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039865"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039870"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039865"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039870"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PairTrie1"><span class="annot"><a href="Data.MemoTrie.html#PairTrie1"><span class="hs-identifier hs-var">PairTrie1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039865"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039864"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039870"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>  </span><span id="local-6989586621679040786"><span class="annot"><span class="annottext">trie :: forall b. ((:*:) f g x -&gt; b) -&gt; (:*:) f g x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040787"><span class="annot"><span class="annottext">(:*:) f g x -&gt; b
</span><a href="#local-6989586621679040787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((f x, g x) :-&gt;: b) -&gt; (:*:) f g x :-&gt;: b
forall (f :: * -&gt; *) (g :: * -&gt; *) x b.
((f x, g x) :-&gt;: b) -&gt; (:*:) f g x :-&gt;: b
</span><a href="Data.MemoTrie.html#PairTrie1"><span class="hs-identifier hs-var">PairTrie1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((f x, g x) -&gt; b) -&gt; (f x, g x) :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. ((f x, g x) -&gt; b) -&gt; (f x, g x) :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(:*:) f g x -&gt; b
</span><a href="#local-6989586621679040787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((:*:) f g x -&gt; b)
-&gt; ((f x, g x) -&gt; (:*:) f g x) -&gt; (f x, g x) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(f x, g x) -&gt; (:*:) f g x
forall (f :: * -&gt; *) a (g :: * -&gt; *). (f a, g a) -&gt; (:*:) f g a
</span><a href="Data.MemoTrie.html#liftProduct"><span class="hs-identifier hs-var">liftProduct</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>  </span><span id="local-6989586621679040790"><span class="annot"><span class="annottext">untrie :: forall b. ((:*:) f g x :-&gt;: b) -&gt; (:*:) f g x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#PairTrie1"><span class="hs-identifier hs-type">PairTrie1</span></a></span><span> </span><span id="local-6989586621679040791"><span class="annot"><span class="annottext">(f x, g x) :-&gt;: b
</span><a href="#local-6989586621679040791"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((f x, g x) :-&gt;: b) -&gt; (f x, g x) -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. ((f x, g x) :-&gt;: b) -&gt; (f x, g x) -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">(f x, g x) :-&gt;: b
</span><a href="#local-6989586621679040791"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((f x, g x) -&gt; b)
-&gt; ((:*:) f g x -&gt; (f x, g x)) -&gt; (:*:) f g x -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(:*:) f g x -&gt; (f x, g x)
forall (f :: * -&gt; *) (g :: * -&gt; *) a. (:*:) f g a -&gt; (f a, g a)
</span><a href="Data.MemoTrie.html#dropProduct"><span class="hs-identifier hs-var">dropProduct</span></a></span><span> </span><span>
</span><span id="line-679"></span><span>  </span><span id="local-6989586621679040794"><span class="annot"><span class="annottext">enumerate :: forall b. ((:*:) f g x :-&gt;: b) -&gt; [((:*:) f g x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#PairTrie1"><span class="hs-identifier hs-type">PairTrie1</span></a></span><span> </span><span id="local-6989586621679040795"><span class="annot"><span class="annottext">(f x, g x) :-&gt;: b
</span><a href="#local-6989586621679040795"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((f x, g x) -&gt; (:*:) f g x)
-&gt; ((f x, g x) :-&gt;: b) -&gt; [((:*:) f g x, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">(f x, g x) -&gt; (:*:) f g x
forall (f :: * -&gt; *) a (g :: * -&gt; *). (f a, g a) -&gt; (:*:) f g a
</span><a href="Data.MemoTrie.html#liftProduct"><span class="hs-identifier hs-var">liftProduct</span></a></span><span> </span><span class="annot"><span class="annottext">(f x, g x) :-&gt;: b
</span><a href="#local-6989586621679040795"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="annot"><span class="hs-comment">-- | wraps @a@ </span></span><span>
</span><span id="line-682"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039883"><span id="local-6989586621679039884"><span id="local-6989586621679039885"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039884"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039885"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-683"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039888"><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039884"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039885"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039888"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="K1Trie"><span class="annot"><a href="Data.MemoTrie.html#K1Trie"><span class="hs-identifier hs-var">K1Trie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039883"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039888"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-684"></span><span>  </span><span id="local-6989586621679040803"><span class="annot"><span class="annottext">trie :: forall b. (K1 i a x -&gt; b) -&gt; K1 i a x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040804"><span class="annot"><span class="annottext">K1 i a x -&gt; b
</span><a href="#local-6989586621679040804"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; K1 i a x :-&gt;: b
forall i a x b. (a :-&gt;: b) -&gt; K1 i a x :-&gt;: b
</span><a href="Data.MemoTrie.html#K1Trie"><span class="hs-identifier hs-var">K1Trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">K1 i a x -&gt; b
</span><a href="#local-6989586621679040804"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(K1 i a x -&gt; b) -&gt; (a -&gt; K1 i a x) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; K1 i a x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-685"></span><span>  </span><span id="local-6989586621679040807"><span class="annot"><span class="annottext">untrie :: forall b. (K1 i a x :-&gt;: b) -&gt; K1 i a x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#K1Trie"><span class="hs-identifier hs-type">K1Trie</span></a></span><span> </span><span id="local-6989586621679040808"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040808"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679040809"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040809"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040808"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040809"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span>
</span><span id="line-686"></span><span>  </span><span id="local-6989586621679040811"><span class="annot"><span class="annottext">enumerate :: forall b. (K1 i a x :-&gt;: b) -&gt; [(K1 i a x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#K1Trie"><span class="hs-identifier hs-type">K1Trie</span></a></span><span> </span><span id="local-6989586621679040812"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040812"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; K1 i a x) -&gt; (a :-&gt;: b) -&gt; [(K1 i a x, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; K1 i a x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040812"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span class="annot"><span class="hs-comment">-- | wraps @f x@ </span></span><span>
</span><span id="line-689"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039903"><span id="local-6989586621679039904"><span id="local-6989586621679039905"><span id="local-6989586621679039906"><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039905"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039906"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679039910"><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679039905"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039906"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span id="%3A-%3E%3A"><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-var">:-&gt;:</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679039910"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="M1Trie"><span class="annot"><a href="Data.MemoTrie.html#M1Trie"><span class="hs-identifier hs-var">M1Trie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039910"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-691"></span><span>  </span><span id="local-6989586621679040820"><span class="annot"><span class="annottext">trie :: forall b. (M1 i t f x -&gt; b) -&gt; M1 i t f x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var hs-var hs-var hs-var">trie</span></a></span></span><span> </span><span id="local-6989586621679040821"><span class="annot"><span class="annottext">M1 i t f x -&gt; b
</span><a href="#local-6989586621679040821"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f x :-&gt;: b) -&gt; M1 i t f x :-&gt;: b
forall i (t :: Meta) (f :: * -&gt; *) x b.
(f x :-&gt;: b) -&gt; M1 i t f x :-&gt;: b
</span><a href="Data.MemoTrie.html#M1Trie"><span class="hs-identifier hs-var">M1Trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f x -&gt; b) -&gt; f x :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (f x -&gt; b) -&gt; f x :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M1 i t f x -&gt; b
</span><a href="#local-6989586621679040821"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(M1 i t f x -&gt; b) -&gt; (f x -&gt; M1 i t f x) -&gt; f x -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f x -&gt; M1 i t f x
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-692"></span><span>  </span><span id="local-6989586621679040824"><span class="annot"><span class="annottext">untrie :: forall b. (M1 i t f x :-&gt;: b) -&gt; M1 i t f x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var hs-var hs-var hs-var">untrie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#M1Trie"><span class="hs-identifier hs-type">M1Trie</span></a></span><span> </span><span id="local-6989586621679040825"><span class="annot"><span class="annottext">f x :-&gt;: b
</span><a href="#local-6989586621679040825"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span id="local-6989586621679040826"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679040826"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f x :-&gt;: b) -&gt; f x -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (f x :-&gt;: b) -&gt; f x -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="annot"><span class="annottext">f x :-&gt;: b
</span><a href="#local-6989586621679040825"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679040826"><span class="hs-identifier hs-var">a</span></a></span><span>  </span><span>
</span><span id="line-693"></span><span>  </span><span id="local-6989586621679040828"><span class="annot"><span class="annottext">enumerate :: forall b. (M1 i t f x :-&gt;: b) -&gt; [(M1 i t f x, b)]
</span><a href="Data.MemoTrie.html#enumerate"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#M1Trie"><span class="hs-identifier hs-type">M1Trie</span></a></span><span> </span><span id="local-6989586621679040829"><span class="annot"><span class="annottext">f x :-&gt;: b
</span><a href="#local-6989586621679040829"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f x -&gt; M1 i t f x) -&gt; (f x :-&gt;: b) -&gt; [(M1 i t f x, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; M1 i t f x
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">f x :-&gt;: b
</span><a href="#local-6989586621679040829"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-comment">-- | the data type in a __reg__ular form. </span><span>
</span><span id="line-696"></span><span class="hs-comment">-- &quot;unlifted&quot; generic representation. (i.e. is a unary type constructor). </span><span>
</span><span id="line-697"></span><span class="hs-keyword">type</span><span> </span><span id="Reg"><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-var">Reg</span></a></span></span><span> </span><span id="local-6989586621679040830"><span class="annot"><a href="#local-6989586621679040830"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679040830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="annot"><span class="hs-comment">-- | 'Generic'-friendly default for 'trie'</span></span><span>
</span><span id="line-700"></span><span id="local-6989586621679039921"><span id="local-6989586621679039923"><span class="annot"><a href="Data.MemoTrie.html#trieGeneric"><span class="hs-identifier hs-type">trieGeneric</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039923"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039923"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039923"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039921"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039923"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-704"></span><span id="trieGeneric"><span class="annot"><span class="annottext">trieGeneric :: forall a b.
(Generic a, HasTrie (Reg a)) =&gt;
((Reg a :-&gt;: b) -&gt; a :-&gt;: b) -&gt; (a -&gt; b) -&gt; a :-&gt;: b
</span><a href="Data.MemoTrie.html#trieGeneric"><span class="hs-identifier hs-var hs-var">trieGeneric</span></a></span></span><span> </span><span id="local-6989586621679040835"><span class="annot"><span class="annottext">(Reg a :-&gt;: b) -&gt; a :-&gt;: b
</span><a href="#local-6989586621679040835"><span class="hs-identifier hs-var">theConstructor</span></a></span></span><span> </span><span id="local-6989586621679040836"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679040836"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg a :-&gt;: b) -&gt; a :-&gt;: b
</span><a href="#local-6989586621679040835"><span class="hs-identifier hs-var">theConstructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Reg a -&gt; b) -&gt; Reg a :-&gt;: b
forall a b. HasTrie a =&gt; (a -&gt; b) -&gt; a :-&gt;: b
forall b. (Reg a -&gt; b) -&gt; Reg a :-&gt;: b
</span><a href="Data.MemoTrie.html#trie"><span class="hs-identifier hs-var">trie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679040836"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (Reg a -&gt; a) -&gt; Reg a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Reg a -&gt; a
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep a x -&gt; a
</span><span class="hs-identifier hs-var">to</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#trieGeneric"><span class="hs-pragma hs-type">trieGeneric</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="annot"><span class="hs-comment">-- | 'Generic'-friendly default for 'untrie'</span></span><span>
</span><span id="line-708"></span><span id="local-6989586621679039928"><span id="local-6989586621679039929"><span class="annot"><a href="Data.MemoTrie.html#untrieGeneric"><span class="hs-identifier hs-type">untrieGeneric</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039929"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039929"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039929"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039929"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-712"></span><span id="untrieGeneric"><span class="annot"><span class="annottext">untrieGeneric :: forall a b.
(Generic a, HasTrie (Reg a)) =&gt;
((a :-&gt;: b) -&gt; Reg a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; a -&gt; b
</span><a href="Data.MemoTrie.html#untrieGeneric"><span class="hs-identifier hs-var hs-var">untrieGeneric</span></a></span></span><span> </span><span id="local-6989586621679040842"><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; Reg a :-&gt;: b
</span><a href="#local-6989586621679040842"><span class="hs-identifier hs-var">theDestructor</span></a></span></span><span> </span><span id="local-6989586621679040843"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040843"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040844"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040844"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Reg a :-&gt;: b) -&gt; Reg a -&gt; b
forall a b. HasTrie a =&gt; (a :-&gt;: b) -&gt; a -&gt; b
forall b. (Reg a :-&gt;: b) -&gt; Reg a -&gt; b
</span><a href="Data.MemoTrie.html#untrie"><span class="hs-identifier hs-var">untrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; Reg a :-&gt;: b
</span><a href="#local-6989586621679040842"><span class="hs-identifier hs-var">theDestructor</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040843"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Reg a
forall x. a -&gt; Rep a x
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040844"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#untrieGeneric"><span class="hs-pragma hs-type">untrieGeneric</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="annot"><span class="hs-comment">-- | 'Generic'-friendly default for 'enumerate'</span></span><span>
</span><span id="line-716"></span><span id="local-6989586621679039933"><span id="local-6989586621679039934"><span class="annot"><a href="Data.MemoTrie.html#enumerateGeneric"><span class="hs-identifier hs-type">enumerateGeneric</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#HasTrie"><span class="hs-identifier hs-type">HasTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039934"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.MemoTrie.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039934"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.MemoTrie.html#%3A-%3E%3A"><span class="hs-operator hs-type">:-&gt;:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039934"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039933"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039934"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-720"></span><span id="enumerateGeneric"><span class="annot"><span class="annottext">enumerateGeneric :: forall a b.
(Generic a, HasTrie (Reg a)) =&gt;
((a :-&gt;: b) -&gt; Reg a :-&gt;: b) -&gt; (a :-&gt;: b) -&gt; [(a, b)]
</span><a href="Data.MemoTrie.html#enumerateGeneric"><span class="hs-identifier hs-var hs-var">enumerateGeneric</span></a></span></span><span> </span><span id="local-6989586621679040850"><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; Reg a :-&gt;: b
</span><a href="#local-6989586621679040850"><span class="hs-identifier hs-var">theDestructor</span></a></span></span><span> </span><span id="local-6989586621679040851"><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040851"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg a -&gt; a) -&gt; (Reg a :-&gt;: b) -&gt; [(a, b)]
forall a a' b. HasTrie a =&gt; (a -&gt; a') -&gt; (a :-&gt;: b) -&gt; [(a', b)]
</span><a href="Data.MemoTrie.html#enum%27"><span class="hs-identifier hs-var">enum'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg a -&gt; a
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep a x -&gt; a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a :-&gt;: b) -&gt; Reg a :-&gt;: b
</span><a href="#local-6989586621679040850"><span class="hs-identifier hs-var">theDestructor</span></a></span><span> </span><span class="annot"><span class="annottext">a :-&gt;: b
</span><a href="#local-6989586621679040851"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-721"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#enumerateGeneric"><span class="hs-pragma hs-type">enumerateGeneric</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span id="local-6989586621679039876"><span id="local-6989586621679039877"><span id="local-6989586621679039878"><span class="annot"><a href="Data.MemoTrie.html#dropProduct"><span class="hs-identifier hs-type">dropProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039876"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039877"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039876"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039877"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span>
</span><span id="line-724"></span><span id="dropProduct"><span class="annot"><span class="annottext">dropProduct :: forall (f :: * -&gt; *) (g :: * -&gt; *) a. (:*:) f g a -&gt; (f a, g a)
</span><a href="Data.MemoTrie.html#dropProduct"><span class="hs-identifier hs-var hs-var">dropProduct</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040852"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040852"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679040854"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040854"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040852"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040854"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#dropProduct"><span class="hs-pragma hs-type">dropProduct</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span id="local-6989586621679039871"><span id="local-6989586621679039872"><span id="local-6989586621679039873"><span class="annot"><a href="Data.MemoTrie.html#liftProduct"><span class="hs-identifier hs-type">liftProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039873"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039873"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span> </span><span>
</span><span id="line-728"></span><span id="liftProduct"><span class="annot"><span class="annottext">liftProduct :: forall (f :: * -&gt; *) a (g :: * -&gt; *). (f a, g a) -&gt; (:*:) f g a
</span><a href="Data.MemoTrie.html#liftProduct"><span class="hs-identifier hs-var hs-var">liftProduct</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040855"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040855"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679040856"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040856"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040855"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; g a -&gt; (:*:) f g a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040856"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-729"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#liftProduct"><span class="hs-pragma hs-type">liftProduct</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span id="local-6989586621679039856"><span id="local-6989586621679039857"><span id="local-6989586621679039858"><span class="annot"><a href="Data.MemoTrie.html#dropSum"><span class="hs-identifier hs-type">dropSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039856"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039857"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039856"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039857"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span>
</span><span id="line-732"></span><span id="dropSum"><span class="annot"><span class="annottext">dropSum :: forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(:+:) f g a -&gt; Either (f a) (g a)
</span><a href="Data.MemoTrie.html#dropSum"><span class="hs-identifier hs-var hs-var">dropSum</span></a></span></span><span> </span><span id="local-6989586621679040857"><span class="annot"><span class="annottext">(:+:) f g a
</span><a href="#local-6989586621679040857"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:+:) f g a
</span><a href="#local-6989586621679040857"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-733"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679040859"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040859"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Either (f a) (g a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679040859"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span>
</span><span id="line-734"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679040861"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040861"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g a -&gt; Either (f a) (g a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679040861"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span>
</span><span id="line-735"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#dropSum"><span class="hs-pragma hs-type">dropSum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span id="local-6989586621679039851"><span id="local-6989586621679039852"><span id="local-6989586621679039853"><span class="annot"><a href="Data.MemoTrie.html#liftSum"><span class="hs-identifier hs-type">liftSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039851"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039852"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039853"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039852"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039851"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679039853"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039852"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span> </span><span>
</span><span id="line-738"></span><span id="liftSum"><span class="annot"><span class="annottext">liftSum :: forall (f :: * -&gt; *) a (g :: * -&gt; *).
Either (f a) (g a) -&gt; (:+:) f g a
</span><a href="Data.MemoTrie.html#liftSum"><span class="hs-identifier hs-var hs-var">liftSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; (:+:) f g a)
-&gt; (g a -&gt; (:+:) f g a) -&gt; Either (f a) (g a) -&gt; (:+:) f g a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; (:+:) f g a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; (:+:) f g a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span>
</span><span id="line-739"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.MemoTrie.html#liftSum"><span class="hs-pragma hs-type">liftSum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-740"></span></pre></body></html>