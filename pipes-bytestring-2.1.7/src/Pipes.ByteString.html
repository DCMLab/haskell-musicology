<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes, Trustworthy #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-| This module provides @pipes@ utilities for \&quot;byte streams\&quot;, which are
    streams of strict 'ByteString's chunks.  Use byte streams to interact
    with both 'IO.Handle's and lazy 'ByteString's.

    To stream to or from 'IO.Handle's, use 'fromHandle' or 'toHandle'.  For
    example, the following program copies data from one file to another:

&gt; import Pipes
&gt; import qualified Pipes.ByteString as P
&gt; import System.IO
&gt;
&gt; main =
&gt;     withFile &quot;inFile.txt&quot;  ReadMode  $ \hIn  -&gt;
&gt;     withFile &quot;outFile.txt&quot; WriteMode $ \hOut -&gt;
&gt;     runEffect $ P.fromHandle hIn &gt;-&gt; P.toHandle hOut

    You can stream to and from 'stdin' and 'stdout' using the predefined 'stdin'
    and 'stdout' pipes, like in the following \&quot;echo\&quot; program:

&gt; main = runEffect $ P.stdin &gt;-&gt; P.stdout

    You can also translate pure lazy 'BL.ByteString's to and from pipes:

&gt; import qualified Data.ByteString.Lazy.Char8 as BL
&gt;
&gt; main = runEffect $ P.fromLazy (BL.pack &quot;Hello, world!\n&quot;) &gt;-&gt; P.stdout

    In addition, this module provides many functions equivalent to lazy
    'ByteString' functions so that you can transform or fold byte streams.  For
    example, to stream only the first three lines of 'stdin' to 'stdout' you
    would write:

&gt; import Lens.Family (over)
&gt; import Pipes
&gt; import qualified Pipes.ByteString as PB
&gt; import Pipes.Group (takes)
&gt;
&gt; main = runEffect $ over PB.lines (takes 3) PB.stdin &gt;-&gt; PB.stdout

    The above program will never bring more than one chunk (~ 32 KB) into
    memory, no matter how long the lines are.

    Note that functions in this library are designed to operate on streams that
    are insensitive to chunk boundaries.  This means that they may freely split
    chunks into smaller chunks and /discard empty chunks/.  However, they will
    /never concatenate chunks/ in order to provide strict upper bounds on memory
    usage.
-}</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pipes.ByteString</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Producers</span></span><span>
</span><span id="line-54"></span><span>      </span><span class="annot"><a href="Pipes.ByteString.html#fromLazy"><span class="hs-identifier">fromLazy</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#stdin"><span class="hs-identifier">stdin</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#fromHandle"><span class="hs-identifier">fromHandle</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetSome"><span class="hs-identifier">hGetSome</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetNonBlocking"><span class="hs-identifier">hGetNonBlocking</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGet"><span class="hs-identifier">hGet</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetRange"><span class="hs-identifier">hGetRange</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Servers</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetSomeN"><span class="hs-identifier">hGetSomeN</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetN"><span class="hs-identifier">hGetN</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Consumers</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#stdout"><span class="hs-identifier">stdout</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toHandle"><span class="hs-identifier">toHandle</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Pipes</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#map"><span class="hs-identifier">map</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#concatMap"><span class="hs-identifier">concatMap</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#take"><span class="hs-identifier">take</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#filter"><span class="hs-identifier">filter</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elemIndices"><span class="hs-identifier">elemIndices</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#findIndices"><span class="hs-identifier">findIndices</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#scan"><span class="hs-identifier">scan</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Folds</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazy"><span class="hs-identifier">toLazy</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazyM"><span class="hs-identifier">toLazyM</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazyM%27"><span class="hs-identifier">toLazyM'</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#foldBytes"><span class="hs-identifier">foldBytes</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#head"><span class="hs-identifier">head</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#last"><span class="hs-identifier">last</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#null"><span class="hs-identifier">null</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#length"><span class="hs-identifier">length</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#any"><span class="hs-identifier">any</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#all"><span class="hs-identifier">all</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#maximum"><span class="hs-identifier">maximum</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#minimum"><span class="hs-identifier">minimum</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elem"><span class="hs-identifier">elem</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#notElem"><span class="hs-identifier">notElem</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#find"><span class="hs-identifier">find</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#index"><span class="hs-identifier">index</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elemIndex"><span class="hs-identifier">elemIndex</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#findIndex"><span class="hs-identifier">findIndex</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#count"><span class="hs-identifier">count</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parsing</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="hs-comment">-- $parse</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier">nextByte</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#drawByte"><span class="hs-identifier">drawByte</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unDrawByte"><span class="hs-identifier">unDrawByte</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#peekByte"><span class="hs-identifier">peekByte</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#isEndOfBytes"><span class="hs-identifier">isEndOfBytes</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parsing Lenses</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitAt"><span class="hs-identifier">splitAt</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#span"><span class="hs-identifier">span</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#break"><span class="hs-identifier">break</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#breakOn"><span class="hs-identifier">breakOn</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#group"><span class="hs-identifier">group</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#word"><span class="hs-identifier">word</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#line"><span class="hs-identifier">line</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Transforming Byte Streams</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#drop"><span class="hs-identifier">drop</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#intersperse"><span class="hs-identifier">intersperse</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#pack"><span class="hs-identifier">pack</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unpack"><span class="hs-identifier">unpack</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#chunksOf%27"><span class="hs-identifier">chunksOf'</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="hs-comment">-- * FreeT Transformations</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#chunksOf"><span class="hs-identifier">chunksOf</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitsWith"><span class="hs-identifier">splitsWith</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splits"><span class="hs-identifier">splits</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitOn"><span class="hs-identifier">splitOn</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groupsBy"><span class="hs-identifier">groupsBy</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groups"><span class="hs-identifier">groups</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#lines"><span class="hs-identifier">lines</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unlines"><span class="hs-identifier">unlines</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#words"><span class="hs-identifier">words</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unwords"><span class="hs-identifier">unwords</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="hs-comment">-- $reexports</span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Group</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Parse</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">try</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isSpaceWord8</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Search</span></span><span>
</span><span id="line-156"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldrChunks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">defaultChunkSize</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeTake</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Constant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constant</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constant</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getConstant</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Errno</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Errno</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ePIPE</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.IO.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-166"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pipes</span></span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Core</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">respond</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Server'</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Group</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-169"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">concats</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intercalates</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FreeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Parse</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Parse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-173"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-174"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="hs-identifier">all</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">any</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">break</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">drop</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dropWhile</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filter</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">head</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">last</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lines</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">map</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maximum</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">minimum</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">notElem</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">span</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">splitAt</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">take</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">takeWhile</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unlines</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unwords</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">words</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Convert a lazy 'BL.ByteString' into a 'Producer' of strict 'ByteString's</span><span>
</span><span id="line-202"></span><span id="local-6989586621679060296"><span class="annot"><a href="Pipes.ByteString.html#fromLazy"><span class="hs-identifier hs-type">fromLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-203"></span><span id="fromLazy"><span class="annot"><span class="annottext">fromLazy :: ByteString -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#fromLazy"><span class="hs-identifier hs-var hs-var">fromLazy</span></a></span></span><span> </span><span id="local-6989586621679060295"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060295"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; Proxy x' x () ByteString m () -&gt; Proxy x' x () ByteString m ())
-&gt; Proxy x' x () ByteString m ()
-&gt; ByteString
-&gt; Proxy x' x () ByteString m ()
forall a. (ByteString -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">foldrChunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060294"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060294"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679060293"><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060293"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060294"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
-&gt; Proxy x' x () ByteString m () -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060293"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060295"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-204"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#fromLazy"><span class="hs-pragma hs-type">fromLazy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Stream bytes from 'stdin'</span><span>
</span><span id="line-207"></span><span id="local-6989586621679060291"><span class="annot"><a href="Pipes.ByteString.html#stdin"><span class="hs-identifier hs-type">stdin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060291"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060291"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span id="stdin"><span class="annot"><span class="annottext">stdin :: Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#stdin"><span class="hs-identifier hs-var hs-var">stdin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Producer' ByteString m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#fromHandle"><span class="hs-identifier hs-var">fromHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">IO.stdin</span></span><span>
</span><span id="line-209"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#stdin"><span class="hs-pragma hs-type">stdin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Convert a 'IO.Handle' into a byte stream using a default chunk size</span><span>
</span><span id="line-212"></span><span id="local-6989586621679060834"><span class="annot"><a href="Pipes.ByteString.html#fromHandle"><span class="hs-identifier hs-type">fromHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span id="fromHandle"><span class="annot"><span class="annottext">fromHandle :: Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#fromHandle"><span class="hs-identifier hs-var hs-var">fromHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Handle -&gt; Producer' ByteString m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGetSome"><span class="hs-identifier hs-var">hGetSome</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier hs-var">defaultChunkSize</span></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- TODO: Test chunk size for performance</span><span>
</span><span id="line-215"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#fromHandle"><span class="hs-pragma hs-type">fromHandle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">{-| Convert a handle into a byte stream using a maximum chunk size

    'hGetSome' forwards input immediately as it becomes available, splitting the
    input into multiple chunks if it exceeds the maximum chunk size.
-}</span><span>
</span><span id="line-222"></span><span id="local-6989586621679060829"><span class="annot"><a href="Pipes.ByteString.html#hGetSome"><span class="hs-identifier hs-type">hGetSome</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060829"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060829"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-223"></span><span id="hGetSome"><span class="annot"><span class="annottext">hGetSome :: Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGetSome"><span class="hs-identifier hs-var hs-var">hGetSome</span></a></span></span><span> </span><span id="local-6989586621679060289"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060289"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679060288"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060288"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
Producer' ByteString m ()
</span><a href="#local-6989586621679060287"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679060287"><span class="annot"><span class="annottext">go :: Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060287"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>        </span><span id="local-6989586621679060286"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060286"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Proxy x' x () ByteString m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ByteString
</span><span class="hs-identifier hs-var">BS.hGetSome</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060288"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060289"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060286"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060286"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-231"></span><span>                </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060287"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-232"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetSome"><span class="hs-pragma hs-type">hGetSome</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">{-| Convert a handle into a byte stream using a fixed chunk size

    Similar to 'hGet' except that it will never block waiting for data
    to become available.
-}</span><span>
</span><span id="line-239"></span><span id="local-6989586621679060282"><span class="annot"><a href="Pipes.ByteString.html#hGetNonBlocking"><span class="hs-identifier hs-type">hGetNonBlocking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060282"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060282"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-240"></span><span id="hGetNonBlocking"><span class="annot"><span class="annottext">hGetNonBlocking :: Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGetNonBlocking"><span class="hs-identifier hs-var hs-var">hGetNonBlocking</span></a></span></span><span> </span><span id="local-6989586621679060281"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060281"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679060280"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060280"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
Producer' ByteString m ()
</span><a href="#local-6989586621679060279"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679060279"><span class="annot"><span class="annottext">go :: Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060279"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>        </span><span id="local-6989586621679060278"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060278"><span class="hs-identifier hs-var">eof</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Proxy x' x () ByteString m Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">IO.hIsEOF</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060280"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679060278"><span class="hs-identifier hs-var">eof</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>                </span><span id="local-6989586621679060276"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060276"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Proxy x' x () ByteString m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ByteString
</span><span class="hs-identifier hs-var">BS.hGetNonBlocking</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060280"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060281"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060276"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-248"></span><span>                </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060279"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-249"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetNonBlocking"><span class="hs-pragma hs-type">hGetNonBlocking</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">{-| Convert a handle into a byte stream using a fixed chunk size

    'hGet' waits until exactly the requested number of bytes are available for
    each chunk.
-}</span><span>
</span><span id="line-256"></span><span id="local-6989586621679060274"><span class="annot"><a href="Pipes.ByteString.html#hGet"><span class="hs-identifier hs-type">hGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060274"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060274"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-257"></span><span id="hGet"><span class="annot"><span class="annottext">hGet :: Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGet"><span class="hs-identifier hs-var hs-var">hGet</span></a></span></span><span> </span><span id="local-6989586621679060273"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060273"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679060272"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060272"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
Producer' ByteString m ()
</span><a href="#local-6989586621679060271"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679060271"><span class="annot"><span class="annottext">go :: Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060271"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679060270"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060270"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Proxy x' x () ByteString m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ByteString
</span><span class="hs-identifier hs-var">BS.hGet</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060272"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060273"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060270"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060270"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m ()
</span><a href="#local-6989586621679060271"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-266"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGet"><span class="hs-pragma hs-type">hGet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">{-| Like 'hGet' but with an extra parameter specifying an initial handle offset
-}</span><span>
</span><span id="line-270"></span><span id="local-6989586621679060268"><span class="annot"><a href="Pipes.ByteString.html#hGetRange"><span class="hs-identifier hs-type">hGetRange</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060268"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Offset</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Size</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060268"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-276"></span><span id="hGetRange"><span class="annot"><span class="annottext">hGetRange :: Int -&gt; Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGetRange"><span class="hs-identifier hs-var hs-var">hGetRange</span></a></span></span><span> </span><span id="local-6989586621679060267"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060267"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span id="local-6989586621679060266"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060266"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679060265"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060265"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Proxy x' x () ByteString m ())
-&gt; IO () -&gt; Proxy x' x () ByteString m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; SeekMode -&gt; Integer -&gt; IO ()
</span><span class="hs-identifier hs-var">IO.hSeek</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060265"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">SeekMode
</span><span class="hs-identifier hs-var">IO.AbsoluteSeek</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060267"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Handle -&gt; Producer' ByteString m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
Int -&gt; Handle -&gt; Producer' ByteString m ()
</span><a href="Pipes.ByteString.html#hGet"><span class="hs-identifier hs-var">hGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060266"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060265"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-279"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetRange"><span class="hs-pragma hs-type">hGetRange</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span id="local-6989586621679060556"><span id="local-6989586621679060557"><span class="annot"><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-type">(^.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679060557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060556"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constant</span></span><span> </span><span class="annot"><a href="#local-6989586621679060556"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060556"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constant</span></span><span> </span><span class="annot"><a href="#local-6989586621679060556"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060557"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060556"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-282"></span><span id="local-6989586621679060261"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060261"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%5E."><span class="annot"><span class="annottext">^. :: a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var hs-var">^.</span></a></span></span><span> </span><span id="local-6989586621679060260"><span class="annot"><span class="annottext">(b -&gt; Constant b b) -&gt; a -&gt; Constant b a
</span><a href="#local-6989586621679060260"><span class="hs-identifier hs-var">lens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constant b a -&gt; b
forall a k (b :: k). Constant a b -&gt; a
</span><span class="hs-identifier hs-var hs-var">getConstant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Constant b b) -&gt; a -&gt; Constant b a
</span><a href="#local-6989586621679060260"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Constant b b
forall k a (b :: k). a -&gt; Constant a b
</span><span class="hs-identifier hs-var">Constant</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060261"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">{-| Like 'hGetSome', except you can vary the maximum chunk size for each request
-}</span><span>
</span><span id="line-286"></span><span id="local-6989586621679060259"><span class="annot"><a href="Pipes.ByteString.html#hGetSomeN"><span class="hs-identifier hs-type">hGetSomeN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060259"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060259"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-287"></span><span id="hGetSomeN"><span class="annot"><span class="annottext">hGetSomeN :: Handle -&gt; Int -&gt; Server' Int ByteString m ()
</span><a href="Pipes.ByteString.html#hGetSomeN"><span class="hs-identifier hs-var hs-var">hGetSomeN</span></a></span></span><span> </span><span id="local-6989586621679060258"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060258"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679060257"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060257"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Proxy x' x Int ByteString m ()
forall (m :: * -&gt; *) x' x.
MonadIO m =&gt;
Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060257"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679060256"><span class="annot"><span class="annottext">go :: Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060256"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060255"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060255"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679060254"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060254"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Proxy x' x Int ByteString m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ByteString
</span><span class="hs-identifier hs-var">BS.hGetSome</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060258"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060255"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060254"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy x' x Int ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>                </span><span id="local-6989586621679060253"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060253"><span class="hs-identifier hs-var">size2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x Int ByteString m Int
forall (m :: * -&gt; *) a x' x a'.
Functor m =&gt;
a -&gt; Proxy x' x a' a m a'
</span><span class="hs-identifier hs-var">respond</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060254"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-295"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060253"><span class="hs-identifier hs-var">size2</span></a></span><span>
</span><span id="line-296"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetSomeN"><span class="hs-pragma hs-type">hGetSomeN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Like 'hGet', except you can vary the chunk size for each request</span><span>
</span><span id="line-299"></span><span id="local-6989586621679060252"><span class="annot"><a href="Pipes.ByteString.html#hGetN"><span class="hs-identifier hs-type">hGetN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060252"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060252"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-300"></span><span id="hGetN"><span class="annot"><span class="annottext">hGetN :: Handle -&gt; Int -&gt; Server' Int ByteString m ()
</span><a href="Pipes.ByteString.html#hGetN"><span class="hs-identifier hs-var hs-var">hGetN</span></a></span></span><span> </span><span id="local-6989586621679060251"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060251"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679060250"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Proxy x' x Int ByteString m ()
forall (m :: * -&gt; *) x' x.
MonadIO m =&gt;
Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679060249"><span class="annot"><span class="annottext">go :: Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060248"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060248"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621679060247"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Proxy x' x Int ByteString m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ByteString
</span><span class="hs-identifier hs-var">BS.hGet</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060251"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060248"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy x' x Int ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>                </span><span id="local-6989586621679060246"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">size2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x Int ByteString m Int
forall (m :: * -&gt; *) a x' x a'.
Functor m =&gt;
a -&gt; Proxy x' x a' a m a'
</span><span class="hs-identifier hs-var">respond</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-308"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Proxy x' x Int ByteString m ()
</span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">size2</span></a></span><span>
</span><span id="line-309"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#hGetN"><span class="hs-pragma hs-type">hGetN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">{-| Stream bytes to 'stdout'

    Unlike 'toHandle', 'stdout' gracefully terminates on a broken output pipe.
-}</span><span>
</span><span id="line-315"></span><span id="local-6989586621679060245"><span class="annot"><a href="Pipes.ByteString.html#stdout"><span class="hs-identifier hs-type">stdout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Consumer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-316"></span><span id="stdout"><span class="annot"><span class="annottext">stdout :: Consumer' ByteString m ()
</span><a href="Pipes.ByteString.html#stdout"><span class="hs-identifier hs-var hs-var">stdout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString y' y m ()
Consumer' ByteString m ()
</span><a href="#local-6989586621679060244"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679060244"><span class="annot"><span class="annottext">go :: Proxy () ByteString y' y m ()
</span><a href="#local-6989586621679060244"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621679060243"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060243"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString y' y m ByteString
forall (m :: * -&gt; *) a. Functor m =&gt; Consumer' a m a
</span><span class="hs-identifier hs-var">await</span></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621679060241"><span class="annot"><span class="annottext">Either IOException ()
</span><a href="#local-6989586621679060241"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either IOException ())
-&gt; Proxy () ByteString y' y m (Either IOException ())
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either IOException ())
 -&gt; Proxy () ByteString y' y m (Either IOException ()))
-&gt; IO (Either IOException ())
-&gt; Proxy () ByteString y' y m (Either IOException ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Either IOException ())
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">BS.putStr</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060243"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException ()
</span><a href="#local-6989586621679060241"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.IOError</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ioe_type :: IOException -&gt; IOErrorType
</span><span class="hs-identifier hs-var">G.ioe_type</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><span class="hs-identifier hs-var">G.ResourceVanished</span></span><span>
</span><span id="line-323"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ioe_errno :: IOException -&gt; Maybe CInt
</span><span class="hs-identifier hs-var">G.ioe_errno</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060235"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679060235"><span class="hs-identifier hs-var">ioe</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Errno
</span><span class="hs-identifier hs-var">Errno</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679060235"><span class="hs-identifier hs-var">ioe</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">ePIPE</span></span><span>
</span><span id="line-325"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy () ByteString y' y m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679060234"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679060234"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Proxy () ByteString y' y m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679060234"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString y' y m ()
</span><a href="#local-6989586621679060244"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-328"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#stdout"><span class="hs-pragma hs-type">stdout</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">{-| Convert a byte stream into a 'Handle'

&gt; p &gt;-&gt; toHandle handle = for p (liftIO . hPutStr handle)
-}</span><span>
</span><span id="line-334"></span><span id="local-6989586621679060232"><span id="local-6989586621679060233"><span class="annot"><a href="Pipes.ByteString.html#toHandle"><span class="hs-identifier hs-type">toHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679060233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Consumer'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060232"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-335"></span><span id="toHandle"><span class="annot"><span class="annottext">toHandle :: Handle -&gt; Consumer' ByteString m r
</span><a href="Pipes.ByteString.html#toHandle"><span class="hs-identifier hs-var hs-var">toHandle</span></a></span></span><span> </span><span id="local-6989586621679060231"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060231"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () ByteString m r
-&gt; (ByteString -&gt; Proxy () ByteString y' y m ())
-&gt; Proxy () ByteString y' y m r
forall (m :: * -&gt; *) x' x b' b a' c' c.
Functor m =&gt;
Proxy x' x b' b m a'
-&gt; (b -&gt; Proxy x' x c' c m b') -&gt; Proxy x' x c' c m a'
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () ByteString m r
forall (m :: * -&gt; *) a r. Functor m =&gt; Pipe a a m r
</span><span class="hs-identifier hs-var">cat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; Proxy () ByteString y' y m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Proxy () ByteString y' y m ())
-&gt; (ByteString -&gt; IO ())
-&gt; ByteString
-&gt; Proxy () ByteString y' y m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">BS.hPut</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679060231"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toHandle"><span class="hs-pragma hs-type">toHandle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;p &gt;-&gt; toHandle h&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679060226"><span class="annot"><a href="#local-6989586621679060226"><span class="hs-pragma hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679060225"><span class="annot"><a href="#local-6989586621679060225"><span class="hs-pragma hs-var">h</span></a></span></span><span> </span><span class="hs-pragma">.</span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><a href="#local-6989586621679060226"><span class="hs-pragma hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">&gt;-&gt;</span></span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toHandle"><span class="hs-pragma hs-type">toHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060225"><span class="hs-pragma hs-type">h</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621679060226"><span class="hs-pragma hs-type">p</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span id="local-6989586621679060223"><span class="annot"><a href="#local-6989586621679060223"><span class="hs-pragma hs-var">bs</span></a></span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">liftIO</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">BS.hPut</span></span><span> </span><span class="annot"><a href="#local-6989586621679060225"><span class="hs-pragma hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060223"><span class="hs-pragma hs-type">bs</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Apply a transformation to each 'Word8' in the stream</span><span>
</span><span id="line-343"></span><span id="local-6989586621679060221"><span id="local-6989586621679060222"><span class="annot"><a href="Pipes.ByteString.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060222"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060222"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060221"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-344"></span><span id="map"><span class="annot"><span class="annottext">map :: (Word8 -&gt; Word8) -&gt; Pipe ByteString ByteString m r
</span><a href="Pipes.ByteString.html#map"><span class="hs-identifier hs-var hs-var">map</span></a></span></span><span> </span><span id="local-6989586621679060220"><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="#local-6989586621679060220"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; Pipe ByteString ByteString m r
forall (m :: * -&gt; *) a b r. Functor m =&gt; (a -&gt; b) -&gt; Pipe a b m r
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.map</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="#local-6989586621679060220"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#map"><span class="hs-pragma hs-type">map</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- | Map a function over the byte stream and concatenate the results</span><span>
</span><span id="line-348"></span><span id="local-6989586621679060216"><span id="local-6989586621679060217"><span class="annot"><a href="Pipes.ByteString.html#concatMap"><span class="hs-identifier hs-type">concatMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060217"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060217"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060216"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-349"></span><span id="concatMap"><span class="annot"><span class="annottext">concatMap :: (Word8 -&gt; ByteString) -&gt; Pipe ByteString ByteString m r
</span><a href="Pipes.ByteString.html#concatMap"><span class="hs-identifier hs-var hs-var">concatMap</span></a></span></span><span> </span><span id="local-6989586621679060215"><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><a href="#local-6989586621679060215"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; Pipe ByteString ByteString m r
forall (m :: * -&gt; *) a b r. Functor m =&gt; (a -&gt; b) -&gt; Pipe a b m r
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; ByteString) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concatMap</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><a href="#local-6989586621679060215"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#concatMap"><span class="hs-pragma hs-type">concatMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | @(take n)@ only allows @n@ bytes to pass</span><span>
</span><span id="line-353"></span><span id="local-6989586621679060212"><span id="local-6989586621679060213"><span class="annot"><a href="Pipes.ByteString.html#take"><span class="hs-identifier hs-type">take</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060213"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679060212"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060212"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060213"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-354"></span><span id="take"><span class="annot"><span class="annottext">take :: n -&gt; Pipe ByteString ByteString m ()
</span><a href="Pipes.ByteString.html#take"><span class="hs-identifier hs-var hs-var">take</span></a></span></span><span> </span><span id="local-6989586621679060211"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060211"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Pipe ByteString ByteString m ()
forall t (m :: * -&gt; *).
(Functor m, Integral t) =&gt;
t -&gt; Proxy () ByteString () ByteString m ()
</span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060211"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679060210"><span class="annot"><span class="annottext">go :: t -&gt; Proxy () ByteString () ByteString m ()
</span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060209"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>            </span><span id="local-6989586621679060207"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060207"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () ByteString m ByteString
forall (m :: * -&gt; *) a. Functor m =&gt; Consumer' a m a
</span><span class="hs-identifier hs-var">await</span></span><span>
</span><span id="line-359"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060206"><span class="annot"><span class="annottext">len :: t
</span><a href="#local-6989586621679060206"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; t
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060207"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060206"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">unsafeTake</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060207"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-363"></span><span>                    </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060207"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-364"></span><span>                    </span><span class="annot"><span class="annottext">t -&gt; Proxy () ByteString () ByteString m ()
</span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060206"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#take"><span class="hs-pragma hs-type">take</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Take bytes until they fail the predicate</span><span>
</span><span id="line-368"></span><span id="local-6989586621679060203"><span class="annot"><a href="Pipes.ByteString.html#takeWhile"><span class="hs-identifier hs-type">takeWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060203"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060203"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-369"></span><span id="takeWhile"><span class="annot"><span class="annottext">takeWhile :: (Word8 -&gt; Bool) -&gt; Pipe ByteString ByteString m ()
</span><a href="Pipes.ByteString.html#takeWhile"><span class="hs-identifier hs-var hs-var">takeWhile</span></a></span></span><span> </span><span id="local-6989586621679060202"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pipe ByteString ByteString m ()
</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679060201"><span class="annot"><span class="annottext">go :: Pipe ByteString ByteString m ()
</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>        </span><span id="local-6989586621679060200"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () ByteString m ByteString
forall (m :: * -&gt; *) a. Functor m =&gt; Consumer' a m a
</span><span class="hs-identifier hs-var">await</span></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060199"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060198"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060198"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.span</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060198"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Pipe ByteString ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-377"></span><span>                </span><span class="annot"><span class="annottext">Pipe ByteString ByteString m ()
</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Pipe ByteString ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-379"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Only allows 'Word8's to pass if they satisfy the predicate</span><span>
</span><span id="line-382"></span><span id="local-6989586621679060643"><span id="local-6989586621679060644"><span class="annot"><a href="Pipes.ByteString.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060643"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-383"></span><span id="filter"><span class="annot"><span class="annottext">filter :: (Word8 -&gt; Bool) -&gt; Pipe ByteString ByteString m r
</span><a href="Pipes.ByteString.html#filter"><span class="hs-identifier hs-var hs-var">filter</span></a></span></span><span> </span><span id="local-6989586621679060196"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060196"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; Pipe ByteString ByteString m r
forall (m :: * -&gt; *) a b r. Functor m =&gt; (a -&gt; b) -&gt; Pipe a b m r
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.filter</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060196"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#filter"><span class="hs-pragma hs-type">filter</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Stream all indices whose elements match the given 'Word8'</span><span>
</span><span id="line-387"></span><span id="local-6989586621679060192"><span id="local-6989586621679060193"><span id="local-6989586621679060194"><span class="annot"><a href="Pipes.ByteString.html#elemIndices"><span class="hs-identifier hs-type">elemIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060194"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060193"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060193"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060194"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060192"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-388"></span><span id="elemIndices"><span class="annot"><span class="annottext">elemIndices :: Word8 -&gt; Pipe ByteString n m r
</span><a href="Pipes.ByteString.html#elemIndices"><span class="hs-identifier hs-var hs-var">elemIndices</span></a></span></span><span> </span><span id="local-6989586621679060191"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060191"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Pipe ByteString n m r
forall (m :: * -&gt; *) n r.
(Monad m, Num n) =&gt;
(Word8 -&gt; Bool) -&gt; Pipe ByteString n m r
</span><a href="Pipes.ByteString.html#findIndices"><span class="hs-identifier hs-var">findIndices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060191"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elemIndices"><span class="hs-pragma hs-type">elemIndices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Stream all indices whose elements satisfy the given predicate</span><span>
</span><span id="line-392"></span><span id="local-6989586621679060716"><span id="local-6989586621679060717"><span id="local-6989586621679060718"><span class="annot"><a href="Pipes.ByteString.html#findIndices"><span class="hs-identifier hs-type">findIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060718"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060717"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060717"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060718"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060716"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-393"></span><span id="findIndices"><span class="annot"><span class="annottext">findIndices :: (Word8 -&gt; Bool) -&gt; Pipe ByteString n m r
</span><a href="Pipes.ByteString.html#findIndices"><span class="hs-identifier hs-var hs-var">findIndices</span></a></span></span><span> </span><span id="local-6989586621679060190"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060190"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Pipe ByteString n m r
forall (m :: * -&gt; *) a b.
(Functor m, Num a) =&gt;
a -&gt; Proxy () ByteString () a m b
</span><a href="#local-6989586621679060189"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679060189"><span class="annot"><span class="annottext">go :: a -&gt; Proxy () ByteString () a m b
</span><a href="#local-6989586621679060189"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060188"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>        </span><span id="local-6989586621679060187"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () a m ByteString
forall (m :: * -&gt; *) a. Functor m =&gt; Consumer' a m a
</span><span class="hs-identifier hs-var">await</span></span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><span class="annottext">[a] -&gt; Proxy () ByteString () a m ()
forall (m :: * -&gt; *) (f :: * -&gt; *) a x' x.
(Functor m, Foldable f) =&gt;
f a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Proxy () ByteString () a m ())
-&gt; [a] -&gt; Proxy () ByteString () a m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; [Int] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060185"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060185"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060185"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; [Int]
</span><span class="hs-identifier hs-var">BS.findIndices</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060190"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Proxy () ByteString () a m b
</span><a href="#local-6989586621679060189"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Proxy () ByteString () a m b)
-&gt; a -&gt; Proxy () ByteString () a m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#findIndices"><span class="hs-pragma hs-type">findIndices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Strict left scan over the bytes</span><span>
</span><span id="line-402"></span><span id="local-6989586621679060180"><span id="local-6989586621679060181"><span class="annot"><a href="Pipes.ByteString.html#scan"><span class="hs-identifier hs-type">scan</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060181"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pipe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060181"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060180"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-405"></span><span id="scan"><span class="annot"><span class="annottext">scan :: (Word8 -&gt; Word8 -&gt; Word8)
-&gt; Word8 -&gt; Pipe ByteString ByteString m r
</span><a href="Pipes.ByteString.html#scan"><span class="hs-identifier hs-var hs-var">scan</span></a></span></span><span> </span><span id="local-6989586621679060179"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679060179"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679060178"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060178"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060178"><span class="hs-identifier hs-var">begin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">Word8 -&gt; Pipe ByteString ByteString m r
forall (m :: * -&gt; *) b.
Functor m =&gt;
Word8 -&gt; Proxy () ByteString () ByteString m b
</span><a href="#local-6989586621679060176"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060178"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679060176"><span class="annot"><span class="annottext">go :: Word8 -&gt; Proxy () ByteString () ByteString m b
</span><a href="#local-6989586621679060176"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060175"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060175"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621679060174"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060174"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy () ByteString () ByteString m ByteString
forall (m :: * -&gt; *) a. Functor m =&gt; Consumer' a m a
</span><span class="hs-identifier hs-var">await</span></span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060173"><span class="annot"><span class="annottext">bs' :: ByteString
</span><a href="#local-6989586621679060173"><span class="hs-identifier hs-var hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.scanl</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679060179"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060175"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060174"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span id="local-6989586621679060171"><span class="annot"><span class="annottext">w8' :: Word8
</span><a href="#local-6989586621679060171"><span class="hs-identifier hs-var hs-var">w8'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.last</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060173"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.tail</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060173"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">Word8 -&gt; Proxy () ByteString () ByteString m b
</span><a href="#local-6989586621679060176"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060171"><span class="hs-identifier hs-var">w8'</span></a></span><span>
</span><span id="line-415"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#scan"><span class="hs-pragma hs-type">scan</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">{-| Fold a pure 'Producer' of strict 'ByteString's into a lazy
    'BL.ByteString'
-}</span><span>
</span><span id="line-420"></span><span class="annot"><a href="Pipes.ByteString.html#toLazy"><span class="hs-identifier hs-type">toLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span>
</span><span id="line-421"></span><span id="toLazy"><span class="annot"><span class="annottext">toLazy :: Producer ByteString Identity () -&gt; ByteString
</span><a href="Pipes.ByteString.html#toLazy"><span class="hs-identifier hs-var hs-var">toLazy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (Producer ByteString Identity () -&gt; [ByteString])
-&gt; Producer ByteString Identity ()
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString Identity () -&gt; [ByteString]
forall a. Producer a Identity () -&gt; [a]
</span><span class="hs-identifier hs-var">P.toList</span></span><span>
</span><span id="line-422"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazy"><span class="hs-pragma hs-type">toLazy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-comment">{-| Fold an effectful 'Producer' of strict 'ByteString's into a lazy
    'BL.ByteString'

    Note: 'toLazyM' is not an idiomatic use of @pipes@, but I provide it for
    simple testing purposes.  Idiomatic @pipes@ style consumes the chunks
    immediately as they are generated instead of loading them all into memory.
-}</span><span>
</span><span id="line-431"></span><span id="local-6989586621679060166"><span class="annot"><a href="Pipes.ByteString.html#toLazyM"><span class="hs-identifier hs-type">toLazyM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span></span><span>
</span><span id="line-432"></span><span id="toLazyM"><span class="annot"><span class="annottext">toLazyM :: Producer ByteString m () -&gt; m ByteString
</span><a href="Pipes.ByteString.html#toLazyM"><span class="hs-identifier hs-var hs-var">toLazyM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; m [ByteString] -&gt; m ByteString
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">(m [ByteString] -&gt; m ByteString)
-&gt; (Producer ByteString m () -&gt; m [ByteString])
-&gt; Producer ByteString m ()
-&gt; m ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m () -&gt; m [ByteString]
forall (m :: * -&gt; *) a. Monad m =&gt; Producer a m () -&gt; m [a]
</span><span class="hs-identifier hs-var">P.toListM</span></span><span>
</span><span id="line-433"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazyM"><span class="hs-pragma hs-type">toLazyM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">{-| Fold an effectful 'Producer' of strict 'ByteString's into a lazy
    'BL.ByteString' alongside the return value

    Note: 'toLazyM'' is not an idiomatic use of @pipes@, but I provide it for
    simple testing purposes.  Idiomatic @pipes@ style consumes the chunks
    immediately as they are generated instead of loading them all into memory.
-}</span><span>
</span><span id="line-442"></span><span id="local-6989586621679060163"><span id="local-6989586621679060164"><span class="annot"><a href="Pipes.ByteString.html#toLazyM%27"><span class="hs-identifier hs-type">toLazyM'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060163"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679060163"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-443"></span><span id="toLazyM%27"><span class="annot"><span class="annottext">toLazyM' :: Producer ByteString m a -&gt; m (ByteString, a)
</span><a href="Pipes.ByteString.html#toLazyM%27"><span class="hs-identifier hs-var hs-var">toLazyM'</span></a></span></span><span> </span><span id="local-6989586621679060162"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679060162"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060161"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679060161"><span class="hs-identifier hs-var">chunks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060160"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060160"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a -&gt; m ([ByteString], a)
forall (m :: * -&gt; *) a r. Monad m =&gt; Producer a m r -&gt; m ([a], r)
</span><span class="hs-identifier hs-var">P.toListM'</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679060162"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-444"></span><span>                </span><span class="annot"><span class="annottext">(ByteString, a) -&gt; m (ByteString, a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679060161"><span class="hs-identifier hs-var">chunks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679060160"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#toLazyM%27"><span class="hs-pragma hs-type">toLazyM'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">{-| Reduce the stream of bytes using a strict left fold

    Note: It's more efficient to use folds from @Control.Foldl.ByteString@ in
    conjunction with @Pipes.Prelude.'Pipes.Prelude.fold'@ when possible
-}</span><span>
</span><span id="line-452"></span><span id="local-6989586621679060156"><span id="local-6989586621679060157"><span id="local-6989586621679060158"><span class="annot"><a href="Pipes.ByteString.html#foldBytes"><span class="hs-identifier hs-type">foldBytes</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060158"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060157"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060157"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060157"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060157"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060156"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060158"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060158"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060156"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-455"></span><span id="foldBytes"><span class="annot"><span class="annottext">foldBytes :: (x -&gt; Word8 -&gt; x)
-&gt; x -&gt; (x -&gt; r) -&gt; Producer ByteString m () -&gt; m r
</span><a href="Pipes.ByteString.html#foldBytes"><span class="hs-identifier hs-var hs-var">foldBytes</span></a></span></span><span> </span><span id="local-6989586621679060155"><span class="annot"><span class="annottext">x -&gt; Word8 -&gt; x
</span><a href="#local-6989586621679060155"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679060154"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679060154"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679060153"><span class="annot"><span class="annottext">x -&gt; r
</span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; ByteString -&gt; x)
-&gt; x -&gt; (x -&gt; r) -&gt; Producer ByteString m () -&gt; m r
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060151"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679060151"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679060150"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; Word8 -&gt; x) -&gt; x -&gt; ByteString -&gt; x
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">BS.foldl'</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; Word8 -&gt; x
</span><a href="#local-6989586621679060155"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679060151"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679060154"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; r
</span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-456"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#foldBytes"><span class="hs-pragma hs-type">foldBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Retrieve the first 'Word8'</span><span>
</span><span id="line-459"></span><span id="local-6989586621679060652"><span class="annot"><a href="Pipes.ByteString.html#head"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-460"></span><span id="head"><span class="annot"><span class="annottext">head :: Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#head"><span class="hs-identifier hs-var hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m () -&gt; m (Maybe Word8)
forall (m :: * -&gt; *) r.
Monad m =&gt;
Producer ByteString m r -&gt; m (Maybe Word8)
</span><a href="#local-6989586621679060148"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679060148"><span class="annot"><span class="annottext">go :: Producer ByteString m r -&gt; m (Maybe Word8)
</span><a href="#local-6989586621679060148"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060147"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679060147"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679060146"><span class="annot"><span class="annottext">Either r (Word8, Producer ByteString m r)
</span><a href="#local-6989586621679060146"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
forall (m :: * -&gt; *) r.
Monad m =&gt;
Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
</span><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier hs-var">nextByte</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679060147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; m (Maybe Word8)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Word8 -&gt; m (Maybe Word8)) -&gt; Maybe Word8 -&gt; m (Maybe Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (Word8, Producer ByteString m r)
</span><a href="#local-6989586621679060146"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-465"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060145"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060145"><span class="hs-identifier hs-var">w8</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060145"><span class="hs-identifier hs-var">w8</span></a></span><span>
</span><span id="line-467"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#head"><span class="hs-pragma hs-type">head</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-comment">-- | Retrieve the last 'Word8'</span><span>
</span><span id="line-470"></span><span id="local-6989586621679060144"><span class="annot"><a href="Pipes.ByteString.html#last"><span class="hs-identifier hs-type">last</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-471"></span><span id="last"><span class="annot"><span class="annottext">last :: Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#last"><span class="hs-identifier hs-var hs-var">last</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
forall (m :: * -&gt; *).
Monad m =&gt;
Maybe Word8 -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="#local-6989586621679060143"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679060143"><span class="annot"><span class="annottext">go :: Maybe Word8 -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="#local-6989586621679060143"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060142"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060142"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679060141"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060141"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>        </span><span id="local-6989586621679060140"><span class="annot"><span class="annottext">Either () (ByteString, Producer ByteString m ())
</span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; m (Either () (ByteString, Producer ByteString m ()))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060141"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-475"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either () (ByteString, Producer ByteString m ())
</span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; m (Maybe Word8)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060142"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-477"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060138"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060138"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060137"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060137"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>                </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="#local-6989586621679060143"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060138"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060142"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe Word8) -&gt; Word8 -&gt; Maybe Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.last</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060138"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060137"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-479"></span><span>                </span><span class="hs-comment">-- TODO: Change this to 'unsafeLast' when bytestring-0.10.2.0</span><span>
</span><span id="line-480"></span><span>                </span><span class="hs-comment">--       becomes more widespread</span><span>
</span><span id="line-481"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#last"><span class="hs-pragma hs-type">last</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | Determine if the stream is empty</span><span>
</span><span id="line-484"></span><span id="local-6989586621679060136"><span class="annot"><a href="Pipes.ByteString.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-485"></span><span id="null"><span class="annot"><span class="annottext">null :: Producer ByteString m () -&gt; m Bool
</span><a href="Pipes.ByteString.html#null"><span class="hs-identifier hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; Bool) -&gt; Producer a m () -&gt; m Bool
</span><span class="hs-identifier hs-var">P.all</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span>
</span><span id="line-486"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#null"><span class="hs-pragma hs-type">null</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | Count the number of bytes</span><span>
</span><span id="line-489"></span><span id="local-6989586621679060133"><span id="local-6989586621679060134"><span class="annot"><a href="Pipes.ByteString.html#length"><span class="hs-identifier hs-type">length</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060134"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060133"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060133"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-490"></span><span id="length"><span class="annot"><span class="annottext">length :: Producer ByteString m () -&gt; m n
</span><a href="Pipes.ByteString.html#length"><span class="hs-identifier hs-var hs-var">length</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; ByteString -&gt; n)
-&gt; n -&gt; (n -&gt; n) -&gt; Producer ByteString m () -&gt; m n
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679060132"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060132"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060131"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060131"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060132"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; n
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060131"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-491"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#length"><span class="hs-pragma hs-type">length</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | Fold that returns whether 'M.Any' received 'Word8's satisfy the predicate</span><span>
</span><span id="line-494"></span><span id="local-6989586621679060129"><span class="annot"><a href="Pipes.ByteString.html#any"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060129"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060129"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060129"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-495"></span><span id="any"><span class="annot"><span class="annottext">any :: (Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
</span><a href="Pipes.ByteString.html#any"><span class="hs-identifier hs-var hs-var">any</span></a></span></span><span> </span><span id="local-6989586621679060128"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060128"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; Bool) -&gt; Producer a m () -&gt; m Bool
</span><span class="hs-identifier hs-var">P.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.any</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060128"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#any"><span class="hs-pragma hs-type">any</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | Fold that returns whether 'M.All' received 'Word8's satisfy the predicate</span><span>
</span><span id="line-499"></span><span id="local-6989586621679060125"><span class="annot"><a href="Pipes.ByteString.html#all"><span class="hs-identifier hs-type">all</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-500"></span><span id="all"><span class="annot"><span class="annottext">all :: (Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
</span><a href="Pipes.ByteString.html#all"><span class="hs-identifier hs-var hs-var">all</span></a></span></span><span> </span><span id="local-6989586621679060124"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060124"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; Bool) -&gt; Producer a m () -&gt; m Bool
</span><span class="hs-identifier hs-var">P.all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.all</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060124"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#all"><span class="hs-pragma hs-type">all</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- | Return the maximum 'Word8' within a byte stream</span><span>
</span><span id="line-504"></span><span id="local-6989586621679060122"><span class="annot"><a href="Pipes.ByteString.html#maximum"><span class="hs-identifier hs-type">maximum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-505"></span><span id="maximum"><span class="annot"><span class="annottext">maximum :: Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#maximum"><span class="hs-identifier hs-var hs-var">maximum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Word8 -&gt; ByteString -&gt; Maybe Word8)
-&gt; Maybe Word8
-&gt; (Maybe Word8 -&gt; Maybe Word8)
-&gt; Producer ByteString m ()
-&gt; m (Maybe Word8)
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; ByteString -&gt; Maybe Word8
</span><a href="#local-6989586621679060121"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Maybe Word8
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679060121"><span class="annot"><span class="annottext">step :: Maybe Word8 -&gt; ByteString -&gt; Maybe Word8
</span><a href="#local-6989586621679060121"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679060120"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060120"><span class="hs-identifier hs-var">mw8</span></a></span></span><span> </span><span id="local-6989586621679060119"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060120"><span class="hs-identifier hs-var">mw8</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe Word8) -&gt; Word8 -&gt; Maybe Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060120"><span class="hs-identifier hs-var">mw8</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-511"></span><span>            </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.maximum</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-512"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060117"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060117"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060117"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.maximum</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#maximum"><span class="hs-pragma hs-type">maximum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | Return the minimum 'Word8' within a byte stream</span><span>
</span><span id="line-516"></span><span id="local-6989586621679060115"><span class="annot"><a href="Pipes.ByteString.html#minimum"><span class="hs-identifier hs-type">minimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-517"></span><span id="minimum"><span class="annot"><span class="annottext">minimum :: Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#minimum"><span class="hs-identifier hs-var hs-var">minimum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Word8 -&gt; ByteString -&gt; Maybe Word8)
-&gt; Maybe Word8
-&gt; (Maybe Word8 -&gt; Maybe Word8)
-&gt; Producer ByteString m ()
-&gt; m (Maybe Word8)
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; ByteString -&gt; Maybe Word8
</span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Maybe Word8
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621679060114"><span class="annot"><span class="annottext">step :: Maybe Word8 -&gt; ByteString -&gt; Maybe Word8
</span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679060113"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">mw8</span></a></span></span><span> </span><span id="local-6989586621679060112"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060112"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060112"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">mw8</span></a></span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">mw8</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-523"></span><span>            </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.minimum</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060112"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060110"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060110"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060110"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.minimum</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060112"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#minimum"><span class="hs-pragma hs-type">minimum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | Determine whether any element in the byte stream matches the given 'Word8'</span><span>
</span><span id="line-528"></span><span id="local-6989586621679060108"><span class="annot"><a href="Pipes.ByteString.html#elem"><span class="hs-identifier hs-type">elem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060108"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060108"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060108"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-529"></span><span id="elem"><span class="annot"><span class="annottext">elem :: Word8 -&gt; Producer ByteString m () -&gt; m Bool
</span><a href="Pipes.ByteString.html#elem"><span class="hs-identifier hs-var hs-var">elem</span></a></span></span><span> </span><span id="local-6989586621679060107"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060107"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; Bool) -&gt; Producer a m () -&gt; m Bool
</span><span class="hs-identifier hs-var">P.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.elem</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060107"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elem"><span class="hs-pragma hs-type">elem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">{-| Determine whether all elements in the byte stream do not match the given
    'Word8'
-}</span><span>
</span><span id="line-535"></span><span id="local-6989586621679060105"><span class="annot"><a href="Pipes.ByteString.html#notElem"><span class="hs-identifier hs-type">notElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-536"></span><span id="notElem"><span class="annot"><span class="annottext">notElem :: Word8 -&gt; Producer ByteString m () -&gt; m Bool
</span><a href="Pipes.ByteString.html#notElem"><span class="hs-identifier hs-var hs-var">notElem</span></a></span></span><span> </span><span id="local-6989586621679060104"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060104"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; Producer ByteString m () -&gt; m Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; Bool) -&gt; Producer a m () -&gt; m Bool
</span><span class="hs-identifier hs-var">P.all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.notElem</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060104"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#notElem"><span class="hs-pragma hs-type">notElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | Find the first element in the stream that matches the predicate</span><span>
</span><span id="line-540"></span><span id="local-6989586621679060102"><span class="annot"><a href="Pipes.ByteString.html#find"><span class="hs-identifier hs-type">find</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060102"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-543"></span><span id="find"><span class="annot"><span class="annottext">find :: (Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#find"><span class="hs-identifier hs-var hs-var">find</span></a></span></span><span> </span><span id="local-6989586621679060101"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060101"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679060100"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m () -&gt; m (Maybe Word8)
forall (m :: * -&gt; *).
Monad m =&gt;
Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; Proxy () ByteString () ByteString m ()
-&gt; Producer ByteString m ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Proxy () ByteString () ByteString m ()
forall (m :: * -&gt; *) r.
Monad m =&gt;
(Word8 -&gt; Bool) -&gt; Pipe ByteString ByteString m r
</span><a href="Pipes.ByteString.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060101"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#find"><span class="hs-pragma hs-type">find</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-comment">-- | Index into a byte stream</span><span>
</span><span id="line-547"></span><span id="local-6989586621679060098"><span id="local-6989586621679060099"><span class="annot"><a href="Pipes.ByteString.html#index"><span class="hs-identifier hs-type">index</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060099"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679060098"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060098"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-550"></span><span id="index"><span class="annot"><span class="annottext">index :: n -&gt; Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#index"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679060097"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060097"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060096"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060096"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m () -&gt; m (Maybe Word8)
forall (m :: * -&gt; *).
Monad m =&gt;
Producer ByteString m () -&gt; m (Maybe Word8)
</span><a href="Pipes.ByteString.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; Producer ByteString m () -&gt; Producer ByteString m ()
forall (m :: * -&gt; *) n r.
(Monad m, Integral n) =&gt;
n -&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060097"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060096"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#index"><span class="hs-pragma hs-type">index</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-comment">-- | Find the index of an element that matches the given 'Word8'</span><span>
</span><span id="line-554"></span><span id="local-6989586621679060094"><span id="local-6989586621679060095"><span class="annot"><a href="Pipes.ByteString.html#elemIndex"><span class="hs-identifier hs-type">elemIndex</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060095"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060094"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679060094"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-556"></span><span id="elemIndex"><span class="annot"><span class="annottext">elemIndex :: Word8 -&gt; Producer ByteString m () -&gt; m (Maybe n)
</span><a href="Pipes.ByteString.html#elemIndex"><span class="hs-identifier hs-var hs-var">elemIndex</span></a></span></span><span> </span><span id="local-6989586621679060093"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060093"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m (Maybe n)
forall (m :: * -&gt; *) n.
(Monad m, Num n) =&gt;
(Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m (Maybe n)
</span><a href="Pipes.ByteString.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060093"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#elemIndex"><span class="hs-pragma hs-type">elemIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-comment">-- | Store the first index of an element that satisfies the predicate</span><span>
</span><span id="line-560"></span><span id="local-6989586621679060634"><span id="local-6989586621679060635"><span class="annot"><a href="Pipes.ByteString.html#findIndex"><span class="hs-identifier hs-type">findIndex</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060635"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060635"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060635"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679060634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-563"></span><span id="findIndex"><span class="annot"><span class="annottext">findIndex :: (Word8 -&gt; Bool) -&gt; Producer ByteString m () -&gt; m (Maybe n)
</span><a href="Pipes.ByteString.html#findIndex"><span class="hs-identifier hs-var hs-var">findIndex</span></a></span></span><span> </span><span id="local-6989586621679060092"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060092"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679060091"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060091"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer n m () -&gt; m (Maybe n)
forall (m :: * -&gt; *) a. Monad m =&gt; Producer a m () -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">P.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060091"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; Proxy () ByteString () n m () -&gt; Producer n m ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Proxy () ByteString () n m ()
forall (m :: * -&gt; *) n r.
(Monad m, Num n) =&gt;
(Word8 -&gt; Bool) -&gt; Pipe ByteString n m r
</span><a href="Pipes.ByteString.html#findIndices"><span class="hs-identifier hs-var">findIndices</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060092"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#findIndex"><span class="hs-pragma hs-type">findIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">-- | Store a tally of how many elements match the given 'Word8'</span><span>
</span><span id="line-567"></span><span id="local-6989586621679060088"><span id="local-6989586621679060089"><span class="annot"><a href="Pipes.ByteString.html#count"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060089"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679060088"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060088"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-568"></span><span id="count"><span class="annot"><span class="annottext">count :: Word8 -&gt; Producer ByteString m () -&gt; m n
</span><a href="Pipes.ByteString.html#count"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679060087"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060087"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span id="local-6989586621679060086"><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; n -&gt; n) -&gt; n -&gt; (n -&gt; n) -&gt; Producer n m () -&gt; m n
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m ()
</span><a href="#local-6989586621679060086"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; Proxy () ByteString () n m () -&gt; Producer n m ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; n) -&gt; Proxy () ByteString () n m ()
forall (m :: * -&gt; *) a b r. Functor m =&gt; (a -&gt; b) -&gt; Pipe a b m r
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; n
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; n) -&gt; (ByteString -&gt; Int) -&gt; ByteString -&gt; n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.count</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060087"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#count"><span class="hs-pragma hs-type">count</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">{-| Consume the first byte from a byte stream

    'next' either fails with a 'Left' if the 'Producer' has no more bytes or
    succeeds with a 'Right' providing the next byte and the remainder of the
    'Producer'.
-}</span><span>
</span><span id="line-577"></span><span id="local-6989586621679060672"><span id="local-6989586621679060673"><span class="annot"><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier hs-type">nextByte</span></a></span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060673"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060673"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060672"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060673"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679060672"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060673"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060672"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-581"></span><span id="nextByte"><span class="annot"><span class="annottext">nextByte :: Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
</span><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier hs-var hs-var">nextByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
forall (m :: * -&gt; *) r.
Monad m =&gt;
Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
</span><a href="#local-6989586621679060084"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621679060084"><span class="annot"><span class="annottext">go :: Producer ByteString m b
-&gt; m (Either b (Word8, Producer ByteString m b))
</span><a href="#local-6989586621679060084"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060083"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060083"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-584"></span><span>        </span><span id="local-6989586621679060082"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060082"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060083"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-585"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060082"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-586"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679060081"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060081"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either b (Word8, Producer ByteString m b)
-&gt; m (Either b (Word8, Producer ByteString m b))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either b (Word8, Producer ByteString m b)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060081"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060080"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060080"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060079"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060079"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">BS.uncons</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060080"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-588"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (Word8, Producer ByteString m b))
</span><a href="#local-6989586621679060084"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060079"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-589"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060077"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060077"><span class="hs-identifier hs-var">w8</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060076"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060076"><span class="hs-identifier hs-var">bs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either b (Word8, Producer ByteString m b)
-&gt; m (Either b (Word8, Producer ByteString m b))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8, Producer ByteString m b)
-&gt; Either b (Word8, Producer ByteString m b)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060077"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060076"><span class="hs-identifier hs-var">bs'</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060079"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#nextByte"><span class="hs-pragma hs-type">nextByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">{-| Draw one 'Word8' from the underlying 'Producer', returning 'Nothing' if the
    'Producer' is empty
-}</span><span>
</span><span id="line-595"></span><span id="local-6989586621679060614"><span class="annot"><a href="Pipes.ByteString.html#drawByte"><span class="hs-identifier hs-type">drawByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060614"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060614"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-596"></span><span id="drawByte"><span class="annot"><span class="annottext">drawByte :: Parser ByteString m (Maybe Word8)
</span><a href="Pipes.ByteString.html#drawByte"><span class="hs-identifier hs-var hs-var">drawByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>    </span><span id="local-6989586621679060075"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679060075"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Producer ByteString m x) m (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; Parser a m (Maybe a)
</span><span class="hs-identifier hs-var">PP.draw</span></span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679060075"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-600"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060073"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060073"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">BS.uncons</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060073"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-601"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *). Monad m =&gt; Parser ByteString m (Maybe Word8)
</span><a href="Pipes.ByteString.html#drawByte"><span class="hs-identifier hs-var">drawByte</span></a></span><span>
</span><span id="line-602"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060072"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060072"><span class="hs-identifier hs-var">w8</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060071"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060071"><span class="hs-identifier hs-var">bs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-603"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Parser a m ()
</span><span class="hs-identifier hs-var">PP.unDraw</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060071"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-604"></span><span>                </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060072"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#drawByte"><span class="hs-pragma hs-type">drawByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | Push back a 'Word8' onto the underlying 'Producer'</span><span>
</span><span id="line-608"></span><span id="local-6989586621679060605"><span class="annot"><a href="Pipes.ByteString.html#unDrawByte"><span class="hs-identifier hs-type">unDrawByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-609"></span><span id="unDrawByte"><span class="annot"><span class="annottext">unDrawByte :: Word8 -&gt; Parser ByteString m ()
</span><a href="Pipes.ByteString.html#unDrawByte"><span class="hs-identifier hs-var hs-var">unDrawByte</span></a></span></span><span> </span><span id="local-6989586621679060069"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060069"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Proxy X () () ByteString m x -&gt; Proxy X () () ByteString m x)
-&gt; StateT (Proxy X () () ByteString m x) m ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060069"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Proxy X () () ByteString m x -&gt; Proxy X () () ByteString m x
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unDrawByte"><span class="hs-pragma hs-type">unDrawByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">{-| 'peekByte' checks the first 'Word8' in the stream, but uses 'unDrawByte' to
    push the 'Word8' back

&gt; peekByte = do
&gt;     x &lt;- drawByte
&gt;     case x of
&gt;         Nothing -&gt; return ()
&gt;         Just w8 -&gt; unDrawByte w8
&gt;     return x
-}</span><span>
</span><span id="line-622"></span><span id="local-6989586621679060068"><span class="annot"><a href="Pipes.ByteString.html#peekByte"><span class="hs-identifier hs-type">peekByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-623"></span><span id="peekByte"><span class="annot"><span class="annottext">peekByte :: Parser ByteString m (Maybe Word8)
</span><a href="Pipes.ByteString.html#peekByte"><span class="hs-identifier hs-var hs-var">peekByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679060067"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060067"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *). Monad m =&gt; Parser ByteString m (Maybe Word8)
</span><a href="Pipes.ByteString.html#drawByte"><span class="hs-identifier hs-var">drawByte</span></a></span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060067"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-626"></span><span>        </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT (Producer ByteString m x) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060066"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060066"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Parser ByteString m ()
forall (m :: * -&gt; *). Monad m =&gt; Word8 -&gt; Parser ByteString m ()
</span><a href="Pipes.ByteString.html#unDrawByte"><span class="hs-identifier hs-var">unDrawByte</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060066"><span class="hs-identifier hs-var">w8</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060067"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-629"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#peekByte"><span class="hs-pragma hs-type">peekByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-comment">{-| Check if the underlying 'Producer' has no more bytes

    Note that this will skip over empty 'ByteString' chunks, unlike
    'Pipes.Parse.isEndOfInput' from @pipes-parse@.

&gt; isEndOfBytes = liftM isNothing peekByte
-}</span><span>
</span><span id="line-638"></span><span id="local-6989586621679060065"><span class="annot"><a href="Pipes.ByteString.html#isEndOfBytes"><span class="hs-identifier hs-type">isEndOfBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-639"></span><span id="isEndOfBytes"><span class="annot"><span class="annottext">isEndOfBytes :: Parser ByteString m Bool
</span><a href="Pipes.ByteString.html#isEndOfBytes"><span class="hs-identifier hs-var hs-var">isEndOfBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679060064"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060064"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Producer ByteString m x) m (Maybe Word8)
forall (m :: * -&gt; *). Monad m =&gt; Parser ByteString m (Maybe Word8)
</span><a href="Pipes.ByteString.html#peekByte"><span class="hs-identifier hs-var">peekByte</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT (Producer ByteString m x) m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679060064"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-642"></span><span>        </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#isEndOfBytes"><span class="hs-pragma hs-type">isEndOfBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-keyword">type</span><span> </span><span id="Lens%27"><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-var">Lens'</span></a></span></span><span> </span><span id="local-6989586621679060063"><span class="annot"><a href="#local-6989586621679060063"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679060062"><span class="annot"><a href="#local-6989586621679060062"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679060061"><span class="annot"><a href="#local-6989586621679060061"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679060061"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060062"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060061"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060062"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679060063"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060061"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060063"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | Improper lens that splits a 'Producer' after the given number of bytes</span><span>
</span><span id="line-649"></span><span id="local-6989586621679060534"><span id="local-6989586621679060535"><span id="local-6989586621679060536"><span class="annot"><a href="Pipes.ByteString.html#splitAt"><span class="hs-identifier hs-type">splitAt</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060536"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679060535"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060535"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060534"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060534"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-654"></span><span id="splitAt"><span class="annot"><span class="annottext">splitAt :: n
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#splitAt"><span class="hs-identifier hs-var hs-var">splitAt</span></a></span></span><span> </span><span id="local-6989586621679060060"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060060"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span id="local-6989586621679060059"><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060059"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679060058"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060058"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m x)
 -&gt; Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060059"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
-&gt; Producer ByteString m x
-&gt; Producer ByteString m (Producer ByteString m x)
forall t (m :: * -&gt; *) b x' x.
(Monad m, Integral t) =&gt;
t
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060057"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679060060"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060058"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">-- go  :: (Monad m, Integral n)</span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-comment">--     =&gt; n</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-comment">--     -&gt; Producer ByteString m r</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-comment">--     -&gt; Producer' ByteString m (Producer ByteString m r)</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621679060057"><span class="annot"><span class="annottext">go :: t
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060057"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060056"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679060055"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060055"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-661"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060055"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-663"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-664"></span><span>            </span><span id="local-6989586621679060054"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060054"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     x'
     x
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060055"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060054"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-666"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679060052"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060052"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060052"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060051"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060051"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060050"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060050"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-668"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060049"><span class="annot"><span class="annottext">len :: t
</span><a href="#local-6989586621679060049"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; t
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060051"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060049"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-671"></span><span>                            </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060051"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-672"></span><span>                            </span><span class="annot"><span class="annottext">t
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060057"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060049"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060050"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-673"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-674"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060048"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060048"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060047"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060047"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-675"></span><span>                                    </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060051"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-676"></span><span>                            </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060048"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-677"></span><span>                            </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060047"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060050"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitAt"><span class="hs-pragma hs-type">splitAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="hs-comment">{-| Improper lens that splits after the longest consecutive group of bytes that
    satisfy the given predicate
-}</span><span>
</span><span id="line-683"></span><span id="local-6989586621679060572"><span id="local-6989586621679060573"><span class="annot"><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-type">span</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060573"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060572"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060572"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-688"></span><span id="span"><span class="annot"><span class="annottext">span :: (Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span id="local-6989586621679060045"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060045"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679060044"><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060044"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679060043"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060043"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m x)
 -&gt; Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060044"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; Producer ByteString m (Producer ByteString m x)
forall (m :: * -&gt; *) b x' x.
Monad m =&gt;
Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060042"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060043"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679060042"><span class="annot"><span class="annottext">go :: Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060042"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060041"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060041"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>        </span><span id="local-6989586621679060040"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060040"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     x'
     x
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060041"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060040"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-693"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679060039"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060039"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060039"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060038"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060038"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060037"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060037"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-695"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060036"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060036"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060035"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.span</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060045"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060038"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-696"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-698"></span><span>                        </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060038"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-699"></span><span>                        </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060042"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060037"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-700"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-701"></span><span>                        </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060036"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-702"></span><span>                        </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060037"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#span"><span class="hs-pragma hs-type">span</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span class="hs-comment">{-| Improper lens that splits after the longest consecutive group of bytes that
    fail the given predicate
-}</span><span>
</span><span id="line-708"></span><span id="local-6989586621679060033"><span id="local-6989586621679060034"><span class="annot"><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-type">break</span></a></span><span>
</span><span id="line-709"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060034"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-710"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060033"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060033"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-713"></span><span id="break"><span class="annot"><span class="annottext">break :: (Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-var hs-var">break</span></a></span></span><span> </span><span id="local-6989586621679060032"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060032"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679060032"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#break"><span class="hs-pragma hs-type">break</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">{-| Improper lens that splits at the first occurrence of the pattern.
-}</span><span>
</span><span id="line-718"></span><span id="local-6989586621679060449"><span id="local-6989586621679060450"><span class="annot"><a href="Pipes.ByteString.html#breakOn"><span class="hs-identifier hs-type">breakOn</span></a></span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060450"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060450"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060449"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060450"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060450"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060449"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-723"></span><span id="breakOn"><span class="annot"><span class="annottext">breakOn :: ByteString
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#breakOn"><span class="hs-identifier hs-var hs-var">breakOn</span></a></span></span><span> </span><span id="local-6989586621679060030"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060030"><span class="hs-identifier hs-var">needle</span></a></span></span><span> </span><span id="local-6989586621679060029"><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060029"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679060028"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060028"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m x)
 -&gt; Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060029"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
-&gt; Producer ByteString m x
-&gt; Producer ByteString m (Producer ByteString m x)
forall (m :: * -&gt; *) b x' x.
Monad m =&gt;
ByteString
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060028"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-726"></span><span>    </span><span id="local-6989586621679060026"><span class="annot"><span class="annottext">len0 :: Int
</span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var hs-var">len0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060030"><span class="hs-identifier hs-var">needle</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679060027"><span class="annot"><span class="annottext">go :: ByteString
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679060025"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span></span><span> </span><span id="local-6989586621679060024"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060024"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-729"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var">len0</span></a></span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-731"></span><span>            </span><span id="local-6989586621679060022"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060022"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     x'
     x
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060024"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060022"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-733"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679060021"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">r</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-734"></span><span>                    </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-735"></span><span>                    </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060020"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060019"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060019"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-737"></span><span>                    </span><span class="annot"><span class="annottext">ByteString
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060019"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-738"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-739"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060018"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060018"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060017"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060017"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">Data.ByteString.Search.breakOn</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060030"><span class="hs-identifier hs-var">needle</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-740"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060017"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-741"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-742"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679060015"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679060015"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-743"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060014"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060014"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060013"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060013"><span class="hs-identifier hs-var">leftovers'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-744"></span><span>                            </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060015"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var">len0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-745"></span><span>                    </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060014"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-746"></span><span>                    </span><span class="annot"><span class="annottext">ByteString
-&gt; Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060013"><span class="hs-identifier hs-var">leftovers'</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060024"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-747"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-748"></span><span>                    </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060018"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-749"></span><span>                    </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy x' x () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060017"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060024"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#breakOn"><span class="hs-pragma hs-type">breakOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-comment">{-| Improper lens that splits after the first group of matching bytes, as
    defined by the given equality predicate
-}</span><span>
</span><span id="line-755"></span><span id="local-6989586621679060551"><span id="local-6989586621679060552"><span class="annot"><a href="Pipes.ByteString.html#groupBy"><span class="hs-identifier hs-type">groupBy</span></a></span><span>
</span><span id="line-756"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060552"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-757"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060551"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060551"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-760"></span><span id="groupBy"><span class="annot"><span class="annottext">groupBy :: (Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#groupBy"><span class="hs-identifier hs-var hs-var">groupBy</span></a></span></span><span> </span><span id="local-6989586621679060012"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679060012"><span class="hs-identifier hs-var">equals</span></a></span></span><span> </span><span id="local-6989586621679060011"><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060011"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679060010"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060010"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m x)
 -&gt; Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679060011"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; Producer ByteString m (Producer ByteString m x)
forall (m :: * -&gt; *) b.
Monad m =&gt;
Producer ByteString m b
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060009"><span class="hs-identifier hs-var">_groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679060010"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-762"></span><span>    </span><span class="hs-comment">-- _groupBy</span><span>
</span><span id="line-763"></span><span>    </span><span class="hs-comment">--     :: Monad m</span><span>
</span><span id="line-764"></span><span>    </span><span class="hs-comment">--     =&gt; Producer ByteString m r</span><span>
</span><span id="line-765"></span><span>    </span><span class="hs-comment">--     -&gt; Producer ByteString m (Producer ByteString m r)</span><span>
</span><span id="line-766"></span><span>    </span><span id="local-6989586621679060009"><span class="annot"><span class="annottext">_groupBy :: Producer ByteString m b
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060009"><span class="hs-identifier hs-var hs-var">_groupBy</span></a></span></span><span> </span><span id="local-6989586621679060008"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060008"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>        </span><span id="local-6989586621679060007"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     X
     ()
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060008"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-769"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679060006"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060005"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679060004"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">BS.uncons</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-771"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679060009"><span class="hs-identifier hs-var">_groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-772"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679060003"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060003"><span class="hs-identifier hs-var">w8</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m b -&gt; Producer ByteString m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; ((Proxy X () () ByteString m (Producer ByteString m b)
     -&gt; Constant
          (Proxy X () () ByteString m (Producer ByteString m b))
          (Proxy X () () ByteString m (Producer ByteString m b)))
    -&gt; Producer ByteString m b
    -&gt; Constant
         (Proxy X () () ByteString m (Producer ByteString m b))
         (Producer ByteString m b))
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m b)
     (Proxy X () () ByteString m (Producer ByteString m b))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679060012"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679060003"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groupBy"><span class="hs-pragma hs-type">groupBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">-- | Like 'groupBy', where the equality predicate is ('==')</span><span>
</span><span id="line-776"></span><span id="local-6989586621679060001"><span id="local-6989586621679060002"><span class="annot"><a href="Pipes.ByteString.html#group"><span class="hs-identifier hs-type">group</span></a></span><span>
</span><span id="line-777"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060002"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060001"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060001"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-780"></span><span id="group"><span class="annot"><span class="annottext">group :: Lens'
  (Producer ByteString m x)
  (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#group"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-781"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#group"><span class="hs-pragma hs-type">group</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">{-| Improper lens that splits a 'Producer' after the first word

    Unlike 'words', this does not drop leading whitespace

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-791"></span><span id="local-6989586621679059999"><span id="local-6989586621679060000"><span class="annot"><a href="Pipes.ByteString.html#word"><span class="hs-identifier hs-type">word</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060000"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059999"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059999"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-795"></span><span id="word"><span class="annot"><span class="annottext">word :: Lens'
  (Producer ByteString m x)
  (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#word"><span class="hs-identifier hs-var hs-var">word</span></a></span></span><span> </span><span id="local-6989586621679059998"><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679059998"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059997"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059997"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m x)
 -&gt; Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m (Producer ByteString m x)
-&gt; f (Producer ByteString m (Producer ByteString m x))
</span><a href="#local-6989586621679059998"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; Producer ByteString m (Producer ByteString m x)
forall (m :: * -&gt; *) b.
Monad m =&gt;
Producer ByteString m b
-&gt; Proxy X () () ByteString m (Producer ByteString m b)
</span><a href="#local-6989586621679059996"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059997"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-comment">-- to</span><span>
</span><span id="line-798"></span><span>    </span><span class="hs-comment">--     :: Monad m</span><span>
</span><span id="line-799"></span><span>    </span><span class="hs-comment">--     =&gt; Producer ByteString m r</span><span>
</span><span id="line-800"></span><span>    </span><span class="hs-comment">--     -&gt; Producer ByteString m (Producer ByteString m r)</span><span>
</span><span id="line-801"></span><span>    </span><span id="local-6989586621679059996"><span class="annot"><span class="annottext">to :: Producer ByteString m x
-&gt; Proxy X () () ByteString m (Producer ByteString m x)
</span><a href="#local-6989586621679059996"><span class="hs-identifier hs-var hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679059995"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059995"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-802"></span><span>        </span><span id="local-6989586621679059994"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059994"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059995"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; ((Proxy X () () ByteString m (Producer ByteString m x)
     -&gt; Constant
          (Proxy X () () ByteString m (Producer ByteString m x))
          (Proxy X () () ByteString m (Producer ByteString m x)))
    -&gt; Producer ByteString m x
    -&gt; Constant
         (Proxy X () () ByteString m (Producer ByteString m x))
         (Producer ByteString m x))
-&gt; Proxy X () () ByteString m (Producer ByteString m x)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Proxy X () () ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isSpaceWord8</span></span><span>
</span><span id="line-803"></span><span>        </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059994"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; ((Proxy X () () ByteString m (Producer ByteString m x)
     -&gt; Constant
          (Proxy X () () ByteString m (Producer ByteString m x))
          (Proxy X () () ByteString m (Producer ByteString m x)))
    -&gt; Producer ByteString m x
    -&gt; Constant
         (Proxy X () () ByteString m (Producer ByteString m x))
         (Producer ByteString m x))
-&gt; Proxy X () () ByteString m (Producer ByteString m x)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Proxy X () () ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isSpaceWord8</span></span><span>
</span><span id="line-804"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#word"><span class="hs-pragma hs-type">word</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="annot"><a href="Pipes.ByteString.html#nl"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-807"></span><span id="nl"><span class="annot"><span class="annottext">nl :: Word8
</span><a href="Pipes.ByteString.html#nl"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">{-| Improper lens that splits a 'Producer' after the first line

    Unlike 'lines', this does not consume the newline marker, which is stored
    within the inner 'Producer'

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-818"></span><span id="local-6989586621679060423"><span id="local-6989586621679060424"><span class="annot"><a href="Pipes.ByteString.html#line"><span class="hs-identifier hs-type">line</span></a></span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060424"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-820"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060424"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060423"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060424"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060424"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060423"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-822"></span><span id="line"><span class="annot"><span class="annottext">line :: Lens'
  (Producer ByteString m x)
  (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Pipes.ByteString.html#nl"><span class="hs-identifier hs-var">nl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#line"><span class="hs-pragma hs-type">line</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-comment">-- | @(drop n)@ drops the first @n@ bytes</span><span>
</span><span id="line-826"></span><span id="local-6989586621679060638"><span id="local-6989586621679060639"><span id="local-6989586621679060640"><span class="annot"><a href="Pipes.ByteString.html#drop"><span class="hs-identifier hs-type">drop</span></a></span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679060639"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060639"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060638"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-829"></span><span id="drop"><span class="annot"><span class="annottext">drop :: n -&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#drop"><span class="hs-identifier hs-var hs-var">drop</span></a></span></span><span> </span><span id="local-6989586621679059992"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059991"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-830"></span><span>    </span><span id="local-6989586621679059990"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059990"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Producer ByteString m r)
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Producer ByteString m r)
 -&gt; Proxy X () () ByteString m (Producer ByteString m r))
-&gt; m (Producer ByteString m r)
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Effect m (Producer ByteString m r) -&gt; m (Producer ByteString m r)
forall (m :: * -&gt; *) r. Monad m =&gt; Effect m r -&gt; m r
</span><span class="hs-identifier hs-var">runEffect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy X () () ByteString m (Producer ByteString m r)
-&gt; (ByteString -&gt; Proxy X () () X m ())
-&gt; Effect m (Producer ByteString m r)
forall (m :: * -&gt; *) x' x b' b a' c' c.
Functor m =&gt;
Proxy x' x b' b m a'
-&gt; (b -&gt; Proxy x' x c' c m b') -&gt; Proxy x' x c' c m a'
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
-&gt; ((Proxy X () () ByteString m (Producer ByteString m r)
     -&gt; Constant
          (Proxy X () () ByteString m (Producer ByteString m r))
          (Proxy X () () ByteString m (Producer ByteString m r)))
    -&gt; Producer ByteString m r
    -&gt; Constant
         (Proxy X () () ByteString m (Producer ByteString m r))
         (Producer ByteString m r))
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">n
-&gt; Lens'
     (Producer ByteString m r)
     (Proxy X () () ByteString m (Producer ByteString m r))
forall (m :: * -&gt; *) n x.
(Monad m, Integral n) =&gt;
n
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () X m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">discard</span></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059990"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-832"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#drop"><span class="hs-pragma hs-type">drop</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="hs-comment">-- | Drop bytes until they fail the predicate</span><span>
</span><span id="line-835"></span><span id="local-6989586621679060405"><span id="local-6989586621679060406"><span class="annot"><a href="Pipes.ByteString.html#dropWhile"><span class="hs-identifier hs-type">dropWhile</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060406"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060406"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060405"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060406"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060405"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-838"></span><span id="dropWhile"><span class="annot"><span class="annottext">dropWhile :: (Word8 -&gt; Bool)
-&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#dropWhile"><span class="hs-identifier hs-var hs-var">dropWhile</span></a></span></span><span> </span><span id="local-6989586621679059987"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679059986"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-839"></span><span>    </span><span id="local-6989586621679059985"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Producer ByteString m r)
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Producer ByteString m r)
 -&gt; Proxy X () () ByteString m (Producer ByteString m r))
-&gt; m (Producer ByteString m r)
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Effect m (Producer ByteString m r) -&gt; m (Producer ByteString m r)
forall (m :: * -&gt; *) r. Monad m =&gt; Effect m r -&gt; m r
</span><span class="hs-identifier hs-var">runEffect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy X () () ByteString m (Producer ByteString m r)
-&gt; (ByteString -&gt; Proxy X () () X m ())
-&gt; Effect m (Producer ByteString m r)
forall (m :: * -&gt; *) x' x b' b a' c' c.
Functor m =&gt;
Proxy x' x b' b m a'
-&gt; (b -&gt; Proxy x' x c' c m b') -&gt; Proxy x' x c' c m a'
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
-&gt; ((Proxy X () () ByteString m (Producer ByteString m r)
     -&gt; Constant
          (Proxy X () () ByteString m (Producer ByteString m r))
          (Proxy X () () ByteString m (Producer ByteString m r)))
    -&gt; Producer ByteString m r
    -&gt; Constant
         (Proxy X () () ByteString m (Producer ByteString m r))
         (Producer ByteString m r))
-&gt; Proxy X () () ByteString m (Producer ByteString m r)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m r)
     (Proxy X () () ByteString m (Producer ByteString m r))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () X m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">discard</span></span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>    </span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-841"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="hs-comment">-- | Intersperse a 'Word8' in between the bytes of the byte stream</span><span>
</span><span id="line-844"></span><span id="local-6989586621679059983"><span id="local-6989586621679059984"><span class="annot"><a href="Pipes.ByteString.html#intersperse"><span class="hs-identifier hs-type">intersperse</span></a></span><span>
</span><span id="line-845"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059983"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059983"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-846"></span><span id="intersperse"><span class="annot"><span class="annottext">intersperse :: Word8 -&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#intersperse"><span class="hs-identifier hs-var hs-var">intersperse</span></a></span></span><span> </span><span id="local-6989586621679059982"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r -&gt; Producer ByteString m r
forall (m :: * -&gt; *) b x' x.
Monad m =&gt;
Producer ByteString m b -&gt; Proxy x' x () ByteString m b
</span><a href="#local-6989586621679059981"><span class="hs-identifier hs-var">go0</span></a></span><span>
</span><span id="line-847"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-848"></span><span>    </span><span id="local-6989586621679059981"><span class="annot"><span class="annottext">go0 :: Producer ByteString m b -&gt; Proxy x' x () ByteString m b
</span><a href="#local-6989586621679059981"><span class="hs-identifier hs-var hs-var">go0</span></a></span></span><span> </span><span id="local-6989586621679059980"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059980"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-849"></span><span>        </span><span id="local-6989586621679059979"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679059979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     x'
     x
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059980"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679059979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-851"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059978"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059978"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Proxy x' x () ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059978"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-852"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059977"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059977"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059976"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059976"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-853"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intersperse</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059977"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>                </span><span class="annot"><span class="annottext">Producer ByteString m b -&gt; Proxy x' x () ByteString m b
forall (m :: * -&gt; *) b x' x.
Monad m =&gt;
Producer ByteString m b -&gt; Proxy x' x () ByteString m b
</span><a href="#local-6989586621679059974"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059976"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-855"></span><span>    </span><span id="local-6989586621679059974"><span class="annot"><span class="annottext">go1 :: Producer ByteString m b -&gt; Proxy x' x () ByteString m b
</span><a href="#local-6989586621679059974"><span class="hs-identifier hs-var hs-var">go1</span></a></span></span><span> </span><span id="local-6989586621679059973"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-856"></span><span>        </span><span id="local-6989586621679059972"><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (ByteString, Producer ByteString m b))
-&gt; Proxy
     x'
     x
     ()
     ByteString
     m
     (Either b (ByteString, Producer ByteString m b))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m b
-&gt; m (Either b (ByteString, Producer ByteString m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (ByteString, Producer ByteString m b)
</span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-858"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059971"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Proxy x' x () ByteString m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-859"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059970"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059969"><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-860"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>                </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intersperse</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>                </span><span class="annot"><span class="annottext">Producer ByteString m b -&gt; Proxy x' x () ByteString m b
</span><a href="#local-6989586621679059974"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m b
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-863"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#intersperse"><span class="hs-pragma hs-type">intersperse</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="hs-comment">-- | Improper lens from unpacked 'Word8's to packaged 'ByteString's</span><span>
</span><span id="line-866"></span><span id="local-6989586621679059967"><span id="local-6989586621679059968"><span class="annot"><a href="Pipes.ByteString.html#pack"><span class="hs-identifier hs-type">pack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059968"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><a href="#local-6989586621679059968"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059967"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059968"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059967"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-867"></span><span id="pack"><span class="annot"><span class="annottext">pack :: Lens' (Producer Word8 m x) (Producer ByteString m x)
</span><a href="Pipes.ByteString.html#pack"><span class="hs-identifier hs-var hs-var">pack</span></a></span></span><span> </span><span id="local-6989586621679059966"><span class="annot"><span class="annottext">Producer ByteString m x -&gt; f (Producer ByteString m x)
</span><a href="#local-6989586621679059966"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059965"><span class="annot"><span class="annottext">Producer Word8 m x
</span><a href="#local-6989586621679059965"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m x -&gt; Producer Word8 m x)
-&gt; f (Producer ByteString m x) -&gt; f (Producer Word8 m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; Producer Word8 m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
Producer ByteString m x -&gt; Producer Word8 m x
</span><a href="Pipes.ByteString.html#_unpack"><span class="hs-identifier hs-var">_unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; f (Producer ByteString m x)
</span><a href="#local-6989586621679059966"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer Word8 m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
Producer Word8 m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_pack"><span class="hs-identifier hs-var">_pack</span></a></span><span> </span><span class="annot"><span class="annottext">Producer Word8 m x
</span><a href="#local-6989586621679059965"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#pack"><span class="hs-pragma hs-type">pack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-comment">-- | Improper lens from packed 'ByteString's to unpacked 'Word8's</span><span>
</span><span id="line-871"></span><span id="local-6989586621679059961"><span id="local-6989586621679059962"><span class="annot"><a href="Pipes.ByteString.html#unpack"><span class="hs-identifier hs-type">unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059962"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059962"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059961"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><a href="#local-6989586621679059962"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059961"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-872"></span><span id="unpack"><span class="annot"><span class="annottext">unpack :: Lens' (Producer ByteString m x) (Producer Word8 m x)
</span><a href="Pipes.ByteString.html#unpack"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span id="local-6989586621679059960"><span class="annot"><span class="annottext">Producer Word8 m x -&gt; f (Producer Word8 m x)
</span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059959"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059959"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer Word8 m x -&gt; Producer ByteString m x)
-&gt; f (Producer Word8 m x) -&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer Word8 m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
Producer Word8 m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_pack"><span class="hs-identifier hs-var">_pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer Word8 m x -&gt; f (Producer Word8 m x)
</span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; Producer Word8 m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
Producer ByteString m x -&gt; Producer Word8 m x
</span><a href="Pipes.ByteString.html#_unpack"><span class="hs-identifier hs-var">_unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059959"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unpack"><span class="hs-pragma hs-type">unpack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span id="local-6989586621679060513"><span id="local-6989586621679060514"><span class="annot"><a href="Pipes.ByteString.html#_pack"><span class="hs-identifier hs-type">_pack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060514"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><a href="#local-6989586621679060514"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060513"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060514"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060513"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-876"></span><span id="_pack"><span class="annot"><span class="annottext">_pack :: Producer Word8 m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_pack"><span class="hs-identifier hs-var hs-var">_pack</span></a></span></span><span> </span><span id="local-6989586621679059958"><span class="annot"><span class="annottext">Producer Word8 m x
</span><a href="#local-6989586621679059958"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Word8] -&gt; [Word8]) -&gt; Word8 -&gt; [Word8] -&gt; [Word8])
-&gt; ([Word8] -&gt; [Word8])
-&gt; (([Word8] -&gt; [Word8]) -&gt; ByteString)
-&gt; FreeT (Producer Word8 m) m x
-&gt; Producer ByteString m x
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; FreeT (Producer a m) m r -&gt; Producer b m r
</span><span class="hs-identifier hs-var">PG.folds</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; [Word8]) -&gt; Word8 -&gt; [Word8] -&gt; [Word8]
forall a c. ([a] -&gt; c) -&gt; a -&gt; [a] -&gt; c
</span><a href="#local-6989586621679059956"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; [Word8]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; [Word8]) -&gt; ByteString
forall a. ([a] -&gt; [Word8]) -&gt; ByteString
</span><a href="#local-6989586621679059955"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer Word8 m x
</span><a href="#local-6989586621679059958"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Producer Word8 m x
-&gt; ((FreeT (Producer Word8 m) m x
     -&gt; Constant
          (FreeT (Producer Word8 m) m x) (FreeT (Producer Word8 m) m x))
    -&gt; Producer Word8 m x
    -&gt; Constant (FreeT (Producer Word8 m) m x) (Producer Word8 m x))
-&gt; FreeT (Producer Word8 m) m x
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Int
-&gt; Lens
     (Producer Word8 m x)
     (Producer Word8 m x)
     (FreeT (Producer Word8 m) m x)
     (FreeT (Producer Word8 m) m x)
forall (m :: * -&gt; *) a' x a.
Monad m =&gt;
Int
-&gt; Lens
     (Producer a' m x)
     (Producer a m x)
     (FreeT (Producer a' m) m x)
     (FreeT (Producer a m) m x)
</span><span class="hs-identifier hs-var">PG.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier hs-var">defaultChunkSize</span></span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621679059956"><span class="annot"><span class="annottext">step :: ([a] -&gt; c) -&gt; a -&gt; [a] -&gt; c
</span><a href="#local-6989586621679059956"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679059953"><span class="annot"><span class="annottext">[a] -&gt; c
</span><a href="#local-6989586621679059953"><span class="hs-identifier hs-var">diffAs</span></a></span></span><span> </span><span id="local-6989586621679059952"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059952"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; c
</span><a href="#local-6989586621679059953"><span class="hs-identifier hs-var">diffAs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; c) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059952"><span class="hs-identifier hs-var">w8</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>
</span><span id="line-880"></span><span>    </span><span id="local-6989586621679059955"><span class="annot"><span class="annottext">done :: ([a] -&gt; [Word8]) -&gt; ByteString
</span><a href="#local-6989586621679059955"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679059951"><span class="annot"><span class="annottext">[a] -&gt; [Word8]
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">diffAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [Word8]
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">diffAs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#_pack"><span class="hs-pragma hs-type">_pack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span id="local-6989586621679060515"><span id="local-6989586621679060516"><span class="annot"><a href="Pipes.ByteString.html#_unpack"><span class="hs-identifier hs-type">_unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060515"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><a href="#local-6989586621679060516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060515"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-884"></span><span id="_unpack"><span class="annot"><span class="annottext">_unpack :: Producer ByteString m x -&gt; Producer Word8 m x
</span><a href="Pipes.ByteString.html#_unpack"><span class="hs-identifier hs-var hs-var">_unpack</span></a></span></span><span> </span><span id="local-6989586621679059949"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059949"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; (ByteString -&gt; Proxy X () () Word8 m ()) -&gt; Producer Word8 m x
forall (m :: * -&gt; *) x' x b' b a' c' c.
Functor m =&gt;
Proxy x' x b' b m a'
-&gt; (b -&gt; Proxy x' x c' c m b') -&gt; Proxy x' x c' c m a'
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059949"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; Proxy X () () Word8 m ()
forall (m :: * -&gt; *) (f :: * -&gt; *) a x' x.
(Functor m, Foldable f) =&gt;
f a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Proxy X () () Word8 m ())
-&gt; (ByteString -&gt; [Word8])
-&gt; ByteString
-&gt; Proxy X () () Word8 m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><span class="hs-identifier hs-var">BS.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-885"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#_unpack"><span class="hs-pragma hs-type">_unpack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span class="hs-comment">{-| Group byte stream chunks into chunks of fixed length

    Note: This is the /only/ function in this API that concatenates
    'ByteString' chunks, which requires allocating new `ByteString`s
-}</span><span>
</span><span id="line-892"></span><span id="local-6989586621679059945"><span id="local-6989586621679059946"><span id="local-6989586621679059947"><span class="annot"><a href="Pipes.ByteString.html#chunksOf%27"><span class="hs-identifier hs-type">chunksOf'</span></a></span><span>
</span><span id="line-893"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059947"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679059946"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059946"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059947"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059945"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059947"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059945"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-895"></span><span id="chunksOf%27"><span class="annot"><span class="annottext">chunksOf' :: n -&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#chunksOf%27"><span class="hs-identifier hs-var hs-var">chunksOf'</span></a></span></span><span> </span><span id="local-6989586621679059944"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059943"><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><span class="annottext">(([ByteString] -&gt; [ByteString])
 -&gt; ByteString -&gt; [ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; (([ByteString] -&gt; [ByteString]) -&gt; ByteString)
-&gt; FreeT (Producer ByteString m) m r
-&gt; Producer ByteString m r
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; FreeT (Producer a m) m r -&gt; Producer b m r
</span><span class="hs-identifier hs-var">PG.folds</span></span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059942"><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679059942"><span class="hs-identifier hs-var">diffBs</span></a></span></span><span> </span><span id="local-6989586621679059941"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059941"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679059942"><span class="hs-identifier hs-var">diffBs</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059941"><span class="hs-identifier hs-var">bs</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>        </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-899"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059940"><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679059940"><span class="hs-identifier hs-var">diffBs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679059940"><span class="hs-identifier hs-var">diffBs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m r
</span><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m r
-&gt; ((FreeT (Producer ByteString m) m r
     -&gt; Constant
          (FreeT (Producer ByteString m) m r)
          (FreeT (Producer ByteString m) m r))
    -&gt; Producer ByteString m r
    -&gt; Constant
         (FreeT (Producer ByteString m) m r) (Producer ByteString m r))
-&gt; FreeT (Producer ByteString m) m r
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">n
-&gt; Lens'
     (Producer ByteString m r) (FreeT (Producer ByteString m) m r)
forall (m :: * -&gt; *) n x.
(Monad m, Integral n) =&gt;
n
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#chunksOf%27"><span class="hs-pragma hs-type">chunksOf'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span class="hs-comment">-- | Split a byte stream into 'FreeT'-delimited byte streams of fixed size</span><span>
</span><span id="line-904"></span><span id="local-6989586621679060486"><span id="local-6989586621679060487"><span id="local-6989586621679060488"><span class="annot"><a href="Pipes.ByteString.html#chunksOf"><span class="hs-identifier hs-type">chunksOf</span></a></span><span>
</span><span id="line-905"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060488"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679060487"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060487"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060488"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060486"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060488"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679060488"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060486"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-907"></span><span id="chunksOf"><span class="annot"><span class="annottext">chunksOf :: n
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#chunksOf"><span class="hs-identifier hs-var hs-var">chunksOf</span></a></span></span><span> </span><span id="local-6989586621679059938"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059937"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059937"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059936"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059936"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">concats</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059937"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059936"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-909"></span><span>    </span><span id="local-6989586621679059935"><span class="annot"><span class="annottext">go :: Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679059934"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059934"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="annot"><span class="annottext">(m (FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
 -&gt; FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-910"></span><span>        </span><span id="local-6989586621679059932"><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059932"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (ByteString, Producer ByteString m a))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059934"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-911"></span><span>        </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Proxy X () () ByteString m)
   a
   (FreeT (Proxy X () () ByteString m) m a)
 -&gt; m (FreeF
         (Proxy X () () ByteString m)
         a
         (FreeT (Proxy X () () ByteString m) m a)))
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059932"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-912"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059931"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059931"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059931"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-913"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059929"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059929"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059928"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059928"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy
   X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
 -&gt; FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-914"></span><span>                </span><span id="local-6989586621679059926"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059926"><span class="hs-identifier hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059929"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059928"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; ((Producer ByteString m (Producer ByteString m a)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m a))
          (Producer ByteString m (Producer ByteString m a)))
    -&gt; Producer ByteString m a
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m a))
         (Producer ByteString m a))
-&gt; Producer ByteString m (Producer ByteString m a)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">n
-&gt; Lens'
     (Producer ByteString m a)
     (Producer ByteString m (Producer ByteString m a))
forall (m :: * -&gt; *) n x.
(Monad m, Integral n) =&gt;
n
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-915"></span><span>                </span><span class="annot"><span class="annottext">FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059926"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#chunksOf"><span class="hs-pragma hs-type">chunksOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-917"></span><span>
</span><span id="line-918"></span><span class="hs-comment">{-| Split a byte stream into groups separated by bytes that satisfy the
    predicate
-}</span><span>
</span><span id="line-921"></span><span id="local-6989586621679060456"><span id="local-6989586621679060457"><span class="annot"><a href="Pipes.ByteString.html#splitsWith"><span class="hs-identifier hs-type">splitsWith</span></a></span><span>
</span><span id="line-922"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060457"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-923"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060457"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060456"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060457"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679060457"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060456"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-925"></span><span id="splitsWith"><span class="annot"><span class="annottext">splitsWith :: (Word8 -&gt; Bool)
-&gt; Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
</span><a href="Pipes.ByteString.html#splitsWith"><span class="hs-identifier hs-var hs-var">splitsWith</span></a></span></span><span> </span><span id="local-6989586621679059925"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679059925"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679059924"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059924"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
-&gt; FreeT (Producer ByteString m) m x
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; m (FreeF
        (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059924"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-927"></span><span>    </span><span id="local-6989586621679059923"><span class="annot"><span class="annottext">go0 :: Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var hs-var">go0</span></a></span></span><span> </span><span id="local-6989586621679059922"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-928"></span><span>        </span><span id="local-6989586621679059921"><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (ByteString, Producer ByteString m a))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-929"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-930"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059920"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059919"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059918"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-932"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-934"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621679059917"><span class="annot"><span class="annottext">go1 :: Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var hs-var">go1</span></a></span></span><span> </span><span id="local-6989586621679059916"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Proxy X () () ByteString m)
   a
   (FreeT (Proxy X () () ByteString m) m a)
 -&gt; m (FreeF
         (Proxy X () () ByteString m)
         a
         (FreeT (Proxy X () () ByteString m) m a)))
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy
   X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
 -&gt; FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>        </span><span id="local-6989586621679059915"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; ((Producer ByteString m (Producer ByteString m a)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m a))
          (Producer ByteString m (Producer ByteString m a)))
    -&gt; Producer ByteString m a
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m a))
         (Producer ByteString m a))
-&gt; Producer ByteString m (Producer ByteString m a)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m a)
     (Producer ByteString m (Producer ByteString m a))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679059925"><span class="hs-identifier hs-var">predicate</span></a></span><span>
</span><span id="line-937"></span><span>        </span><span class="annot"><span class="annottext">FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeT (Proxy X () () ByteString m) m a
 -&gt; Proxy
      X () () ByteString m (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="annot"><span class="annottext">(m (FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
 -&gt; FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-938"></span><span>            </span><span id="local-6989586621679059914"><span class="annot"><span class="annottext">Either a (Word8, Producer ByteString m a)
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (Word8, Producer ByteString m a))
forall (m :: * -&gt; *) r.
Monad m =&gt;
Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
</span><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier hs-var">nextByte</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-939"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (Word8, Producer ByteString m a)
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-940"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059913"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059912"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059912"><span class="hs-identifier hs-var">p''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059912"><span class="hs-identifier hs-var">p''</span></a></span><span>
</span><span id="line-942"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitsWith"><span class="hs-pragma hs-type">splitsWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="hs-comment">-- | Split a byte stream into groups separated by the given byte</span><span>
</span><span id="line-945"></span><span id="local-6989586621679059910"><span id="local-6989586621679059911"><span class="annot"><a href="Pipes.ByteString.html#splits"><span class="hs-identifier hs-type">splits</span></a></span><span>
</span><span id="line-946"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059911"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-947"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-948"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059911"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059911"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059911"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-949"></span><span id="splits"><span class="annot"><span class="annottext">splits :: Word8
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#splits"><span class="hs-identifier hs-var hs-var">splits</span></a></span></span><span> </span><span id="local-6989586621679059909"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span id="local-6989586621679059908"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059907"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-950"></span><span>    </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
Producer a m () -&gt; FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">PG.intercalates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Producer ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
</span><a href="Pipes.ByteString.html#splitsWith"><span class="hs-identifier hs-var">splitsWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-951"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splits"><span class="hs-pragma hs-type">splits</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="hs-comment">-- | Split a byte stream into groups separated by the given `ByteString`</span><span>
</span><span id="line-954"></span><span id="local-6989586621679059905"><span id="local-6989586621679059906"><span class="annot"><a href="Pipes.ByteString.html#splitOn"><span class="hs-identifier hs-type">splitOn</span></a></span><span>
</span><span id="line-955"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059906"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-956"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-957"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059906"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059906"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059906"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-958"></span><span id="splitOn"><span class="annot"><span class="annottext">splitOn :: ByteString
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#splitOn"><span class="hs-identifier hs-var hs-var">splitOn</span></a></span></span><span> </span><span id="local-6989586621679059904"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">needle</span></a></span></span><span> </span><span id="local-6989586621679059903"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059903"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059902"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059902"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-959"></span><span>    </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-960"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
Producer a m () -&gt; FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">PG.intercalates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Producer ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">needle</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059903"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059902"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-963"></span><span>    </span><span id="local-6989586621679059900"><span class="annot"><span class="annottext">len0 :: Int
</span><a href="#local-6989586621679059900"><span class="hs-identifier hs-var hs-var">len0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">needle</span></a></span><span>
</span><span id="line-964"></span><span>    </span><span id="local-6989586621679059901"><span class="annot"><span class="annottext">go :: Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059901"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679059899"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="annot"><span class="annottext">(m (FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
 -&gt; FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-965"></span><span>        </span><span id="local-6989586621679059898"><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (ByteString, Producer ByteString m a))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-966"></span><span>        </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Proxy X () () ByteString m)
   a
   (FreeT (Proxy X () () ByteString m) m a)
 -&gt; m (FreeF
         (Proxy X () () ByteString m)
         a
         (FreeT (Proxy X () () ByteString m) m a)))
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-967"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059897"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-968"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059896"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059895"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy
   X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
 -&gt; FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-969"></span><span>                </span><span id="local-6989586621679059894"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; ((Producer ByteString m (Producer ByteString m a)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m a))
          (Producer ByteString m (Producer ByteString m a)))
    -&gt; Producer ByteString m a
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m a))
         (Producer ByteString m a))
-&gt; Producer ByteString m (Producer ByteString m a)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
-&gt; Lens'
     (Producer ByteString m a)
     (Producer ByteString m (Producer ByteString m a))
forall (m :: * -&gt; *) x.
Monad m =&gt;
ByteString
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#breakOn"><span class="hs-identifier hs-var">breakOn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">needle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>                </span><span class="annot"><span class="annottext">FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) n r.
(Monad m, Integral n) =&gt;
n -&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059900"><span class="hs-identifier hs-var">len0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#splitOn"><span class="hs-pragma hs-type">splitOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="hs-comment">{-| Isomorphism between a byte stream and groups of identical bytes using the
    supplied equality predicate
-}</span><span>
</span><span id="line-976"></span><span id="local-6989586621679060437"><span id="local-6989586621679060438"><span class="annot"><a href="Pipes.ByteString.html#groupsBy"><span class="hs-identifier hs-type">groupsBy</span></a></span><span>
</span><span id="line-977"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060438"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-978"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-979"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060438"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060437"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060438"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679060438"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060437"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-980"></span><span id="groupsBy"><span class="annot"><span class="annottext">groupsBy :: (Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#groupsBy"><span class="hs-identifier hs-var hs-var">groupsBy</span></a></span></span><span> </span><span id="local-6989586621679059893"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679059893"><span class="hs-identifier hs-var">equals</span></a></span></span><span> </span><span id="local-6989586621679059892"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059892"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059891"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">concats</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059892"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">_groupsBy</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-982"></span><span>    </span><span class="hs-comment">-- _groupsBy</span><span>
</span><span id="line-983"></span><span>    </span><span class="hs-comment">--     :: Monad m</span><span>
</span><span id="line-984"></span><span>    </span><span class="hs-comment">--     =&gt; (Word8 -&gt; Word8 -&gt; Bool)</span><span>
</span><span id="line-985"></span><span>    </span><span class="hs-comment">--     -&gt; Producer ByteString m x</span><span>
</span><span id="line-986"></span><span>    </span><span class="hs-comment">--     -&gt; FreeT (Producer ByteString m) m x</span><span>
</span><span id="line-987"></span><span>    </span><span id="local-6989586621679059890"><span class="annot"><span class="annottext">_groupsBy :: Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var hs-var">_groupsBy</span></a></span></span><span> </span><span id="local-6989586621679059889"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059889"><span class="hs-identifier hs-var">p0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059889"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-989"></span><span>        </span><span id="local-6989586621679059888"><span class="annot"><span class="annottext">go :: Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679059887"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-990"></span><span>            </span><span id="local-6989586621679059886"><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059886"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (ByteString, Producer ByteString m a))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-991"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059886"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-992"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059885"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059885"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059885"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-993"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059884"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059883"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059883"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">BS.uncons</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-994"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059883"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-995"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059882"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var">w8</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-996"></span><span>                        </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Proxy X () () ByteString m)
   a
   (FreeT (Proxy X () () ByteString m) m a)
 -&gt; m (FreeF
         (Proxy X () () ByteString m)
         a
         (FreeT (Proxy X () () ByteString m) m a)))
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy
   X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
 -&gt; FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-997"></span><span>                            </span><span id="local-6989586621679059881"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059881"><span class="hs-identifier hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059883"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; ((Producer ByteString m (Producer ByteString m a)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m a))
          (Producer ByteString m (Producer ByteString m a)))
    -&gt; Producer ByteString m a
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m a))
         (Producer ByteString m a))
-&gt; Producer ByteString m (Producer ByteString m a)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m a)
     (Producer ByteString m (Producer ByteString m a))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679059893"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var">w8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span>                            </span><span class="annot"><span class="annottext">FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeT (Proxy X () () ByteString m) m a
 -&gt; Proxy
      X () () ByteString m (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059881"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groupsBy"><span class="hs-pragma hs-type">groupsBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1000"></span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- | Like 'groupsBy', where the equality predicate is ('==')</span><span>
</span><span id="line-1002"></span><span id="local-6989586621679059879"><span id="local-6989586621679059880"><span class="annot"><a href="Pipes.ByteString.html#groups"><span class="hs-identifier hs-type">groups</span></a></span><span>
</span><span id="line-1003"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059880"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1004"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059880"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059879"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059880"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059880"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059879"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1005"></span><span id="groups"><span class="annot"><span class="annottext">groups :: Lens' (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#groups"><span class="hs-identifier hs-var hs-var">groups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#groupsBy"><span class="hs-identifier hs-var">groupsBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-1006"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#groups"><span class="hs-pragma hs-type">groups</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1007"></span><span>
</span><span id="line-1008"></span><span class="hs-comment">{-| Improper lens between a bytestream and its lines

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-1014"></span><span id="local-6989586621679059877"><span id="local-6989586621679059878"><span class="annot"><a href="Pipes.ByteString.html#lines"><span class="hs-identifier hs-type">lines</span></a></span><span>
</span><span id="line-1015"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059878"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1016"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059877"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059878"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059877"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1017"></span><span id="lines"><span class="annot"><span class="annottext">lines :: Lens' (Producer ByteString m x) (FreeT (Producer ByteString m) m x)
</span><a href="Pipes.ByteString.html#lines"><span class="hs-identifier hs-var hs-var">lines</span></a></span></span><span> </span><span id="local-6989586621679059876"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059875"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_unlines"><span class="hs-identifier hs-var">_unlines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; f (FreeT (Producer ByteString m) m x)
</span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="Pipes.ByteString.html#_lines"><span class="hs-identifier hs-var">_lines</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#lines"><span class="hs-pragma hs-type">lines</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1019"></span><span>
</span><span id="line-1020"></span><span class="hs-comment">{-| Improper lens between lines and a bytestream

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-1026"></span><span id="local-6989586621679059871"><span id="local-6989586621679059872"><span class="annot"><a href="Pipes.ByteString.html#unlines"><span class="hs-identifier hs-type">unlines</span></a></span><span>
</span><span id="line-1027"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059872"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1028"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059872"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059871"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059871"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1029"></span><span id="unlines"><span class="annot"><span class="annottext">unlines :: Lens' (FreeT (Producer ByteString m) m x) (Producer ByteString m x)
</span><a href="Pipes.ByteString.html#unlines"><span class="hs-identifier hs-var hs-var">unlines</span></a></span></span><span> </span><span id="local-6989586621679059870"><span class="annot"><span class="annottext">Producer ByteString m x -&gt; f (Producer ByteString m x)
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679059869"><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x)
-&gt; f (Producer ByteString m x)
-&gt; f (FreeT (Producer ByteString m) m x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="Pipes.ByteString.html#_lines"><span class="hs-identifier hs-var">_lines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; f (Producer ByteString m x)
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) x.
Monad m =&gt;
FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_unlines"><span class="hs-identifier hs-var">_unlines</span></a></span><span> </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1030"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unlines"><span class="hs-pragma hs-type">unlines</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span id="local-6989586621679059867"><span id="local-6989586621679059868"><span class="annot"><a href="Pipes.ByteString.html#_lines"><span class="hs-identifier hs-type">_lines</span></a></span><span>
</span><span id="line-1033"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059867"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059868"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059867"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-1034"></span><span id="_lines"><span class="annot"><span class="annottext">_lines :: Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
</span><a href="Pipes.ByteString.html#_lines"><span class="hs-identifier hs-var hs-var">_lines</span></a></span></span><span> </span><span id="local-6989586621679059866"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
-&gt; FreeT (Producer ByteString m) m x
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; m (FreeF
        (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1036"></span><span>    </span><span id="local-6989586621679059865"><span class="annot"><span class="annottext">go0 :: Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var hs-var">go0</span></a></span></span><span> </span><span id="local-6989586621679059864"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1037"></span><span>        </span><span id="local-6989586621679059863"><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (ByteString, Producer ByteString m a))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1038"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (ByteString, Producer ByteString m a)
</span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1039"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059862"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059861"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059860"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1041"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-1043"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Proxy X () () ByteString m)
   a
   (FreeT (Proxy X () () ByteString m) m a)
 -&gt; m (FreeF
         (Proxy X () () ByteString m)
         a
         (FreeT (Proxy X () () ByteString m) m a)))
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy
   X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
 -&gt; FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
</span><a href="#local-6989586621679059859"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m a -&gt; Producer ByteString m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>    </span><span id="local-6989586621679059859"><span class="annot"><span class="annottext">go1 :: Producer ByteString m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
</span><a href="#local-6989586621679059859"><span class="hs-identifier hs-var hs-var">go1</span></a></span></span><span> </span><span id="local-6989586621679059858"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1045"></span><span>        </span><span id="local-6989586621679059857"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; ((Producer ByteString m (Producer ByteString m a)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m a))
          (Producer ByteString m (Producer ByteString m a)))
    -&gt; Producer ByteString m a
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m a))
         (Producer ByteString m a))
-&gt; Producer ByteString m (Producer ByteString m a)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Producer ByteString m (Producer ByteString m a)
 -&gt; Constant
      (Producer ByteString m (Producer ByteString m a))
      (Producer ByteString m (Producer ByteString m a)))
-&gt; Producer ByteString m a
-&gt; Constant
     (Producer ByteString m (Producer ByteString m a))
     (Producer ByteString m a)
forall (m :: * -&gt; *) x.
Monad m =&gt;
Lens'
  (Producer ByteString m x)
  (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#line"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-1046"></span><span>        </span><span class="annot"><span class="annottext">FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeT (Proxy X () () ByteString m) m a
 -&gt; Proxy
      X () () ByteString m (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
-&gt; Proxy
     X () () ByteString m (FreeT (Proxy X () () ByteString m) m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="annot"><span class="annottext">(m (FreeF
      (Proxy X () () ByteString m)
      a
      (FreeT (Proxy X () () ByteString m) m a))
 -&gt; FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
-&gt; FreeT (Proxy X () () ByteString m) m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1047"></span><span>            </span><span id="local-6989586621679059856"><span class="annot"><span class="annottext">Either a (Word8, Producer ByteString m a)
</span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (Either a (Word8, Producer ByteString m a))
forall (m :: * -&gt; *) r.
Monad m =&gt;
Producer ByteString m r
-&gt; m (Either r (Word8, Producer ByteString m r))
</span><a href="Pipes.ByteString.html#nextByte"><span class="hs-identifier hs-var">nextByte</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-1048"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a (Word8, Producer ByteString m a)
</span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1049"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059855"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeF
  (Proxy X () () ByteString m)
  a
  (FreeT (Proxy X () () ByteString m) m a)
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; FreeF
     (Proxy X () () ByteString m)
     a
     (FreeT (Proxy X () () ByteString m) m a)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059854"><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">p''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
-&gt; m (FreeF
        (Proxy X () () ByteString m)
        a
        (FreeT (Proxy X () () ByteString m) m a))
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m a
</span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">p''</span></a></span><span>
</span><span id="line-1051"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#_lines"><span class="hs-pragma hs-type">_lines</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span id="local-6989586621679060432"><span id="local-6989586621679060433"><span class="annot"><a href="Pipes.ByteString.html#_unlines"><span class="hs-identifier hs-type">_unlines</span></a></span><span>
</span><span id="line-1054"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679060433"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060433"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679060433"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060432"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679060433"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679060432"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-1055"></span><span id="_unlines"><span class="annot"><span class="annottext">_unlines :: FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#_unlines"><span class="hs-identifier hs-var hs-var">_unlines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">concats</span></span><span> </span><span class="annot"><span class="annottext">(FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x)
-&gt; (FreeT (Producer ByteString m) m x
    -&gt; FreeT (Producer ByteString m) m x)
-&gt; FreeT (Producer ByteString m) m x
-&gt; Producer ByteString m x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(forall r. Producer ByteString m r -&gt; Producer ByteString m r)
-&gt; FreeT (Producer ByteString m) m x
-&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) (g :: * -&gt; *) (f :: * -&gt; *) x.
(Monad m, Functor g) =&gt;
(forall r. f r -&gt; g r) -&gt; FreeT f m x -&gt; FreeT g m x
</span><span class="hs-identifier hs-var">PG.maps</span></span><span> </span><span class="annot"><span class="annottext">forall r. Producer ByteString m r -&gt; Producer ByteString m r
forall (m :: * -&gt; *) x' x a.
Functor m =&gt;
Proxy x' x () ByteString m a -&gt; Proxy x' x () ByteString m a
</span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">addNewline</span></a></span><span>
</span><span id="line-1056"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1057"></span><span>    </span><span id="local-6989586621679059852"><span class="annot"><span class="annottext">addNewline :: Proxy x' x () ByteString m a -&gt; Proxy x' x () ByteString m a
</span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var hs-var">addNewline</span></a></span></span><span> </span><span id="local-6989586621679059851"><span class="annot"><span class="annottext">Proxy x' x () ByteString m a
</span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m a
</span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy x' x () ByteString m a
-&gt; Proxy x' x () ByteString m () -&gt; Proxy x' x () ByteString m a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Proxy x' x () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Pipes.ByteString.html#nl"><span class="hs-identifier hs-var">nl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#_unlines"><span class="hs-pragma hs-type">_unlines</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span class="hs-comment">{-| Convert a bytestream to delimited words

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-1066"></span><span id="local-6989586621679059849"><span id="local-6989586621679059850"><span class="annot"><a href="Pipes.ByteString.html#words"><span class="hs-identifier hs-type">words</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059849"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059849"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-1067"></span><span id="words"><span class="annot"><span class="annottext">words :: Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
</span><a href="Pipes.ByteString.html#words"><span class="hs-identifier hs-var hs-var">words</span></a></span></span><span> </span><span id="local-6989586621679059848"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
-&gt; FreeT (Producer ByteString m) m x
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
m (FreeF f a (FreeT f m a)) -&gt; FreeT f m a
</span><span class="hs-identifier hs-var">PG.FreeT</span></span><span> </span><span class="annot"><span class="annottext">(m (FreeF
      (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
 -&gt; FreeT (Producer ByteString m) m x)
-&gt; m (FreeF
        (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
-&gt; FreeT (Producer ByteString m) m x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1068"></span><span>    </span><span id="local-6989586621679059847"><span class="annot"><span class="annottext">Either x (ByteString, Producer ByteString m x)
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; m (Either x (ByteString, Producer ByteString m x))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Producer a m r -&gt; m (Either r (a, Producer a m r))
</span><span class="hs-identifier hs-var">next</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Producer ByteString m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) r.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Producer ByteString m r -&gt; Producer ByteString m r
</span><a href="Pipes.ByteString.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isSpaceWord8</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span>    </span><span class="annot"><span class="annottext">FreeF (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
-&gt; m (FreeF
        (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeF
   (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
 -&gt; m (FreeF
         (Producer ByteString m) x (FreeT (Producer ByteString m) m x)))
-&gt; FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
-&gt; m (FreeF
        (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either x (ByteString, Producer ByteString m x)
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1070"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059846"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
-&gt; FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
forall (f :: * -&gt; *) a b. a -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Pure</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1071"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059845"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059844"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m (FreeT (Producer ByteString m) m x)
-&gt; FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
forall (f :: * -&gt; *) a b. f b -&gt; FreeF f a b
</span><span class="hs-identifier hs-var">PG.Free</span></span><span> </span><span class="annot"><span class="annottext">(Proxy X () () ByteString m (FreeT (Producer ByteString m) m x)
 -&gt; FreeF
      (Producer ByteString m) x (FreeT (Producer ByteString m) m x))
-&gt; Proxy X () () ByteString m (FreeT (Producer ByteString m) m x)
-&gt; FreeF
     (Producer ByteString m) x (FreeT (Producer ByteString m) m x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1072"></span><span>            </span><span id="local-6989586621679059843"><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Proxy X () () ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () ByteString m ()
-&gt; Producer ByteString m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Producer ByteString m x
-&gt; ((Producer ByteString m (Producer ByteString m x)
     -&gt; Constant
          (Producer ByteString m (Producer ByteString m x))
          (Producer ByteString m (Producer ByteString m x)))
    -&gt; Producer ByteString m x
    -&gt; Constant
         (Producer ByteString m (Producer ByteString m x))
         (Producer ByteString m x))
-&gt; Producer ByteString m (Producer ByteString m x)
forall a b. a -&gt; ((b -&gt; Constant b b) -&gt; a -&gt; Constant b a) -&gt; b
</span><a href="Pipes.ByteString.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
forall (m :: * -&gt; *) x.
Monad m =&gt;
(Word8 -&gt; Bool)
-&gt; Lens'
     (Producer ByteString m x)
     (Producer ByteString m (Producer ByteString m x))
</span><a href="Pipes.ByteString.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isSpaceWord8</span></span><span>
</span><span id="line-1073"></span><span>            </span><span class="annot"><span class="annottext">FreeT (Producer ByteString m) m x
-&gt; Proxy X () () ByteString m (FreeT (Producer ByteString m) m x)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Producer ByteString m x -&gt; FreeT (Producer ByteString m) m x
forall (m :: * -&gt; *) a.
Monad m =&gt;
Producer ByteString m a -&gt; FreeT (Proxy X () () ByteString m) m a
</span><a href="Pipes.ByteString.html#words"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">Producer ByteString m x
</span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#words"><span class="hs-pragma hs-type">words</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1075"></span><span>
</span><span id="line-1076"></span><span class="hs-comment">{-| Convert delimited words back to a byte stream

    Note: This function is purely for demonstration purposes since it assumes a
    particular encoding.  You should prefer the 'Data.Text.Text' equivalent of
    this function from the @pipes-text@ library.
-}</span><span>
</span><span id="line-1082"></span><span id="local-6989586621679059841"><span id="local-6989586621679059842"><span class="annot"><a href="Pipes.ByteString.html#unwords"><span class="hs-identifier hs-type">unwords</span></a></span><span>
</span><span id="line-1083"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059842"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059841"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Producer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679059842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059841"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-1084"></span><span id="unwords"><span class="annot"><span class="annottext">unwords :: FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
</span><a href="Pipes.ByteString.html#unwords"><span class="hs-identifier hs-var hs-var">unwords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer ByteString m ()
-&gt; FreeT (Producer ByteString m) m x -&gt; Producer ByteString m x
forall (m :: * -&gt; *) a x.
Monad m =&gt;
Producer a m () -&gt; FreeT (Producer a m) m x -&gt; Producer a m x
</span><span class="hs-identifier hs-var">PG.intercalates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Producer ByteString m ()
forall (m :: * -&gt; *) a x' x. Functor m =&gt; a -&gt; Proxy x' x () a m ()
</span><span class="hs-identifier hs-var">yield</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Producer ByteString m ())
-&gt; ByteString -&gt; Producer ByteString m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; ByteString) -&gt; Word8 -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Pipes.ByteString.html#unwords"><span class="hs-pragma hs-type">unwords</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1086"></span><span>
</span><span id="line-1087"></span><span class="hs-comment">{- $parse
    The following parsing utilities are single-byte analogs of the ones found
    in @pipes-parse@.
-}</span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span class="hs-comment">{- $reexports
    @Data.ByteString@ re-exports the 'ByteString' type.

    @Data.Word@ re-exports the 'Word8' type.

    @Pipes.Parse@ re-exports 'Parser'.

    @Pipes.Group@ re-exports 'concats', 'intercalates', and 'FreeT'
    (the type).
-}</span><span>
</span><span id="line-1102"></span></pre></body></html>