<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls, FlexibleContexts, FlexibleInstances
  , MultiParamTypeClasses, TypeFamilies
  #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | This module provides the 'HeapItem' type family along with necessary</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- instance declarations used to translate between inserted items and the</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- priority-value pairs needed by the minimum priority heap of the module</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- &quot;Data.Heap.Internal&quot;.</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Heap.Item</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Type aliases</span></span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier">Heap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinHeap"><span class="hs-identifier">MinHeap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxHeap"><span class="hs-identifier">MaxHeap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPrioHeap"><span class="hs-identifier">MinPrioHeap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPrioHeap"><span class="hs-identifier">MaxPrioHeap</span></a></span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><span class="hs-comment">-- * The HeapItem type family</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier">HeapItem</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier">MinPolicy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier">MaxPolicy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier">FstMinPolicy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier">FstMaxPolicy</span></a></span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Auxiliary functions</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#splitF"><span class="hs-identifier">splitF</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Heap.Internal.html"><span class="hs-identifier">Data.Heap.Internal</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | This type alias is an abbreviation for a 'HeapT' which uses the 'HeapItem'</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- instance of @pol item@ to organise its elements.</span><span>
</span><span id="line-25"></span><span class="hs-keyword">type</span><span> </span><span id="Heap"><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier hs-var">Heap</span></a></span></span><span> </span><span id="local-6989586621679037293"><span class="annot"><a href="#local-6989586621679037293"><span class="hs-identifier hs-type">pol</span></a></span></span><span> </span><span id="local-6989586621679037292"><span class="annot"><a href="#local-6989586621679037292"><span class="hs-identifier hs-type">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Heap.Internal.html#HeapT"><span class="hs-identifier hs-type">HeapT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037293"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037292"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037293"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037292"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | A 'Heap' which will always extract the minimum first.</span><span>
</span><span id="line-28"></span><span class="hs-keyword">type</span><span> </span><span id="MinHeap"><span class="annot"><a href="Data.Heap.Item.html#MinHeap"><span class="hs-identifier hs-var">MinHeap</span></a></span></span><span> </span><span id="local-6989586621679037290"><span class="annot"><a href="#local-6989586621679037290"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier hs-type">Heap</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037290"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | A 'Heap' which will always extract the maximum first.</span><span>
</span><span id="line-31"></span><span class="hs-keyword">type</span><span> </span><span id="MaxHeap"><span class="annot"><a href="Data.Heap.Item.html#MaxHeap"><span class="hs-identifier hs-var">MaxHeap</span></a></span></span><span> </span><span id="local-6989586621679037289"><span class="annot"><a href="#local-6989586621679037289"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier hs-type">Heap</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037289"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | A 'Heap' storing priority-value pairs @(prio, val)@. The order of elements</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- is solely determined by the priority @prio@, the value @val@ has no influence.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- The priority-value pair with minmal priority will always be extracted first.</span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="MinPrioHeap"><span class="annot"><a href="Data.Heap.Item.html#MinPrioHeap"><span class="hs-identifier hs-var">MinPrioHeap</span></a></span></span><span> </span><span id="local-6989586621679037288"><span class="annot"><a href="#local-6989586621679037288"><span class="hs-identifier hs-type">prio</span></a></span></span><span> </span><span id="local-6989586621679037287"><span class="annot"><a href="#local-6989586621679037287"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier hs-type">Heap</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037288"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037287"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | A 'Heap' storing priority-value pairs @(prio, val)@. The order of elements</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- is solely determined by the priority @prio@, the value @val@ has no influence.</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- The priority-value pair with maximum priority will always be extracted first.</span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span id="MaxPrioHeap"><span class="annot"><a href="Data.Heap.Item.html#MaxPrioHeap"><span class="hs-identifier hs-var">MaxPrioHeap</span></a></span></span><span> </span><span id="local-6989586621679037286"><span class="annot"><a href="#local-6989586621679037286"><span class="hs-identifier hs-type">prio</span></a></span></span><span> </span><span id="local-6989586621679037285"><span class="annot"><a href="#local-6989586621679037285"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Heap"><span class="hs-identifier hs-type">Heap</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037286"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037285"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | @'HeapItem' pol item@ is a type class for items that can be stored in a</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- 'HeapT'. A raw @'HeapT' prio val@ only provides a minimum priority heap (i. e.</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- @val@ doesn't influence the ordering of elements and the pair with minimal</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- @prio@ will be extracted first, see 'HeapT' documentation). The job of this</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- class is to translate between arbitrary @item@s and priority-value pairs</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- @('Prio' pol item, 'Val' pol item)@, depending on the policy @pol@ to be used.</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- This way, we are able to use 'HeapT' not only as 'MinPrioHeap', but also as</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- 'MinHeap', 'MaxHeap', 'MaxPrioHeap' or a custom implementation. In short: The</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- job of this class is to deconstruct arbitrary @item@s into a @(prio, val)@</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- pairs that can be handled by a minimum priority 'HeapT'.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Example: Consider you want to use @'HeapT' prio val@ as a @'MaxHeap' a@. You</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- would have to invert the order of @a@ (e. g. by introducing @newtype InvOrd a</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- = InvOrd a@ along with an apropriate 'Ord' instance for it) and then use a</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- @type 'MaxHeap' a = 'HeapT' (InvOrd a) ()@. You'd also have to translate</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- every @x@ to @(InvOrd x, ())@ before insertion and back after removal in</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- order to retrieve your original type @a@.</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- This functionality is provided by the 'HeapItem' class. In the above example,</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- you'd use a 'MaxHeap'. The according instance declaration is of course</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- already provided and looks like this (simplified):</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- @data 'MaxPolicy'</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- instance ('Ord' a) =&gt; 'HeapItem' 'MaxPolicy' a where</span><span>
</span><span id="line-68"></span><span class="hs-comment">--     newtype 'Prio' 'MaxPolicy' a = MaxP a deriving ('Eq')</span><span>
</span><span id="line-69"></span><span class="hs-comment">--     type    'Val'  'MaxPolicy' a = ()</span><span>
</span><span id="line-70"></span><span class="hs-comment">--     'split' x           = (MaxP x, ())</span><span>
</span><span id="line-71"></span><span class="hs-comment">--     'merge' (MaxP x, _) = x</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- instance ('Ord' a) =&gt; 'Ord' ('Prio' 'MaxPolicy' a) where</span><span>
</span><span id="line-74"></span><span class="hs-comment">--     'compare' (MaxP x) (MaxP y) = 'compare' y x</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- 'MaxPolicy' is a phantom type describing which 'HeapItem' instance is actually</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- meant (e. g. we have to distinguish between 'MinHeap' and 'MaxHeap', which is</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- done via 'MinPolicy' and 'MaxPolicy', respectively) and @MaxP@ inverts the</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- ordering of @a@, so that the maximum will be on top of the 'HeapT'.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- The conversion functions 'split' and 'merge' have to make sure that</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- (1) @forall p v. 'split' ('merge' (p, v)) == (p, v)@ ('merge' and 'split'</span><span>
</span><span id="line-85"></span><span class="hs-comment">--     don't remove, add or alter anything)</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- (2) @forall p v f. 'fst' ('split' ('merge' (p, f v)) == 'fst' ('split'</span><span>
</span><span id="line-88"></span><span class="hs-comment">--     ('merge' (p, v)))@ (modifying the associated value @v@ doesn't alter the</span><span>
</span><span id="line-89"></span><span class="hs-comment">--      priority @p@)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HeapItem"><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-var">HeapItem</span></a></span></span><span> </span><span id="local-6989586621679037362"><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span></span><span> </span><span id="local-6989586621679037361"><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- | The part of @item@ that determines the order of elements on a 'HeapT'.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Prio"><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-var">Prio</span></a></span></span><span> </span><span id="local-6989586621679037362"><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span></span><span> </span><span id="local-6989586621679037361"><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- | Everything not part of @'Prio' pol item@</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Val"><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>  </span><span id="local-6989586621679037362"><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span></span><span> </span><span id="local-6989586621679037361"><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- | Translate an @item@ into a priority-value pair.</span><span>
</span><span id="line-97"></span><span>    </span><span id="split"><span class="annot"><a href="Data.Heap.Item.html#split"><span class="hs-identifier hs-type">split</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- | Restore the @item@ from a priority-value pair.</span><span>
</span><span id="line-99"></span><span>    </span><span id="merge"><span class="annot"><a href="Data.Heap.Item.html#merge"><span class="hs-identifier hs-type">merge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037362"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679037361"><span class="hs-identifier hs-type">item</span></a></span><span>
</span><span id="line-100"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;split/merge&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679037282"><span class="annot"><a href="#local-6989586621679037282"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#split"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Heap.Item.html#merge"><span class="hs-pragma hs-type">merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037282"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679037282"><span class="hs-pragma hs-type">x</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Policy type for a 'MinHeap'.</span><span>
</span><span id="line-103"></span><span class="hs-keyword">data</span><span> </span><span id="MinPolicy"><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-var">MinPolicy</span></a></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679037281"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037281"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-type">HeapItem</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">newtype</span><span> </span><span id="Prio"><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-var">Prio</span></a></span></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MinP"><span class="annot"><a href="Data.Heap.Item.html#MinP"><span class="hs-identifier hs-var">MinP</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unMinP"><span class="annot"><span class="annottext">Prio MinPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMinP"><span class="hs-identifier hs-var hs-var">unMinP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679037281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037271"><span id="local-6989586621679037273"><span class="annot"><span class="annottext">Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
(Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; Eq (Prio MinPolicy a)
forall a. Eq a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
== :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c== :: forall a. Eq a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037255"><span id="local-6989586621679037257"><span id="local-6989586621679037259"><span id="local-6989586621679037261"><span id="local-6989586621679037263"><span id="local-6989586621679037265"><span id="local-6989586621679037267"><span class="annot"><span class="annottext">Eq (Prio MinPolicy a)
Eq (Prio MinPolicy a)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Ordering)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a)
-&gt; (Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a)
-&gt; Ord (Prio MinPolicy a)
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Ordering
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Prio MinPolicy a)
forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Ordering
forall a.
Ord a =&gt;
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
min :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
$cmin :: forall a.
Ord a =&gt;
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
max :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
$cmax :: forall a.
Ord a =&gt;
Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Prio MinPolicy a
&gt;= :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
&gt; :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
&lt;= :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
&lt; :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Bool
compare :: Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; Prio MinPolicy a -&gt; Prio MinPolicy a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (Prio MinPolicy a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">type</span><span>    </span><span id="Val"><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>  </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679037253"><span class="annot"><span class="annottext">split :: a -&gt; (Prio MinPolicy a, Val MinPolicy a)
</span><a href="#local-6989586621679037253"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679037252"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037252"><span class="hs-identifier hs-var">x</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Prio MinPolicy a
forall a. a -&gt; Prio MinPolicy a
</span><a href="Data.Heap.Item.html#MinP"><span class="hs-identifier hs-var">MinP</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037252"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679037251"><span class="annot"><span class="annottext">merge :: (Prio MinPolicy a, Val MinPolicy a) -&gt; a
</span><a href="#local-6989586621679037251"><span class="hs-identifier hs-var hs-var hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#MinP"><span class="hs-identifier hs-type">MinP</span></a></span><span> </span><span id="local-6989586621679037250"><span class="annot"><a href="#local-6989586621679037250"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Val MinPolicy a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037250"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679037249"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037245"><span id="local-6989586621679037247"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679037249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679037241"><span class="annot"><span class="annottext">readPrec :: ReadPrec (Prio MinPolicy a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Prio MinPolicy a)
-&gt; ReadPrec a -&gt; ReadPrec (Prio MinPolicy a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Prio MinPolicy a
forall a. a -&gt; Prio MinPolicy a
</span><a href="Data.Heap.Item.html#MinP"><span class="hs-identifier hs-var">MinP</span></a></span><span> </span><span class="annot"><span class="annottext">ReadPrec a
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679037239"><span class="annot"><span class="annottext">readListPrec :: ReadPrec [Prio MinPolicy a]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readListPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Prio MinPolicy a])
-&gt; ReadPrec [a] -&gt; ReadPrec [Prio MinPolicy a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Prio MinPolicy a) -&gt; [a] -&gt; [Prio MinPolicy a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Prio MinPolicy a
forall a. a -&gt; Prio MinPolicy a
</span><a href="Data.Heap.Item.html#MinP"><span class="hs-identifier hs-var">MinP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadPrec [a]
forall a. Read a =&gt; ReadPrec [a]
</span><span class="hs-identifier hs-var">readListPrec</span></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679037237"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679037237"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MinPolicy"><span class="hs-identifier hs-type">MinPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037237"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679037232"><span class="annot"><span class="annottext">show :: Prio MinPolicy a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; String)
-&gt; (Prio MinPolicy a -&gt; a) -&gt; Prio MinPolicy a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio MinPolicy a -&gt; a
forall a. Prio MinPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMinP"><span class="hs-identifier hs-var hs-var">unMinP</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679037229"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Prio MinPolicy a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679037227"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037227"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037227"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ShowS)
-&gt; (Prio MinPolicy a -&gt; a) -&gt; Prio MinPolicy a -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio MinPolicy a -&gt; a
forall a. Prio MinPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMinP"><span class="hs-identifier hs-var hs-var">unMinP</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679037226"><span class="annot"><span class="annottext">showList :: [Prio MinPolicy a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showList</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ShowS
forall a. Show a =&gt; [a] -&gt; ShowS
</span><span class="hs-identifier hs-var">showList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; ShowS)
-&gt; ([Prio MinPolicy a] -&gt; [a]) -&gt; [Prio MinPolicy a] -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prio MinPolicy a -&gt; a) -&gt; [Prio MinPolicy a] -&gt; [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prio MinPolicy a -&gt; a
forall a. Prio MinPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMinP"><span class="hs-identifier hs-var hs-var">unMinP</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Policy type for a 'MaxHeap'.</span><span>
</span><span id="line-122"></span><span class="hs-keyword">data</span><span> </span><span id="MaxPolicy"><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-var">MaxPolicy</span></a></span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621679037224"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-type">HeapItem</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">newtype</span><span> </span><span id="Prio"><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-var">Prio</span></a></span></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MaxP"><span class="annot"><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-var">MaxP</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unMaxP"><span class="annot"><span class="annottext">Prio MaxPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMaxP"><span class="hs-identifier hs-var hs-var">unMaxP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679037224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037215"><span id="local-6989586621679037217"><span class="annot"><span class="annottext">Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
(Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool)
-&gt; (Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool)
-&gt; Eq (Prio MaxPolicy a)
forall a. Eq a =&gt; Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
== :: Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
$c== :: forall a. Eq a =&gt; Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">type</span><span>    </span><span id="Val"><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>  </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679037214"><span class="annot"><span class="annottext">split :: a -&gt; (Prio MaxPolicy a, Val MaxPolicy a)
</span><a href="#local-6989586621679037214"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679037213"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037213"><span class="hs-identifier hs-var">x</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Prio MaxPolicy a
forall a. a -&gt; Prio MaxPolicy a
</span><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-var">MaxP</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037213"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679037212"><span class="annot"><span class="annottext">merge :: (Prio MaxPolicy a, Val MaxPolicy a) -&gt; a
</span><a href="#local-6989586621679037212"><span class="hs-identifier hs-var hs-var hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-type">MaxP</span></a></span><span> </span><span id="local-6989586621679037211"><span class="annot"><a href="#local-6989586621679037211"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Val MaxPolicy a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037211"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621679037210"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037196"><span id="local-6989586621679037198"><span id="local-6989586621679037200"><span id="local-6989586621679037202"><span id="local-6989586621679037204"><span id="local-6989586621679037206"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679037195"><span class="annot"><span class="annottext">compare :: Prio MaxPolicy a -&gt; Prio MaxPolicy a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-type">MaxP</span></a></span><span> </span><span id="local-6989586621679037193"><span class="annot"><a href="#local-6989586621679037193"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-type">MaxP</span></a></span><span> </span><span id="local-6989586621679037192"><span class="annot"><a href="#local-6989586621679037192"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037192"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037193"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679037191"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037187"><span id="local-6989586621679037189"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679037191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679037184"><span class="annot"><span class="annottext">readPrec :: ReadPrec (Prio MaxPolicy a)
</span><a href="#local-6989586621679037184"><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Prio MaxPolicy a)
-&gt; ReadPrec a -&gt; ReadPrec (Prio MaxPolicy a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Prio MaxPolicy a
forall a. a -&gt; Prio MaxPolicy a
</span><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-var">MaxP</span></a></span><span> </span><span class="annot"><span class="annottext">ReadPrec a
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679037183"><span class="annot"><span class="annottext">readListPrec :: ReadPrec [Prio MaxPolicy a]
</span><a href="#local-6989586621679037183"><span class="hs-identifier hs-var hs-var hs-var hs-var">readListPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Prio MaxPolicy a])
-&gt; ReadPrec [a] -&gt; ReadPrec [Prio MaxPolicy a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Prio MaxPolicy a) -&gt; [a] -&gt; [Prio MaxPolicy a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Prio MaxPolicy a
forall a. a -&gt; Prio MaxPolicy a
</span><a href="Data.Heap.Item.html#MaxP"><span class="hs-identifier hs-var">MaxP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadPrec [a]
forall a. Read a =&gt; ReadPrec [a]
</span><span class="hs-identifier hs-var">readListPrec</span></span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679037182"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679037182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#MaxPolicy"><span class="hs-identifier hs-type">MaxPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679037178"><span class="annot"><span class="annottext">show :: Prio MaxPolicy a -&gt; String
</span><a href="#local-6989586621679037178"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; String)
-&gt; (Prio MaxPolicy a -&gt; a) -&gt; Prio MaxPolicy a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio MaxPolicy a -&gt; a
forall a. Prio MaxPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMaxP"><span class="hs-identifier hs-var hs-var">unMaxP</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679037177"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Prio MaxPolicy a -&gt; ShowS
</span><a href="#local-6989586621679037177"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679037176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037176"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037176"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ShowS)
-&gt; (Prio MaxPolicy a -&gt; a) -&gt; Prio MaxPolicy a -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio MaxPolicy a -&gt; a
forall a. Prio MaxPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMaxP"><span class="hs-identifier hs-var hs-var">unMaxP</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679037175"><span class="annot"><span class="annottext">showList :: [Prio MaxPolicy a] -&gt; ShowS
</span><a href="#local-6989586621679037175"><span class="hs-identifier hs-var hs-var hs-var hs-var">showList</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ShowS
forall a. Show a =&gt; [a] -&gt; ShowS
</span><span class="hs-identifier hs-var">showList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; ShowS)
-&gt; ([Prio MaxPolicy a] -&gt; [a]) -&gt; [Prio MaxPolicy a] -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prio MaxPolicy a -&gt; a) -&gt; [Prio MaxPolicy a] -&gt; [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prio MaxPolicy a -&gt; a
forall a. Prio MaxPolicy a -&gt; a
</span><a href="Data.Heap.Item.html#unMaxP"><span class="hs-identifier hs-var hs-var">unMaxP</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Policy type for a @(prio, val)@ 'MinPrioHeap'.</span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="FstMinPolicy"><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-var">FstMinPolicy</span></a></span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621679037173"><span id="local-6989586621679037174"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037174"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-type">HeapItem</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037174"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037173"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">newtype</span><span> </span><span id="Prio"><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-var">Prio</span></a></span></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037174"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037173"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FMinP"><span class="annot"><a href="Data.Heap.Item.html#FMinP"><span class="hs-identifier hs-var">FMinP</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFMinP"><span class="annot"><span class="annottext">Prio FstMinPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMinP"><span class="hs-identifier hs-var hs-var">unFMinP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679037174"><span class="hs-identifier hs-type">prio</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037164"><span id="local-6989586621679037166"><span class="annot"><span class="annottext">Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
(Prio FstMinPolicy (prio, val)
 -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; Eq (Prio FstMinPolicy (prio, val))
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall prio val.
Eq prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
/= :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c/= :: forall prio val.
Eq prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
== :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c== :: forall prio val.
Eq prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037149"><span id="local-6989586621679037151"><span id="local-6989586621679037153"><span id="local-6989586621679037155"><span id="local-6989586621679037157"><span id="local-6989586621679037159"><span id="local-6989586621679037161"><span class="annot"><span class="annottext">Eq (Prio FstMinPolicy (prio, val))
Eq (Prio FstMinPolicy (prio, val))
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Ordering)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val))
-&gt; (Prio FstMinPolicy (prio, val)
    -&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val))
-&gt; Ord (Prio FstMinPolicy (prio, val))
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Ordering
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall prio val. Ord prio =&gt; Eq (Prio FstMinPolicy (prio, val))
forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Ordering
forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
min :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
$cmin :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
max :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
$cmax :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Prio FstMinPolicy (prio, val)
&gt;= :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c&gt;= :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
&gt; :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c&gt; :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
&lt;= :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c&lt;= :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
&lt; :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
$c&lt; :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Bool
compare :: Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Ordering
$ccompare :: forall prio val.
Ord prio =&gt;
Prio FstMinPolicy (prio, val)
-&gt; Prio FstMinPolicy (prio, val) -&gt; Ordering
$cp1Ord :: forall prio val. Ord prio =&gt; Eq (Prio FstMinPolicy (prio, val))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">type</span><span>    </span><span id="Val"><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>  </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037174"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037173"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679037173"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679037148"><span class="annot"><span class="annottext">split :: (prio, val)
-&gt; (Prio FstMinPolicy (prio, val), Val FstMinPolicy (prio, val))
</span><a href="#local-6989586621679037148"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037147"><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037147"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span>       </span><span id="local-6989586621679037146"><span class="annot"><span class="annottext">val
</span><a href="#local-6989586621679037146"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prio -&gt; Prio FstMinPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMinPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMinP"><span class="hs-identifier hs-var">FMinP</span></a></span><span> </span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037147"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">val
Val FstMinPolicy (prio, val)
</span><a href="#local-6989586621679037146"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679037145"><span class="annot"><span class="annottext">merge :: (Prio FstMinPolicy (prio, val), Val FstMinPolicy (prio, val))
-&gt; (prio, val)
</span><a href="#local-6989586621679037145"><span class="hs-identifier hs-var hs-var hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#FMinP"><span class="hs-identifier hs-type">FMinP</span></a></span><span> </span><span id="local-6989586621679037144"><span class="annot"><a href="#local-6989586621679037144"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037143"><span class="annot"><span class="annottext">Val FstMinPolicy (prio, val)
</span><a href="#local-6989586621679037143"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037144"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">val
Val FstMinPolicy (prio, val)
</span><a href="#local-6989586621679037143"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621679037141"><span id="local-6989586621679037142"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037137"><span id="local-6989586621679037139"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679037142"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037142"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037141"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679037134"><span class="annot"><span class="annottext">readPrec :: ReadPrec (Prio FstMinPolicy (prio, val))
</span><a href="#local-6989586621679037134"><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(prio -&gt; Prio FstMinPolicy (prio, val))
-&gt; ReadPrec prio -&gt; ReadPrec (Prio FstMinPolicy (prio, val))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">prio -&gt; Prio FstMinPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMinPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMinP"><span class="hs-identifier hs-var">FMinP</span></a></span><span> </span><span class="annot"><span class="annottext">ReadPrec prio
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679037133"><span class="annot"><span class="annottext">readListPrec :: ReadPrec [Prio FstMinPolicy (prio, val)]
</span><a href="#local-6989586621679037133"><span class="hs-identifier hs-var hs-var hs-var hs-var">readListPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([prio] -&gt; [Prio FstMinPolicy (prio, val)])
-&gt; ReadPrec [prio] -&gt; ReadPrec [Prio FstMinPolicy (prio, val)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(prio -&gt; Prio FstMinPolicy (prio, val))
-&gt; [prio] -&gt; [Prio FstMinPolicy (prio, val)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">prio -&gt; Prio FstMinPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMinPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMinP"><span class="hs-identifier hs-var">FMinP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadPrec [prio]
forall a. Read a =&gt; ReadPrec [a]
</span><span class="hs-identifier hs-var">readListPrec</span></span></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679037131"><span id="local-6989586621679037132"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679037132"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMinPolicy"><span class="hs-identifier hs-type">FstMinPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037132"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037131"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679037127"><span class="annot"><span class="annottext">show :: Prio FstMinPolicy (prio, val) -&gt; String
</span><a href="#local-6989586621679037127"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prio -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(prio -&gt; String)
-&gt; (Prio FstMinPolicy (prio, val) -&gt; prio)
-&gt; Prio FstMinPolicy (prio, val)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMinPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMinPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMinP"><span class="hs-identifier hs-var hs-var">unFMinP</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679037126"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Prio FstMinPolicy (prio, val) -&gt; ShowS
</span><a href="#local-6989586621679037126"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679037125"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037125"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; prio -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037125"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(prio -&gt; ShowS)
-&gt; (Prio FstMinPolicy (prio, val) -&gt; prio)
-&gt; Prio FstMinPolicy (prio, val)
-&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMinPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMinPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMinP"><span class="hs-identifier hs-var hs-var">unFMinP</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679037124"><span class="annot"><span class="annottext">showList :: [Prio FstMinPolicy (prio, val)] -&gt; ShowS
</span><a href="#local-6989586621679037124"><span class="hs-identifier hs-var hs-var hs-var hs-var">showList</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prio] -&gt; ShowS
forall a. Show a =&gt; [a] -&gt; ShowS
</span><span class="hs-identifier hs-var">showList</span></span><span> </span><span class="annot"><span class="annottext">([prio] -&gt; ShowS)
-&gt; ([Prio FstMinPolicy (prio, val)] -&gt; [prio])
-&gt; [Prio FstMinPolicy (prio, val)]
-&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prio FstMinPolicy (prio, val) -&gt; prio)
-&gt; [Prio FstMinPolicy (prio, val)] -&gt; [prio]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMinPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMinPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMinP"><span class="hs-identifier hs-var hs-var">unFMinP</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Policy type for a @(prio, val)@ 'MaxPrioHeap'.</span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="FstMaxPolicy"><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-var">FstMaxPolicy</span></a></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679037122"><span id="local-6989586621679037123"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037123"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-type">HeapItem</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037123"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037122"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">newtype</span><span> </span><span id="Prio"><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-var">Prio</span></a></span></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037123"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037122"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FMaxP"><span class="annot"><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-var">FMaxP</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFMaxP"><span class="annot"><span class="annottext">Prio FstMaxPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMaxP"><span class="hs-identifier hs-var hs-var">unFMaxP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679037123"><span class="hs-identifier hs-type">prio</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037113"><span id="local-6989586621679037115"><span class="annot"><span class="annottext">Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
(Prio FstMaxPolicy (prio, val)
 -&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool)
-&gt; (Prio FstMaxPolicy (prio, val)
    -&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool)
-&gt; Eq (Prio FstMaxPolicy (prio, val))
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall prio val.
Eq prio =&gt;
Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
/= :: Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
$c/= :: forall prio val.
Eq prio =&gt;
Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
== :: Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
$c== :: forall prio val.
Eq prio =&gt;
Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">type</span><span>    </span><span id="Val"><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>  </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037123"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037122"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679037122"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679037112"><span class="annot"><span class="annottext">split :: (prio, val)
-&gt; (Prio FstMaxPolicy (prio, val), Val FstMaxPolicy (prio, val))
</span><a href="#local-6989586621679037112"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037111"><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037111"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span>       </span><span id="local-6989586621679037110"><span class="annot"><span class="annottext">val
</span><a href="#local-6989586621679037110"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prio -&gt; Prio FstMaxPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMaxPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-var">FMaxP</span></a></span><span> </span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037111"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">val
Val FstMaxPolicy (prio, val)
</span><a href="#local-6989586621679037110"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679037109"><span class="annot"><span class="annottext">merge :: (Prio FstMaxPolicy (prio, val), Val FstMaxPolicy (prio, val))
-&gt; (prio, val)
</span><a href="#local-6989586621679037109"><span class="hs-identifier hs-var hs-var hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-type">FMaxP</span></a></span><span> </span><span id="local-6989586621679037108"><span class="annot"><a href="#local-6989586621679037108"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037107"><span class="annot"><span class="annottext">Val FstMaxPolicy (prio, val)
</span><a href="#local-6989586621679037107"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037108"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">val
Val FstMaxPolicy (prio, val)
</span><a href="#local-6989586621679037107"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621679037105"><span id="local-6989586621679037106"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037091"><span id="local-6989586621679037093"><span id="local-6989586621679037095"><span id="local-6989586621679037097"><span id="local-6989586621679037099"><span id="local-6989586621679037101"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679037106"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037106"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037105"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679037090"><span class="annot"><span class="annottext">compare :: Prio FstMaxPolicy (prio, val)
-&gt; Prio FstMaxPolicy (prio, val) -&gt; Ordering
</span><a href="#local-6989586621679037090"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-type">FMaxP</span></a></span><span> </span><span id="local-6989586621679037089"><span class="annot"><a href="#local-6989586621679037089"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-type">FMaxP</span></a></span><span> </span><span id="local-6989586621679037088"><span class="annot"><a href="#local-6989586621679037088"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prio -&gt; prio -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037088"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">prio
</span><a href="#local-6989586621679037089"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679037086"><span id="local-6989586621679037087"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037082"><span id="local-6989586621679037084"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679037087"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037087"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037086"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679037079"><span class="annot"><span class="annottext">readPrec :: ReadPrec (Prio FstMaxPolicy (prio, val))
</span><a href="#local-6989586621679037079"><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(prio -&gt; Prio FstMaxPolicy (prio, val))
-&gt; ReadPrec prio -&gt; ReadPrec (Prio FstMaxPolicy (prio, val))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">prio -&gt; Prio FstMaxPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMaxPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-var">FMaxP</span></a></span><span> </span><span class="annot"><span class="annottext">ReadPrec prio
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679037078"><span class="annot"><span class="annottext">readListPrec :: ReadPrec [Prio FstMaxPolicy (prio, val)]
</span><a href="#local-6989586621679037078"><span class="hs-identifier hs-var hs-var hs-var hs-var">readListPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([prio] -&gt; [Prio FstMaxPolicy (prio, val)])
-&gt; ReadPrec [prio] -&gt; ReadPrec [Prio FstMaxPolicy (prio, val)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(prio -&gt; Prio FstMaxPolicy (prio, val))
-&gt; [prio] -&gt; [Prio FstMaxPolicy (prio, val)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">prio -&gt; Prio FstMaxPolicy (prio, val)
forall prio val. prio -&gt; Prio FstMaxPolicy (prio, val)
</span><a href="Data.Heap.Item.html#FMaxP"><span class="hs-identifier hs-var">FMaxP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadPrec [prio]
forall a. Read a =&gt; ReadPrec [a]
</span><span class="hs-identifier hs-var">readListPrec</span></span></span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679037076"><span id="local-6989586621679037077"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679037077"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="Data.Heap.Item.html#FstMaxPolicy"><span class="hs-identifier hs-type">FstMaxPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037077"><span class="hs-identifier hs-type">prio</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679037076"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679037072"><span class="annot"><span class="annottext">show :: Prio FstMaxPolicy (prio, val) -&gt; String
</span><a href="#local-6989586621679037072"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prio -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(prio -&gt; String)
-&gt; (Prio FstMaxPolicy (prio, val) -&gt; prio)
-&gt; Prio FstMaxPolicy (prio, val)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMaxPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMaxPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMaxP"><span class="hs-identifier hs-var hs-var">unFMaxP</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679037071"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Prio FstMaxPolicy (prio, val) -&gt; ShowS
</span><a href="#local-6989586621679037071"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679037070"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037070"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; prio -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037070"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(prio -&gt; ShowS)
-&gt; (Prio FstMaxPolicy (prio, val) -&gt; prio)
-&gt; Prio FstMaxPolicy (prio, val)
-&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMaxPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMaxPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMaxP"><span class="hs-identifier hs-var hs-var">unFMaxP</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679037069"><span class="annot"><span class="annottext">showList :: [Prio FstMaxPolicy (prio, val)] -&gt; ShowS
</span><a href="#local-6989586621679037069"><span class="hs-identifier hs-var hs-var hs-var hs-var">showList</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prio] -&gt; ShowS
forall a. Show a =&gt; [a] -&gt; ShowS
</span><span class="hs-identifier hs-var">showList</span></span><span> </span><span class="annot"><span class="annottext">([prio] -&gt; ShowS)
-&gt; ([Prio FstMaxPolicy (prio, val)] -&gt; [prio])
-&gt; [Prio FstMaxPolicy (prio, val)]
-&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prio FstMaxPolicy (prio, val) -&gt; prio)
-&gt; [Prio FstMaxPolicy (prio, val)] -&gt; [prio]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prio FstMaxPolicy (prio, val) -&gt; prio
forall prio val. Prio FstMaxPolicy (prio, val) -&gt; prio
</span><a href="Data.Heap.Item.html#unFMaxP"><span class="hs-identifier hs-var hs-var">unFMaxP</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | 'split' a function on @item@s to one on priority-value pairs.</span><span>
</span><span id="line-185"></span><span id="local-6989586621679037066"><span id="local-6989586621679037067"><span id="local-6989586621679037068"><span class="annot"><a href="Data.Heap.Item.html#splitF"><span class="hs-identifier hs-type">splitF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#HeapItem"><span class="hs-identifier hs-type">HeapItem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037068"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037067"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679037067"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679037066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Heap.Item.html#Prio"><span class="hs-identifier hs-type">Prio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037068"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037067"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037068"><span class="hs-identifier hs-type">pol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037067"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679037066"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-186"></span><span id="splitF"><span class="annot"><span class="annottext">splitF :: (item -&gt; a) -&gt; (Prio pol item, Val pol item) -&gt; a
</span><a href="Data.Heap.Item.html#splitF"><span class="hs-identifier hs-var hs-var">splitF</span></a></span></span><span> </span><span id="local-6989586621679037065"><span class="annot"><span class="annottext">item -&gt; a
</span><a href="#local-6989586621679037065"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679037064"><span class="annot"><span class="annottext">(Prio pol item, Val pol item)
</span><a href="#local-6989586621679037064"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">item -&gt; a
</span><a href="#local-6989586621679037065"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prio pol item, Val pol item) -&gt; item
forall pol item.
HeapItem pol item =&gt;
(Prio pol item, Val pol item) -&gt; item
</span><a href="Data.Heap.Item.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">(Prio pol item, Val pol item)
</span><a href="#local-6989586621679037064"><span class="hs-identifier hs-var">pv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span class="hs-pragma">{-# INLINE</span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#splitF"><span class="hs-pragma hs-type">splitF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-188"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;splitF/split&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679037063"><span class="annot"><a href="#local-6989586621679037063"><span class="hs-pragma hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679037062"><span class="annot"><a href="#local-6989586621679037062"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Heap.Item.html#splitF"><span class="hs-pragma hs-type">splitF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037063"><span class="hs-pragma hs-type">f</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Heap.Item.html#split"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037062"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679037063"><span class="hs-pragma hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679037062"><span class="hs-pragma hs-type">x</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-189"></span></pre></body></html>